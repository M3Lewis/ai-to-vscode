{"version":3,"file":"popup.js","mappings":"mBA0CA,MAAMA,EAAe,CACnB,kBACA,YACA,oBACA,cACA,UACA,gBACA,eACA,uBAIF,MAAMC,EAqDJ,WAAAC,GApDQ,KAAAC,cAA+B,KAC/B,KAAAC,UAAoB,EAEpB,KAAAC,UAAqC,KACrC,KAAAC,uBAAkD,KAClD,KAAAC,QAA8B,KAC9B,KAAAC,YAAuC,KACvC,KAAAC,WAAuC,KACvC,KAAAC,YAAwC,KACxC,KAAAC,aAAyC,KACzC,KAAAC,aAAyC,KACzC,KAAAC,aAAyC,KACzC,KAAAC,gBAA2C,KAC3C,KAAAC,gBAA4C,KAC5C,KAAAC,UAAgC,KAEhC,KAAAC,WAAiC,KACjC,KAAAC,oBAA+C,KAC/C,KAAAC,oBAA+C,KAC/C,KAAAC,qBAAgD,KAChD,KAAAC,gBAA4C,KAG5C,KAAAC,gBAA2C,KAC3C,KAAAC,iBAA6C,KAC7C,KAAAC,gBAA2C,KAC3C,KAAAC,gBAA4C,KAC5C,KAAAC,WAAiC,KACjC,KAAAC,gBAAsC,KACtC,KAAAC,mBAA6B,GAE7B,KAAAC,cAAyC,KAGzC,KAAAC,WAAiC,KACjC,KAAAC,iBAA4C,KAC5C,KAAAC,aAAwC,KACxC,KAAAC,aAAyC,KACzC,KAAAC,eAA2C,KAC3C,KAAAC,WAAqC,CAAC,EACtC,KAAAC,kBAA4B,UAE5B,KAAAC,gBAA4B,CAClCC,KAAM,KACNC,YAAa,IAAIvC,GACjBwC,gBAAgB,EAChBC,YAAa,GACbC,YAAa,IAGP,KAAAC,kBAA4C,KAi2B5C,KAAAC,gBAA0B,GA91BhCC,KAAKC,eACLD,KAAKE,eACLF,KAAKG,sBACLH,KAAKI,gBACLJ,KAAKK,oBACP,CAEQ,YAAAJ,GACND,KAAKxC,UAAY8C,SAASC,eAAe,cACzCP,KAAKvC,uBAAyB6C,SAASC,eAAe,qBACtDP,KAAKtC,QAAU4C,SAASC,eAAe,YACvCP,KAAKrC,YAAc2C,SAASC,eAAe,iBAC3CP,KAAKpC,WAAa0C,SAASC,eAAe,iBAC1CP,KAAKnC,YAAcyC,SAASC,eAAe,kBAC3CP,KAAKlC,aAAewC,SAASC,eAAe,eAC5CP,KAAKjC,aAAeuC,SAASC,eAAe,iBAC5CP,KAAKhC,aAAesC,SAASC,eAAe,iBAC5CP,KAAK/B,gBAAkBqC,SAASC,eAAe,qBAC/CP,KAAK9B,gBAAkBoC,SAASC,eAAe,kBAC/CP,KAAK7B,UAAYmC,SAASC,eAAe,UAEzCP,KAAK5B,WAAakC,SAASC,eAAe,eAC1CP,KAAK3B,oBAAsBiC,SAASC,eAAe,mBACnDP,KAAK1B,oBAAsBgC,SAASC,eAAe,mBACnDP,KAAKzB,qBAAuB+B,SAASC,eAAe,oBACpDP,KAAKxB,gBAAkB8B,SAASC,eAAe,kBAG/CP,KAAKvB,gBAAkB6B,SAASC,eAAe,eAC/CP,KAAKtB,iBAAmB4B,SAASC,eAAe,mBAChDP,KAAKrB,gBAAkB2B,SAASC,eAAe,qBAC/CP,KAAKpB,gBAAkB0B,SAASC,eAAe,kBAC/CP,KAAKnB,WAAayB,SAASC,eAAe,eAG1CP,KAAKtB,iBAAmB4B,SAASC,eAAe,mBAChDP,KAAKrB,gBAAkB2B,SAASC,eAAe,qBAC/CP,KAAKlB,gBAAkBwB,SAASC,eAAe,qBAE/CP,KAAKhB,cAAgBsB,SAASC,eAAe,aAG7CP,KAAKf,WAAaqB,SAASC,eAAe,eAC1CP,KAAKd,iBAAmBoB,SAASC,eAAe,gBAChDP,KAAKb,aAAemB,SAASC,eAAe,YAC5CP,KAAKZ,aAAekB,SAASC,eAAe,eAC5CP,KAAKX,eAAiBiB,SAASC,eAAe,gBAChD,CAEQ,kBAAML,GAEZ,MAAMM,QAAeC,OAAOC,QAAQC,KAAKC,IAAI,YAC7C,IAAIC,EAEFA,EADEL,EAAOK,SACEL,EAAOK,eAGQJ,OAAOC,QAAQC,KAAKC,IAAI,CAChDnB,KAAM,KACNC,YAAa,IAAIvC,GACjBwC,gBAAgB,EAChBC,YAAa,GACbC,YAAa,KAMjB,MACMA,SADqBY,OAAOC,QAAQI,MAAMF,IAAI,gBACLf,aAAe,GAC9DgB,EAAShB,YAAcA,EAGvB,MAAMkB,QAAcN,OAAOC,QAAQI,MAAMF,IAAI,iBAE7C,GAAIG,EAAMC,cAAe,CACvB,MAAMC,EAA2BF,EAAMC,cAGjCE,EAAc,IAChBD,EAAUE,WAAaC,KAAKC,MAAQJ,EAAUE,UAAYD,GAE5DlB,KAAKR,gBAAkB,CACrBC,KAAMwB,EAAUxB,MAAQoB,EAASpB,KACjCC,YAAauB,EAAUvB,aAAemB,EAASnB,YAC/CC,eAAgBsB,EAAUtB,gBAAkBkB,EAASlB,eACrDC,YAAaqB,EAAUrB,aAAeiB,EAASjB,YAC/CC,YAAaoB,EAAUpB,aAAegB,EAAShB,aAGjDG,KAAKzC,UAAW,EAChByC,KAAKsB,uBAGLtB,KAAKR,gBAAkBqB,QACjBJ,OAAOC,QAAQI,MAAMS,OAAO,iBAEtC,MACEvB,KAAKR,gBAAkBqB,EAGrBb,KAAKhB,gBACPgB,KAAKhB,cAAcwC,MAAQxB,KAAKR,gBAAgBiC,UAAY,IAG1DzB,KAAKxC,YAAWwC,KAAKxC,UAAUgE,MAAQxB,KAAKR,gBAAgBC,KAAKiC,YACjE1B,KAAKvC,yBAAwBuC,KAAKvC,uBAAuBkE,QAAU3B,KAAKR,gBAAgBG,gBAG5FK,KAAK4B,gBACL5B,KAAK6B,mBACL7B,KAAK8B,kBACP,CAGQ,kBAAAR,GACFtB,KAAKpC,aACPoC,KAAKpC,WAAWmE,YAAc,oBAC9B/B,KAAKpC,WAAWoE,MAAMC,WAAa,UAEvC,CAGQ,kBAAAC,GACFlC,KAAKpC,aACPoC,KAAKpC,WAAWmE,YAAc,UAC9B/B,KAAKpC,WAAWoE,MAAMC,WAAa,WAErCjC,KAAKzC,UAAW,CAClB,CAGQ,aAAA6C,GAENJ,KAAKxC,WAAW2E,iBAAiB,QAAS,IAAMnC,KAAKoC,oBACrDpC,KAAKvC,wBAAwB0E,iBAAiB,SAAU,IAAMnC,KAAKoC,mBACrE,CAGQ,gBAAAA,GACFpC,KAAK1C,eACP+E,aAAarC,KAAK1C,eAGpB0C,KAAK1C,cAAgBgF,OAAOC,WAAW,KACrCvC,KAAKwC,aACJ,IACL,CAGQ,eAAMA,GACZ,MAAMzB,EAAuB,CAC3BtB,KAAMgD,SAASzC,KAAKxC,WAAWgE,OAAS,QACxC9B,YAAaM,KAAKR,gBAAgBE,YAClCC,eAAgBK,KAAKvC,wBAAwBkE,UAAW,EACxD/B,YAAaI,KAAKR,gBAAgBI,YAClCC,YAAaG,KAAKR,gBAAgBK,YAClCsB,UAAWC,KAAKC,aAGZZ,OAAOC,QAAQI,MAAM4B,IAAI,CAAE1B,cAAeD,IAE3Cf,KAAKzC,WACRyC,KAAKzC,UAAW,EAChByC,KAAKsB,qBAET,CAEQ,aAAAM,GACD5B,KAAKtC,UAEsC,IAA5CsC,KAAKR,gBAAgBE,YAAYiD,QAKrC3C,KAAKtC,QAAQkF,UAAY5C,KAAKR,gBAAgBE,YAC3CmD,IAAI,CAACC,EAAKC,IAAU,qDAET/C,KAAKgD,WAAWF,4CACFC,0CAGzBE,KAAK,IAERjD,KAAKtC,QAAQwF,iBAAiB,UAAUC,QAAQC,IAC9CA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMN,EAAQN,SAAUY,EAAEC,OAAuBC,aAAa,eAAiB,KAC/EvD,KAAKwD,UAAUT,QAhBjB/C,KAAKtC,QAAQkF,UAAY,sCAmB7B,CAEQ,gBAAAf,GACD7B,KAAK5B,aAEsC,IAA5C4B,KAAKR,gBAAgBI,YAAY+C,QAKrC3C,KAAK5B,WAAWwE,UAAY5C,KAAKR,gBAAgBI,YAC9CiD,IAAI,CAACY,EAAQV,IAAU,+HAG4B/C,KAAKgD,WAAWS,EAAOC,4GAEjE1D,KAAKgD,WAAWS,EAAOE,wDAEzBF,EAAOG,0BAA4B,qGAE3B5D,KAAKgD,WAAWS,EAAOG,iEAE7B,uDAEgBb,0CAGzBE,KAAK,IAERjD,KAAK5B,WAAW8E,iBAAiB,UAAUC,QAAQC,IACjDA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMN,EAAQN,SAAUY,EAAEC,OAAuBC,aAAa,eAAiB,KAC/EvD,KAAK6D,aAAad,QA1BpB/C,KAAK5B,WAAWwE,UAAY,yCA6BhC,CAEQ,mBAAAzC,GAENH,KAAKpC,YAAYuE,iBAAiB,QAAS,IAAMnC,KAAK8D,gBACtD9D,KAAKnC,aAAasE,iBAAiB,QAAS,IAAMnC,KAAK+D,mBACvD/D,KAAKlC,cAAcqE,iBAAiB,QAAS,IAAMnC,KAAKgE,UACxDhE,KAAKxB,iBAAiB2D,iBAAiB,QAAS,IAAMnC,KAAKiE,aAC3DjE,KAAKjC,cAAcoE,iBAAiB,QAAS,IAAMnC,KAAKkE,gBACxDlE,KAAKhC,cAAcmE,iBAAiB,QAAS,IAAMnC,KAAK/B,iBAAiBkG,SACzEnE,KAAK9B,iBAAiBiE,iBAAiB,QAAS,IAAMnC,KAAKoE,wBAC3DpE,KAAK/B,iBAAiBkE,iBAAiB,SAAWkB,GAAMrD,KAAKqE,iBAAiBhB,IAC9ErD,KAAKhB,eAAemD,iBAAiB,QAAS,IAAMnC,KAAKwC,aAGzDxC,KAAKrC,aAAawE,iBAAiB,WAAakB,IAChC,UAAVA,EAAEiB,KAAiBtE,KAAKgE,WAI9BhE,KAAK1B,qBAAqB6D,iBAAiB,WAAakB,IACxC,UAAVA,EAAEiB,KAAmBjB,EAAEkB,SAASvE,KAAKiE,cAI3CjE,KAAKtB,kBAAkByD,iBAAiB,QAAS,IAAMnC,KAAKrB,iBAAiBwF,SAC7EnE,KAAKrB,iBAAiBwD,iBAAiB,SAAWkB,GAAMrD,KAAKwE,iBAAiBnB,IAC9ErD,KAAKpB,iBAAiBuD,iBAAiB,QAAS,IAAMnC,KAAKyE,aAG3DzE,KAAKZ,cAAc+C,iBAAiB,QAAS,IAAMnC,KAAK0E,aACxD1E,KAAKX,gBAAgB8C,iBAAiB,QAAS,IAAMnC,KAAK2E,iBAC5D,CAEQ,0BAAMP,GACZ,IACE,MACMQ,SADanE,OAAOoE,KAAKC,MAAM,CAAEC,QAAQ,EAAMC,eAAe,KAC7C,GAEvB,IAAKJ,IAAcA,EAAUK,GAE3B,YADAjF,KAAKkF,WAAW,YAAa,SAK/B,GAAIN,EAAU9B,IACZ,IACE,MAAMA,EAAM,IAAIqC,IAAIP,EAAU9B,KAC1B9C,KAAK3B,sBACP2B,KAAK3B,oBAAoBmD,MAAQsB,EAAIY,SAEzC,CAAE,MAAOL,GACP+B,QAAQC,MAAM,WAAYhC,EAC5B,CAGFrD,KAAKsF,oBAGL,MAAMC,QAAgB9E,OAAO+E,UAAUC,cAAc,CACnDnC,OAAQ,CAAEoC,MAAOd,EAAUK,IAC3BU,KAAM,KAWJ,MAAMC,EAAgC,GAyDtC,OAxDgBtF,SAAS4C,iBAAiB,UAElCC,QAAS0C,IACf,MAAMC,EAAOD,EAAO9D,aAAagE,cAAcC,QAAU,GACnDC,EAAYJ,EAAOtC,aAAa,eAAewC,eAAiB,GAChEG,EAAQL,EAAOtC,aAAa,UAAUwC,eAAiB,GACvDI,EAAYN,EAAOM,UAAUJ,cAEnC,IAAIK,EAAQ,EAYZ,IATIN,EAAKO,SAAS,SAAWP,EAAKO,SAAS,SAAOD,GAAS,KACvDH,EAAUI,SAAS,SAAWJ,EAAUI,SAAS,SAAOD,GAAS,KACjEF,EAAMG,SAAS,SAAWH,EAAMG,SAAS,SAAOD,GAAS,GACzDD,EAAUE,SAAS,UAASD,GAAS,GAE7BP,EAAOS,cAAc,SACxBF,GAAS,GAGdA,GAAS,EAAG,CACd,IAAIG,EAAW,GACf,MAAMC,EAAgBX,EAAOtC,aAAa,cAG1C,GAAIiD,EAGFD,EAAW,sBADUC,EAAcC,QAAQ,KAAM,gBAE5C,GAAIZ,EAAOZ,GAChBsB,EAAW,UAAUV,EAAOZ,UACvB,GAAIY,EAAOM,WAAaN,EAAOM,UAAUH,OAAQ,CACtD,MAAMU,EAAUb,EAAOM,UAAUH,OAAOW,MAAM,OAAOC,MAAM,EAAG,GAE5DL,EADEG,EAAQ/D,OAAS,EACR,UAAU+D,EAAQzD,KAAK,OAEvB,QAEf,MACEsD,EAAW,SAGbX,EAAWiB,KAAK,CACdN,SAAUA,EACVO,MAAOhB,GAAQG,GAAa,QAC5BA,UAAWO,GAAiB,GAC5BV,KAAMA,EACNM,MAAOA,GAEX,IAIFR,EAAWmB,KAAK,CAACC,EAAGC,IAAMA,EAAEb,MAAQY,EAAEZ,OAG/BR,EAAWgB,MAAM,EAAG,OAIzBhB,EAAgCL,EAAQ,IAAI/E,QAAU,GAElC,IAAtBoF,EAAWjD,OACb3C,KAAKkH,uBAELlH,KAAKmH,oBAAoBvB,EAG7B,CAAE,MAAOP,GACPD,QAAQC,MAAM,UAAWA,GAEzB,IAAI+B,EAAW,SACX/B,aAAiBgC,QACnBD,GAAY,KAAO/B,EAAMiC,SAG3BtH,KAAKkF,WAAWkC,EAAU,SAC1BpH,KAAKuH,YACP,CACF,CAGQ,iBAAAjC,GACN,MAAMkC,EAAQlH,SAASC,eAAe,oBACjCiH,IAELA,EAAM5E,UAAY,kaAelB4E,EAAMxF,MAAMyF,QAAU,OAEtBnH,SAASC,eAAe,gBAAgB4B,iBAAiB,QAAS,KAChEnC,KAAKuH,eAET,CAEQ,oBAAAL,GACN,MAAMM,EAAQlH,SAASC,eAAe,oBACjCiH,IAELA,EAAM5E,UAAY,koBAqBlB4E,EAAMxF,MAAMyF,QAAU,OAEtBnH,SAASC,eAAe,gBAAgB4B,iBAAiB,QAAS,IAAMnC,KAAKuH,cAC7EjH,SAASC,eAAe,iBAAiB4B,iBAAiB,QAAS,IAAMnC,KAAKuH,cAChF,CAEQ,mBAAAJ,CAAoBvB,GAC1B,MAAM4B,EAAQlH,SAASC,eAAe,oBACjCiH,IAELA,EAAM5E,UAAY,gGAGAgD,EAAWjD,0QAOrBiD,EAAW/C,IAAI,CAAC6E,EAAGC,IAAM,2DACmBA,2FAEZ3H,KAAKgD,WAAW0E,EAAEZ,8DACf9G,KAAKgD,WAAW0E,EAAEnB,oFAE7CmB,EAAEzB,UAAY,eAAejG,KAAKgD,WAAW0E,EAAEzB,aAAe,yBAC9DyB,EAAEtB,MAAQ,WAAWsB,EAAEtB,SAAW,oFAIzCnD,KAAK,iPASduE,EAAMxF,MAAMyF,QAAU,OAEtBnH,SAASC,eAAe,gBAAgB4B,iBAAiB,QAAS,IAAMnC,KAAKuH,cAC7EjH,SAASC,eAAe,iBAAiB4B,iBAAiB,QAAS,IAAMnC,KAAKuH,cAC9EjH,SAASC,eAAe,kBAAkB4B,iBAAiB,QAAS,IAAMnC,KAAK4H,oBAErDJ,EAAMtE,iBAAiB,qBAC/BC,QAAS0E,IACzBA,EAAG1F,iBAAiB,QAAUkB,IAC5B,MAAMN,EAAQN,SAAUY,EAAEyE,cAA8BvE,aAAa,eAAiB,KACtFvD,KAAK+H,gBAAgBhF,EAAO6C,OAGlC,CAEQ,eAAAmC,CAAgBhF,EAAe6C,GACrC5F,KAAKF,kBAAoB8F,EAAW7C,GAEpC,MAAMyE,EAAQlH,SAASC,eAAe,oBACtC,IAAKiH,EAAO,OAEZA,EAAMtE,iBAAiB,qBAAqBC,QAAQ0E,IAClDA,EAAGG,UAAUzG,OAAO,cAGtB,MAAM0G,EAAWT,EAAMlB,cAAc,gBAAgBvD,OACrDkF,GAAUD,UAAUE,IAAI,YAExB,MAAMC,EAAa7H,SAASC,eAAe,iBACvC4H,IAAYA,EAAWC,UAAW,EACxC,CAEQ,gBAAAR,GACD5H,KAAKF,oBAENE,KAAK1B,sBACP0B,KAAK1B,oBAAoBkD,MAAQxB,KAAKF,kBAAkByG,UAG1DvG,KAAKkF,WAAW,UAAUlF,KAAKF,kBAAkByG,WAAY,WAC7DvG,KAAKuH,aACLvH,KAAKF,kBAAoB,KAC3B,CAEQ,UAAAyH,GACN,MAAMC,EAAQlH,SAASC,eAAe,oBAClCiH,IACFA,EAAMxF,MAAMyF,QAAU,OACtBD,EAAM5E,UAAY,IAEpB5C,KAAKF,kBAAoB,IAC3B,CAEQ,MAAAkE,GACN,MAAMlB,EAAM9C,KAAKrC,aAAa6D,MAAMwE,OAC/BlD,EAKA,yBAAyBuF,KAAKvF,IAAgB,cAARA,EAKvC9C,KAAKR,gBAAgBE,YAAY2G,SAASvD,GAC5C9C,KAAKkF,WAAW,SAAU,UAI5BlF,KAAKR,gBAAgBE,YAAYmH,KAAK/D,GACtC9C,KAAK4B,gBAED5B,KAAKrC,cACPqC,KAAKrC,YAAY6D,MAAQ,IAG3BxB,KAAKkF,WAAW,gBAAiB,YAhB/BlF,KAAKkF,WAAW,aAAc,SAL9BlF,KAAKkF,WAAW,UAAW,QAsB/B,CAEQ,SAAA1B,CAAUT,GAChB/C,KAAKR,gBAAgBE,YAAY4I,OAAOvF,EAAO,GAC/C/C,KAAK4B,gBACL5B,KAAKkF,WAAW,gBAAiB,UACnC,CAEQ,SAAAjB,GACN,MAAMP,EAAW1D,KAAK3B,qBAAqBmD,MAAMwE,OAC3CO,EAAWvG,KAAK1B,qBAAqBkD,MAAMwE,OAC3CuC,EAAYvI,KAAKzB,sBAAsBiD,MAAMwE,OAEnD,IAAKtC,IAAa6C,EAEhB,YADAvG,KAAKkF,WAAW,kBAAmB,SAQrC,GAJelF,KAAKR,gBAAgBI,YAAY4I,KAC9C/E,GAAUA,EAAOC,WAAaA,GAK9B,YADA1D,KAAKkF,WAAW,gBAAiB,SAInC,MAAMuD,EAAwB,CAC5B/E,WACAC,mBAAoB4C,EACpB3C,0BAA2B2E,QAAaG,GAG1C1I,KAAKR,gBAAgBI,YAAYiH,KAAK4B,GACtCzI,KAAK6B,mBAED7B,KAAK3B,sBAAqB2B,KAAK3B,oBAAoBmD,MAAQ,IAC3DxB,KAAK1B,sBAAqB0B,KAAK1B,oBAAoBkD,MAAQ,IAC3DxB,KAAKzB,uBAAsByB,KAAKzB,qBAAqBiD,MAAQ,IAEjExB,KAAKkF,WAAW,kBAAmB,UACrC,CAEQ,YAAArB,CAAad,GACnB/C,KAAKR,gBAAgBI,YAAY0I,OAAOvF,EAAO,GAC/C/C,KAAK6B,mBACL7B,KAAKkF,WAAW,gBAAiB,UACnC,CAEQ,kBAAMpB,GACZ,MAAM6E,EAAUrI,SAASC,eAAe,iBAExC,GAAKoI,EAEL,IAEE3I,KAAKR,gBAAgBiC,SAAWzB,KAAKhB,eAAewC,MAAMwE,QAAU,GAGpE,MAAMnG,EAAcG,KAAKR,gBAAgBK,aAAe,SAClDY,OAAOC,QAAQI,MAAM4B,IAAI,CAAE7C,gBAGjC,MAAM+I,EAA4B,IAC7B5I,KAAKR,gBACRK,iBAAa6I,UAGRE,EAAgB/I,YAGvB,MAAMgJ,EAAeC,KAAKC,UAAUH,GAC9BI,EAAc,IAAIC,KAAK,CAACJ,IAAeK,KAC7C9D,QAAQ+D,IAAI,kBAAkBH,UAAoBA,EAAc,MAAMI,QAAQ,UAC1EJ,EAAc,MAChB5D,QAAQiE,KAAK,4CAGf,MAAMC,EAAmC,CAAC,EAC1C,GAAIzJ,EAAY8C,OAAS,EAAG,CAC1B,IAAI4G,EAAkB,EACtB1J,EAAYsD,QAAQ,CAACqG,EAAG7B,KACtB,MAAM8B,EAAa,IAAIR,KAAK,CAACO,EAAEE,OAAOR,KACtCK,GAAmBE,EACnBH,EAAS,eAAe3B,WAAa8B,IAEvCH,EAAS,qBAAuBC,CAClC,CACAD,EAAsB,YAAI,IAAIL,KAAK,CAACH,KAAKC,UAAU/I,KAAKR,gBAAgBE,eAAewJ,KACvFI,EAAsB,YAAI,IAAIL,KAAK,CAACH,KAAKC,UAAU/I,KAAKR,gBAAgBI,eAAesJ,KACvFI,EAAgB,MAAIN,GAAeM,EAAS,sBAAwB,GAAKA,EAAsB,YAAIA,EAAsB,YACzHlE,QAAQ+D,IAAI,UAAWG,SAGjB,IAAIK,QAAc,CAACC,EAASC,KAChCpJ,OAAOC,QAAQC,KAAK+B,IAClB,CAAE7B,SAAU+H,GACZ,KACE,MAAMkB,EAAMrJ,OAAOsJ,QAAQC,UACvBF,GACF1E,QAAQC,MAAM,iCAAkCyE,GAChDD,EAAOC,IAEPF,QAORjB,EAAQ5G,YAAc,UACtB4G,EAAQxC,UAAY,UACpBwC,EAAQP,UAAW,EAEnBpI,KAAKkF,WAAW,UAAW,iBAGrBzE,OAAOC,QAAQI,MAAMS,OAAO,gBAEpC,CAAE,MAAO8D,GACPD,QAAQC,MAAM,UAAWA,GAEzB,IAAI4E,EAAe,OAEjBA,EADE5E,aAAiBgC,MACJhC,EAAMiC,QACZjC,GAA0B,iBAAVA,EAErB,YAAaA,GAAkC,iBAAlBA,EAAMiC,QACtBjC,EAAMiC,QAENwB,KAAKC,UAAU1D,GAGjB6E,OAAO7E,GAExBrF,KAAKkF,WAAW,WAAW+E,IAAgB,SAG3CtB,EAAQ5G,YAAc,UACtB4G,EAAQxC,UAAY,SACtB,CACF,CAGQ,qBAAMpC,GACPoG,QAAQ,6BAIbnK,KAAKR,gBAAkB,CACrBC,KAAM,KACNC,YAAa,IAAIvC,GACjBwC,gBAAgB,EAChBC,YAAa,GACbC,YAAa,IAGXG,KAAKxC,YAAWwC,KAAKxC,UAAUgE,MAAQ,QACvCxB,KAAKvC,yBAAwBuC,KAAKvC,uBAAuBkE,SAAU,GAGvE3B,KAAK4B,gBACL5B,KAAK6B,mBACL7B,KAAK8B,mBACL9B,KAAKkF,WAAW,kBAAmB,WACrC,CAEQ,kBAAMhB,GACZ,IACE,MAAMkG,QAAa3J,OAAOC,QAAQC,KAAKC,IAAI,MAErCyJ,EAAa,CACjBC,QAAS,QACTnJ,WAAW,IAAIC,MAAOmJ,cACtBC,UAAW,sBACXJ,KAAMA,GAGFK,EAAO3B,KAAKC,UAAUsB,EAAY,KAAM,GACxCK,EAAO,IAAIzB,KAAK,CAACwB,GAAO,CAAEE,KAAM,qBAChC7H,EAAMqC,IAAIyF,gBAAgBF,GAE1B1D,EAAI1G,SAASuK,cAAc,KACjC7D,EAAE8D,KAAOhI,EACTkE,EAAE+D,SAAW,2BAA2B3J,KAAKC,aAC7C2F,EAAE7C,QAEFgB,IAAI6F,gBAAgBlI,GAEpB9C,KAAKkF,WAAW,UAAW,UAC7B,CAAE,MAAOG,GACPD,QAAQC,MAAM,QAASA,GACvBrF,KAAKkF,WAAW,WAAcG,EAAgBiC,QAAS,QACzD,CACF,CAEQ,sBAAMjD,CAAiB4G,GAC7B,MAAMC,EAAQD,EAAM3H,OACd6H,EAAOD,EAAME,QAAQ,GAE3B,GAAKD,EAEL,IACE,MAAMrF,QAAaqF,EAAKrF,OAClBuF,EAAavC,KAAKwC,MAAMxF,GAE9B,IAAKuF,EAAWjB,OAASiB,EAAWf,QAElC,YADAtK,KAAKkF,WAAW,cAAe,SAIjC,IAAKiF,QAAQ,sBACX,aAGI1J,OAAOC,QAAQC,KAAK+B,IAAI2I,EAAWjB,YACnCpK,KAAKE,eAEXF,KAAKkF,WAAW,qBAAsB,UACxC,CAAE,MAAOG,GACPD,QAAQC,MAAM,QAASA,GACvBrF,KAAKkF,WAAW,WAAcG,EAAgBiC,QAAS,QACzD,C,QACE4D,EAAM1J,MAAQ,EAChB,CACF,CAEQ,UAAA0D,CAAWoC,EAAiBqD,GAC7B3K,KAAK7B,YAEV6B,KAAK7B,UAAU4D,YAAcuF,EAC7BtH,KAAK7B,UAAUgI,UAAYwE,EAC3B3K,KAAK7B,UAAU6D,MAAMyF,QAAU,QAE/BlF,WAAW,KACLvC,KAAK7B,YACP6B,KAAK7B,UAAU6D,MAAMyF,QAAU,SAEhC,KACL,CAEQ,UAAAzE,CAAW8C,GACjB,MAAMyF,EAAMjL,SAASuK,cAAc,OAEnC,OADAU,EAAIxJ,YAAc+D,EACXyF,EAAI3I,SACb,CAGQ,gBAAAd,GACN,IAAK9B,KAAKnB,WAAY,OAEtB,MAAM2M,EAAUxL,KAAKR,gBAAgBK,aAAe,GAE7B,IAAnB2L,EAAQ7I,QAKZ3C,KAAKnB,WAAW+D,UAAY4I,EACzB3I,IAAI,CAAC4I,EAAQ1I,IAAU,4HAG6B/C,KAAKgD,WAAWyI,EAAOC,0GAE9DD,EAAO/B,KAAK/G,wLAMNI,6YAeAA,4FAOnBE,KAAK,IAGRjD,KAAKnB,WAAWqE,iBAAiB,WAAWC,QAAQC,IAClDA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMN,EAAQN,SAAUY,EAAEC,OAAuBC,aAAa,eAAiB,KAC/EvD,KAAK2L,aAAa5I,OAKtB/C,KAAKnB,WAAWqE,iBAAiB,eAAeC,QAAQC,IACtDA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMN,EAAQN,SAAUY,EAAEC,OAAuBC,aAAa,eAAiB,KAC/EvD,KAAK4L,aAAa7I,QApDpB/C,KAAKnB,WAAW+D,UAAY,wCAuDhC,CAKQ,sBAAM4B,CAAiByG,GAC7B,MAAMC,EAAQD,EAAM3H,OACd6H,EAAOD,EAAME,QAAQ,GAE3B,GAAKD,EAEL,IACEnL,KAAKjB,yBAA2BoM,EAAKrF,OAGrC9F,KAAKD,gBAAkBoL,EAAKO,KAAKjF,QAAQ,wBAAyB,IAG9DzG,KAAKlB,kBACPkB,KAAKlB,gBAAgBiD,YAAcoJ,EAAKO,KACxC1L,KAAKlB,gBAAgBkD,MAAM6J,MAAQ,QAGrC7L,KAAKkF,WACH,UAAUiG,EAAKO,SAAS1L,KAAKjB,mBAAmB4D,aAChD,UAEJ,CAAE,MAAO0C,GACPD,QAAQC,MAAM,UAAWA,GACzBrF,KAAKkF,WAAW,WAAY,QAC9B,CACF,CAGQ,SAAAT,GAEN,IAAKzE,KAAKjB,oBAAgE,IAA1CiB,KAAKjB,mBAAmBiH,OAAOrD,OAAc,CAC3E3C,KAAKkF,WAAW,WAAY,SAC5B,MAAM4G,EAAcxL,SAASC,eAAe,yBAO5C,YANIuL,IACFA,EAAY9J,MAAM+J,YAAc,UAChCxJ,WAAW,KACLuJ,IAAaA,EAAY9J,MAAM+J,YAAc,YAChD,MAGP,CAWA,GATK/L,KAAKR,gBAAgBK,cACxBG,KAAKR,gBAAgBK,YAAc,IAItBG,KAAKR,gBAAgBK,YAAY2I,KAC9CgB,GAAKA,EAAEkC,OAAS1L,KAAKD,iBAKrB,YADAC,KAAKkF,WAAW,UAAUlF,KAAKD,uBAAwB,SAIzD,MAAMiM,EAAY,CAChB/G,GAAI7D,KAAKC,MAAMK,WACfgK,KAAM1L,KAAKD,gBACX2J,KAAM1J,KAAKjB,mBACXkN,SAAS,GAGXjM,KAAKR,gBAAgBK,YAAYgH,KAAKmF,GACtChM,KAAK8B,mBAGD9B,KAAKlB,kBACPkB,KAAKlB,gBAAgBiD,YAAc,QACnC/B,KAAKlB,gBAAgBkD,MAAM6J,MAAQ,QAErC7L,KAAKjB,mBAAqB,GAC1BiB,KAAKD,gBAAkB,GAGnBC,KAAKrB,kBACPqB,KAAKrB,gBAAgB6C,MAAQ,IAG/BxB,KAAKwC,YAELxC,KAAKkF,WAAW,YAAY8G,EAAUN,OAAQ,UAChD,CACQ,YAAAE,CAAa7I,GACnB,IAAK/C,KAAKR,gBAAgBK,YAAa,OAEvC,MAAM4L,EAASzL,KAAKR,gBAAgBK,YAAYkD,GAChD,IAAK0I,EAAQ,OAGb,MAAMS,EAAQlM,KAAKnB,YAAYqE,iBAAiB,aAChD,IAAKgJ,IAAUA,EAAMnJ,GAAQ,OAE7B,MACMoJ,EADOD,EAAMnJ,GACMuD,cAAc,yBACvC,IAAK6F,EAAa,OAGlB,MAAMC,EAAeX,EAAOC,KACtBW,EAAeF,EAAYvJ,UAG3BsI,EAAQ5K,SAASuK,cAAc,SACrCK,EAAMP,KAAO,OACbO,EAAM1J,MAAQ4K,EACdlB,EAAMlJ,MAAMsK,QAAU,kMAYtBH,EAAYvJ,UAAY,GACxBuJ,EAAYI,YAAYrB,GACxBA,EAAMsB,QACNtB,EAAMuB,SAGN,MAAMC,EAAO,KACX,MAAMC,EAAUzB,EAAM1J,MAAMwE,OAE5B,OAAK2G,EAOU3M,KAAKR,gBAAgBK,YAAa2I,KAC/C,CAACgB,EAAG7B,IAAMA,IAAM5E,GAASyG,EAAEkC,OAASiB,IAIpCR,EAAYvJ,UAAYyJ,OACxBrM,KAAKkF,WAAW,UAAUyH,SAAgB,WAK5ClB,EAAOC,KAAOiB,EACdR,EAAYvJ,UAAY,MAAM5C,KAAKgD,WAAW2J,KAE9C3M,KAAKwC,iBACLxC,KAAKkF,WAAW,WAAWyH,IAAW,aArBpCR,EAAYvJ,UAAYyJ,OACxBrM,KAAKkF,WAAW,WAAY,WA6BhCgG,EAAM/I,iBAAiB,UAAYkB,IACnB,UAAVA,EAAEiB,KACJjB,EAAEuJ,iBACFF,KACmB,WAAVrJ,EAAEiB,MACXjB,EAAEuJ,iBATJT,EAAYvJ,UAAYyJ,KAe1BnB,EAAM/I,iBAAiB,OAAQuK,EACjC,CAKQ,YAAAf,CAAa5I,GACd/C,KAAKR,gBAAgBK,cAE1BG,KAAKR,gBAAgBK,YAAYyI,OAAOvF,EAAO,GAC/C/C,KAAK8B,mBACL9B,KAAKwC,YACLxC,KAAKkF,WAAW,gBAAiB,WACnC,CAEQ,wBAAM7E,GACZ,MAAMwM,QAAsBpM,OAAOC,QAAQI,MAAMF,IAAI,CAAC,kBACtDZ,KAAKT,kBAAoBsN,EAAcA,eAAeC,UAAY,UAGlE,MAAMC,EAAiBzM,SAASC,eAAe,0BACzCyM,EAAc1M,SAASC,eAAe,qBACxCwM,GAAkBC,GAAeH,EAAcA,gBACjDE,EAAe/K,MAAMyF,QAAU,QAC/BuF,EAAYjL,YAAc8K,EAAcA,cAAcI,aAAeJ,EAAcA,cAAcC,SACjGE,EAAY9G,MAAQ2G,EAAcA,cAAcC,UAGlD,MAAMI,EAAa,cAAclN,KAAKT,oBAChCiB,QAAeC,OAAOC,QAAQI,MAAMF,IAAI,CAACsM,IAC/ClN,KAAKV,WAAakB,EAAO0M,IAAe,CAAC,EACzClN,KAAKmN,kBACP,CAEQ,gBAAAA,GACN,IAAKnN,KAAKf,WAAY,OAEtB,MAAMmO,EAAUC,OAAOD,QAAQpN,KAAKV,YACb,IAAnB8N,EAAQzK,QAKZ3C,KAAKf,WAAW2D,UAAYwK,EACzBvK,IAAI,EAAEyK,EAAU5D,KAAU,iHAGS1J,KAAKgD,WAAWsK,+DAEvBtN,KAAKgD,WAAW0G,qGAEC1J,KAAKgD,WAAWsK,kBAAyBtN,KAAKgD,WAAW0G,wEACvD1J,KAAKgD,WAAWsK,uDAI/DrK,KAAK,IAGRjD,KAAKf,WAAWiE,iBAAiB,eAAeC,QAAQC,IACtDA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMiK,EAAYjK,EAAEC,OAAuBC,aAAa,iBACpD+J,GAAUtN,KAAKuN,aAAaD,OAKpCtN,KAAKf,WAAWiE,iBAAiB,aAAaC,QAAQC,IACpDA,EAAIjB,iBAAiB,QAAUkB,IAC7B,MAAMiK,EAAYjK,EAAEC,OAAuBC,aAAa,iBAClDmG,EAAQrG,EAAEC,OAAuBC,aAAa,aAChD+J,GAAY5D,IACV1J,KAAKd,mBAAkBc,KAAKd,iBAAiBsC,MAAQ8L,GACrDtN,KAAKb,eAAca,KAAKb,aAAaqC,MAAQkI,GACjD1J,KAAKb,cAAcqN,cAnCvBxM,KAAKf,WAAW2D,UAAY,uCAuChC,CAEQ,eAAM8B,GACZ,MAAM4I,EAAWtN,KAAKd,kBAAkBsC,MAAMwE,OACxC0D,EAAO1J,KAAKb,cAAcqC,MAAMwE,OAEtC,IAAKsH,IAAa5D,EAEhB,YADA1J,KAAKkF,WAAW,YAAa,SAI/BlF,KAAKV,WAAWgO,GAAY5D,EAC5B,MAAMwD,EAAa,cAAclN,KAAKT,0BAChCkB,OAAOC,QAAQI,MAAM4B,IAAI,CAAE,CAACwK,GAAalN,KAAKV,aAEhDU,KAAKd,mBAAkBc,KAAKd,iBAAiBsC,MAAQ,IACrDxB,KAAKb,eAAca,KAAKb,aAAaqC,MAAQ,IAEjDxB,KAAKmN,mBACLnN,KAAKkF,WAAW,UAAW,UAC7B,CAEQ,kBAAMqI,CAAaD,GACzB,GAAInD,QAAQ,SAASmD,aAAqB,QACjCtN,KAAKV,WAAWgO,GACvB,MAAMJ,EAAa,cAAclN,KAAKT,0BAChCkB,OAAOC,QAAQI,MAAM4B,IAAI,CAAE,CAACwK,GAAalN,KAAKV,aACpDU,KAAKmN,mBACLnN,KAAKkF,WAAW,UAAW,UAC7B,CACF,CAEQ,oBAAMP,GACZ,GAAIwF,QAAQ,4BAA6B,CACvCnK,KAAKV,WAAa,CAAC,EACnB,MAAM4N,EAAa,cAAclN,KAAKT,0BAChCkB,OAAOC,QAAQI,MAAM4B,IAAI,CAAE,CAACwK,GAAa,CAAC,IAChDlN,KAAKmN,mBACLnN,KAAKkF,WAAW,UAAW,UAC7B,CACF,EAGF5E,SAAS6B,iBAAiB,mBAAoB,KAC5C,IAAI/E,G","sources":["webpack://ai-to-vscode-bridge/./src/popup.ts"],"sourcesContent":["interface SiteConfig {\r\n  hostname: string;\r\n  copyButtonSelector: string;\r\n  responseContainerSelector?: string;\r\n  name?: string;\r\n}\r\n\r\ninterface PromptFile {\r\n  id: string;\r\n  name: string;      // ÊòæÁ§∫ÂêçÁß∞\r\n  path: string;      // Â≠òÂÇ®Êñá‰ª∂ÂÜÖÂÆπÔºàËÄå‰∏çÊòØË∑ØÂæÑÔºâ\r\n  enabled: boolean;  // ÊòØÂê¶ÂêØÁî®\r\n}\r\n\r\ninterface Settings {\r\n  port: number;\r\n  enabledUrls: string[];\r\n  showOnAllSites: boolean;\r\n  siteConfigs: SiteConfig[];\r\n  promptFiles?: PromptFile[];  // ÊèêÁ§∫ËØçÊñá‰ª∂ÂàóË°®\r\n  savePath?: string;\r\n}\r\n\r\n// ‰øÆÊîπÂéüÊù•ÁöÑ ButtonCandidate Êé•Âè£ÔºåÂéªÊéâ element Â±ûÊÄß\r\ninterface ButtonCandidate {\r\n  selector: string;\r\n  label: string;\r\n  ariaLabel: string;\r\n  text: string;\r\n  score: number;\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöËçâÁ®øÊé•Âè£\r\ninterface DraftSettings {\r\n  port?: number;\r\n  enabledUrls?: string[];\r\n  showOnAllSites?: boolean;\r\n  siteConfigs?: SiteConfig[];\r\n  promptFiles?: PromptFile[];\r\n  timestamp?: number;\r\n}\r\n\r\nconst DEFAULT_URLS = [\r\n  'chat.openai.com',\r\n  'claude.ai',\r\n  'gemini.google.com',\r\n  'chatgpt.com',\r\n  'poe.com',\r\n  'perplexity.ai',\r\n  'deepseek.com',\r\n  'aistudio.google.com'\r\n];\r\n\r\n\r\nclass PopupManager {\r\n  private autoSaveTimer: number | null = null; // Êñ∞Â¢ûÔºöËá™Âä®‰øùÂ≠òÂÆöÊó∂Âô®\r\n  private hasDraft: boolean = false; // Êñ∞Â¢ûÔºöÊòØÂê¶ÊúâËçâÁ®ø\r\n\r\n  private portInput: HTMLInputElement | null = null;\r\n  private showOnAllSitesCheckbox: HTMLInputElement | null = null;\r\n  private urlList: HTMLElement | null = null;\r\n  private newUrlInput: HTMLInputElement | null = null;\r\n  private saveButton: HTMLButtonElement | null = null;\r\n  private resetButton: HTMLButtonElement | null = null;\r\n  private addUrlButton: HTMLButtonElement | null = null;\r\n  private exportButton: HTMLButtonElement | null = null;\r\n  private importButton: HTMLButtonElement | null = null;\r\n  private importFileInput: HTMLInputElement | null = null;\r\n  private smartFindButton: HTMLButtonElement | null = null;\r\n  private statusDiv: HTMLElement | null = null;\r\n\r\n  private configList: HTMLElement | null = null;\r\n  private configHostnameInput: HTMLInputElement | null = null;\r\n  private configSelectorInput: HTMLInputElement | null = null;\r\n  private configContainerInput: HTMLInputElement | null = null;\r\n  private addConfigButton: HTMLButtonElement | null = null;\r\n\r\n  // ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n  private promptPathInput: HTMLInputElement | null = null;\r\n  private selectFileButton: HTMLButtonElement | null = null;\r\n  private promptFileInput: HTMLInputElement | null = null;\r\n  private addPromptButton: HTMLButtonElement | null = null;\r\n  private promptList: HTMLElement | null = null;\r\n  private fileNameDisplay: HTMLElement | null = null;\r\n  private currentFileContent: string = '';\r\n\r\n  private savePathInput: HTMLInputElement | null = null;\r\n\r\n  // Ë∑ØÂæÑËÆ∞ÂøÜÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n  private memoryList: HTMLElement | null = null;\r\n  private memFilenameInput: HTMLInputElement | null = null;\r\n  private memPathInput: HTMLInputElement | null = null;\r\n  private addMemButton: HTMLButtonElement | null = null;\r\n  private clearMemButton: HTMLButtonElement | null = null;\r\n  private pathMemory: Record<string, string> = {};\r\n  private activeProjectRoot: string = 'default';\r\n\r\n  private currentSettings: Settings = {\r\n    port: 8765,\r\n    enabledUrls: [...DEFAULT_URLS],\r\n    showOnAllSites: false,\r\n    siteConfigs: [],\r\n    promptFiles: [],\r\n  };\r\n\r\n  private selectedCandidate: ButtonCandidate | null = null;\r\n\r\n  constructor() {\r\n    this.initElements();\r\n    this.loadSettings();\r\n    this.setupEventListeners();\r\n    this.setupAutoSave();\r\n    this.loadPathMemoryData(); // Âä†ËΩΩË∑ØÂæÑËÆ∞ÂøÜÊï∞ÊçÆ\r\n  }\r\n\r\n  private initElements(): void {\r\n    this.portInput = document.getElementById('port-input') as HTMLInputElement;\r\n    this.showOnAllSitesCheckbox = document.getElementById('show-on-all-sites') as HTMLInputElement;\r\n    this.urlList = document.getElementById('url-list');\r\n    this.newUrlInput = document.getElementById('new-url-input') as HTMLInputElement;\r\n    this.saveButton = document.getElementById('save-settings') as HTMLButtonElement;\r\n    this.resetButton = document.getElementById('reset-defaults') as HTMLButtonElement;\r\n    this.addUrlButton = document.getElementById('add-url-btn') as HTMLButtonElement;\r\n    this.exportButton = document.getElementById('export-config') as HTMLButtonElement;\r\n    this.importButton = document.getElementById('import-config') as HTMLButtonElement;\r\n    this.importFileInput = document.getElementById('import-file-input') as HTMLInputElement;\r\n    this.smartFindButton = document.getElementById('smart-find-btn') as HTMLButtonElement;\r\n    this.statusDiv = document.getElementById('status');\r\n\r\n    this.configList = document.getElementById('config-list');\r\n    this.configHostnameInput = document.getElementById('config-hostname') as HTMLInputElement;\r\n    this.configSelectorInput = document.getElementById('config-selector') as HTMLInputElement;\r\n    this.configContainerInput = document.getElementById('config-container') as HTMLInputElement;\r\n    this.addConfigButton = document.getElementById('add-config-btn') as HTMLButtonElement;\r\n\r\n    // ÂàùÂßãÂåñÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n    this.promptPathInput = document.getElementById('prompt-path') as HTMLInputElement;\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.addPromptButton = document.getElementById('add-prompt-btn') as HTMLButtonElement;\r\n    this.promptList = document.getElementById('prompt-list');\r\n\r\n    // Âú® initElements ‰∏≠Ê∑ªÂä†\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.fileNameDisplay = document.getElementById('file-name-display');\r\n\r\n    this.savePathInput = document.getElementById('save-path') as HTMLInputElement;\r\n\r\n    // ÂàùÂßãÂåñË∑ØÂæÑËÆ∞ÂøÜÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n    this.memoryList = document.getElementById('memory-list');\r\n    this.memFilenameInput = document.getElementById('mem-filename') as HTMLInputElement;\r\n    this.memPathInput = document.getElementById('mem-path') as HTMLInputElement;\r\n    this.addMemButton = document.getElementById('add-mem-btn') as HTMLButtonElement;\r\n    this.clearMemButton = document.getElementById('clear-mem-btn') as HTMLButtonElement;\r\n  }\r\n\r\n  private async loadSettings(): Promise<void> {\r\n    // ÂÖàÂä†ËΩΩÊ≠£ÂºèÈÖçÁΩÆÔºå‰ΩøÁî®Âçï‰∏Ä key \"settings\"\r\n    const result = await chrome.storage.sync.get('settings');\r\n    let settings: Settings;\r\n    if (result.settings) {\r\n      settings = result.settings as Settings;\r\n    } else {\r\n      // ÂõûÈÄÄÂà∞ÊóßÊ†ºÂºèÔºàÂÖºÂÆπÊÄßÔºâ\r\n      const oldSettings = await chrome.storage.sync.get({\r\n        port: 8765,\r\n        enabledUrls: [...DEFAULT_URLS],\r\n        showOnAllSites: false,\r\n        siteConfigs: [],\r\n        promptFiles: []\r\n      }) as Settings;\r\n      settings = oldSettings;\r\n    }\r\n\r\n    // ‰ªé local Âä†ËΩΩÊèêÁ§∫ËØçÊñá‰ª∂ÔºàÂàÜÁ¶ªÂ≠òÂÇ®Ôºâ\r\n    const promptResult = await chrome.storage.local.get('promptFiles');\r\n    const promptFiles: PromptFile[] = promptResult.promptFiles || [];\r\n    settings.promptFiles = promptFiles;\r\n\r\n    // Â∞ùËØïÂä†ËΩΩËçâÁ®ø\r\n    const draft = await chrome.storage.local.get('draftSettings');\r\n\r\n    if (draft.draftSettings) {\r\n      const draftData: DraftSettings = draft.draftSettings;\r\n\r\n      // Ê£ÄÊü•ËçâÁ®øÊòØÂê¶Âú®5ÂàÜÈíüÂÜÖÔºàÈÅøÂÖçÂä†ËΩΩËøáÊúüËçâÁ®øÔºâ\r\n      const fiveMinutes = 5 * 60 * 1000;\r\n      if (draftData.timestamp && Date.now() - draftData.timestamp < fiveMinutes) {\r\n        // ‰ΩøÁî®ËçâÁ®øË¶ÜÁõñËÆæÁΩÆ\r\n        this.currentSettings = {\r\n          port: draftData.port ?? settings.port,\r\n          enabledUrls: draftData.enabledUrls ?? settings.enabledUrls,\r\n          showOnAllSites: draftData.showOnAllSites ?? settings.showOnAllSites,\r\n          siteConfigs: draftData.siteConfigs ?? settings.siteConfigs,\r\n          promptFiles: draftData.promptFiles ?? settings.promptFiles\r\n        };\r\n\r\n        this.hasDraft = true;\r\n        this.showDraftIndicator();\r\n      } else {\r\n        // ËçâÁ®øËøáÊúüÔºå‰ΩøÁî®Ê≠£ÂºèÈÖçÁΩÆ\r\n        this.currentSettings = settings;\r\n        await chrome.storage.local.remove('draftSettings');\r\n      }\r\n    } else {\r\n      this.currentSettings = settings;\r\n    }\r\n\r\n    if (this.savePathInput) {\r\n      this.savePathInput.value = this.currentSettings.savePath || '';\r\n    }\r\n    // Êõ¥Êñ∞UI\r\n    if (this.portInput) this.portInput.value = this.currentSettings.port.toString();\r\n    if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = this.currentSettings.showOnAllSites;\r\n\r\n\r\n    this.renderUrlList();\r\n    this.renderConfigList();\r\n    this.renderPromptList();\r\n  }\r\n\r\n  // Êñ∞Â¢ûÔºöÊòæÁ§∫ËçâÁ®øÊåáÁ§∫Âô®\r\n  private showDraftIndicator(): void {\r\n    if (this.saveButton) {\r\n      this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ (ÊúâÊú™‰øùÂ≠òÁöÑÊõ¥Êîπ)';\r\n      this.saveButton.style.background = '#e67e22';\r\n    }\r\n  }\r\n\r\n  // Êñ∞Â¢ûÔºöÈöêËóèËçâÁ®øÊåáÁ§∫Âô®\r\n  private hideDraftIndicator(): void {\r\n    if (this.saveButton) {\r\n      this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n      this.saveButton.style.background = '#007acc';\r\n    }\r\n    this.hasDraft = false;\r\n  }\r\n\r\n  // Êñ∞Â¢ûÔºöËÆæÁΩÆËá™Âä®‰øùÂ≠ò\r\n  private setupAutoSave(): void {\r\n    // ÁõëÂê¨ÊâÄÊúâÂèØËÉΩ‰øÆÊîπÈÖçÁΩÆÁöÑËæìÂÖ•\r\n    this.portInput?.addEventListener('input', () => this.scheduleAutoSave());\r\n    this.showOnAllSitesCheckbox?.addEventListener('change', () => this.scheduleAutoSave());\r\n  }\r\n\r\n  // Êñ∞Â¢ûÔºöÂª∂ËøüËá™Âä®‰øùÂ≠òÔºàÈò≤Ê≠¢È¢ëÁπÅ‰øùÂ≠òÔºâ\r\n  private scheduleAutoSave(): void {\r\n    if (this.autoSaveTimer) {\r\n      clearTimeout(this.autoSaveTimer);\r\n    }\r\n\r\n    this.autoSaveTimer = window.setTimeout(() => {\r\n      this.saveDraft();\r\n    }, 500); // 500msÂêé‰øùÂ≠òËçâÁ®ø\r\n  }\r\n\r\n  // Êñ∞Â¢ûÔºö‰øùÂ≠òËçâÁ®ø\r\n  private async saveDraft(): Promise<void> {\r\n    const draft: DraftSettings = {\r\n      port: parseInt(this.portInput?.value || '8765'),\r\n      enabledUrls: this.currentSettings.enabledUrls,\r\n      showOnAllSites: this.showOnAllSitesCheckbox?.checked || false,\r\n      siteConfigs: this.currentSettings.siteConfigs,\r\n      promptFiles: this.currentSettings.promptFiles,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    await chrome.storage.local.set({ draftSettings: draft });\r\n\r\n    if (!this.hasDraft) {\r\n      this.hasDraft = true;\r\n      this.showDraftIndicator();\r\n    }\r\n  }\r\n\r\n  private renderUrlList(): void {\r\n    if (!this.urlList) return;\r\n\r\n    if (this.currentSettings.enabledUrls.length === 0) {\r\n      this.urlList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÁΩëÁ´ô</div>';\r\n      return;\r\n    }\r\n\r\n    this.urlList.innerHTML = this.currentSettings.enabledUrls\r\n      .map((url, index) => `\r\n        <div class=\"url-item\">\r\n          <span>${this.escapeHtml(url)}</span>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.urlList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeUrl(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private renderConfigList(): void {\r\n    if (!this.configList) return;\r\n\r\n    if (this.currentSettings.siteConfigs.length === 0) {\r\n      this.configList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†Ëá™ÂÆö‰πâÈÖçÁΩÆ</div>';\r\n      return;\r\n    }\r\n\r\n    this.configList.innerHTML = this.currentSettings.siteConfigs\r\n      .map((config, index) => `\r\n        <div class=\"url-item\">\r\n          <div style=\"flex: 1;\">\r\n            <div style=\"font-weight: 500; color: #fff;\">${this.escapeHtml(config.hostname)}</div>\r\n            <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n              ${this.escapeHtml(config.copyButtonSelector)}\r\n            </div>\r\n            ${config.responseContainerSelector ? `\r\n              <div style=\"font-size: 10px; color: #666; margin-top: 2px;\">\r\n                ÂÆπÂô®: ${this.escapeHtml(config.responseContainerSelector)}\r\n              </div>\r\n            ` : ''}\r\n          </div>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.configList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeConfig(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n    // Âü∫Êú¨ÂäüËÉΩ\r\n    this.saveButton?.addEventListener('click', () => this.saveSettings());\r\n    this.resetButton?.addEventListener('click', () => this.resetToDefaults());\r\n    this.addUrlButton?.addEventListener('click', () => this.addUrl());\r\n    this.addConfigButton?.addEventListener('click', () => this.addConfig());\r\n    this.exportButton?.addEventListener('click', () => this.exportConfig());\r\n    this.importButton?.addEventListener('click', () => this.importFileInput?.click());\r\n    this.smartFindButton?.addEventListener('click', () => this.smartFindCopyButtons());\r\n    this.importFileInput?.addEventListener('change', (e) => this.handleImportFile(e));\r\n    this.savePathInput?.addEventListener('input', () => this.saveDraft());\r\n\r\n    // URL ËæìÂÖ•ÂõûËΩ¶Âø´Êç∑ÈîÆ\r\n    this.newUrlInput?.addEventListener('keypress', (e) => {\r\n      if (e.key === 'Enter') this.addUrl();\r\n    });\r\n\r\n    // ÈÖçÁΩÆËæìÂÖ• Ctrl+Enter Âø´Êç∑ÈîÆ\r\n    this.configSelectorInput?.addEventListener('keypress', (e) => {\r\n      if (e.key === 'Enter' && e.ctrlKey) this.addConfig();\r\n    });\r\n\r\n    // ‚úÖ ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÔºàÂè™‰øùÁïô‰∏ÄÊ¨°Ôºâ\r\n    this.selectFileButton?.addEventListener('click', () => this.promptFileInput?.click());\r\n    this.promptFileInput?.addEventListener('change', (e) => this.handleFileSelect(e));\r\n    this.addPromptButton?.addEventListener('click', () => this.addPrompt());\r\n\r\n    // Ë∑ØÂæÑËÆ∞ÂøÜÁõ∏ÂÖ≥\r\n    this.addMemButton?.addEventListener('click', () => this.addMemory());\r\n    this.clearMemButton?.addEventListener('click', () => this.clearAllMemory());\r\n  }\r\n\r\n  private async smartFindCopyButtons(): Promise<void> {\r\n    try {\r\n      const tabs = await chrome.tabs.query({ active: true, currentWindow: true });\r\n      const activeTab = tabs[0];\r\n\r\n      if (!activeTab || !activeTab.id) {\r\n        this.showStatus('Êó†Ê≥ïËé∑ÂèñÂΩìÂâçÊ†áÁ≠æÈ°µ', 'error');\r\n        return;\r\n      }\r\n\r\n      // Ëá™Âä®Â°´ÂÖÖÂüüÂêç\r\n      if (activeTab.url) {\r\n        try {\r\n          const url = new URL(activeTab.url);\r\n          if (this.configHostnameInput) {\r\n            this.configHostnameInput.value = url.hostname;\r\n          }\r\n        } catch (e) {\r\n          console.error('Ëß£ÊûêURLÂ§±Ë¥•:', e);\r\n        }\r\n      }\r\n\r\n      this.showScanningModal();\r\n\r\n      // Ê≥®ÂÖ•ËÑöÊú¨Êü•ÊâæÊåâÈíÆ\r\n      const results = await chrome.scripting.executeScript({\r\n        target: { tabId: activeTab.id },\r\n        func: () => {\r\n          // === ËøôÊÆµ‰ª£Á†Å‰ºöÂú®ÁõÆÊ†áÈ°µÈù¢‰∏≠ÊâßË°å ===\r\n          // Âú®ËøôÈáåÈáçÊñ∞ÂÆö‰πâÔºåÈÅøÂÖç‰∏éÂ§ñÈÉ®ÂÜ≤Á™Å\r\n          type CandidateResult = {\r\n            selector: string;\r\n            label: string;\r\n            ariaLabel: string;\r\n            text: string;\r\n            score: number;\r\n          };\r\n\r\n          const candidates: CandidateResult[] = [];\r\n          const buttons = document.querySelectorAll('button');\r\n\r\n          buttons.forEach((button) => {\r\n            const text = button.textContent?.toLowerCase().trim() || '';\r\n            const ariaLabel = button.getAttribute('aria-label')?.toLowerCase() || '';\r\n            const title = button.getAttribute('title')?.toLowerCase() || '';\r\n            const className = button.className.toLowerCase();\r\n\r\n            let score = 0;\r\n\r\n            // ËØÑÂàÜËßÑÂàô\r\n            if (text.includes('copy') || text.includes('Â§çÂà∂')) score += 10;\r\n            if (ariaLabel.includes('copy') || ariaLabel.includes('Â§çÂà∂')) score += 10;\r\n            if (title.includes('copy') || title.includes('Â§çÂà∂')) score += 5;\r\n            if (className.includes('copy')) score += 5;\r\n\r\n            const svg = button.querySelector('svg');\r\n            if (svg) score += 2;\r\n\r\n            // Âè™‰øùÁïôÁõ∏ÂÖ≥Â∫¶Ë∂≥Â§üÈ´òÁöÑÊåâÈíÆ\r\n            if (score >= 5) {\r\n              let selector = '';\r\n              const ariaLabelAttr = button.getAttribute('aria-label');\r\n\r\n              // ÁîüÊàêÈÄâÊã©Âô®\r\n              if (ariaLabelAttr) {\r\n                // ËΩ¨‰πâÂºïÂè∑\r\n                const escapedLabel = ariaLabelAttr.replace(/\"/g, '\\\\\"');\r\n                selector = `button[aria-label=\"${escapedLabel}\"]`;\r\n              } else if (button.id) {\r\n                selector = `button#${button.id}`;\r\n              } else if (button.className && button.className.trim()) {\r\n                const classes = button.className.trim().split(/\\s+/).slice(0, 2);\r\n                if (classes.length > 0) {\r\n                  selector = `button.${classes.join('.')}`;\r\n                } else {\r\n                  selector = 'button';\r\n                }\r\n              } else {\r\n                selector = 'button';\r\n              }\r\n\r\n              candidates.push({\r\n                selector: selector,\r\n                label: text || ariaLabel || '(Êó†Ê†áÁ≠æ)',\r\n                ariaLabel: ariaLabelAttr || '',\r\n                text: text,\r\n                score: score\r\n              });\r\n            }\r\n          });\r\n\r\n          // ÊåâÂàÜÊï∞ÊéíÂ∫è\r\n          candidates.sort((a, b) => b.score - a.score);\r\n\r\n          // ËøîÂõûÂâç10‰∏™\r\n          return candidates.slice(0, 10);\r\n        }\r\n      });\r\n\r\n      const candidates: ButtonCandidate[] = results[0]?.result || [];\r\n\r\n      if (candidates.length === 0) {\r\n        this.showEmptyResultModal();\r\n      } else {\r\n        this.showCandidatesModal(candidates);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•:', error);\r\n\r\n      let errorMsg = 'Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•';\r\n      if (error instanceof Error) {\r\n        errorMsg += ': ' + error.message;\r\n      }\r\n\r\n      this.showStatus(errorMsg, 'error');\r\n      this.closeModal();\r\n    }\r\n  }\r\n\r\n\r\n  private showScanningModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Ê≠£Âú®Êâ´ÊèèÈ°µÈù¢...</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"scanning-indicator\">\r\n            <div class=\"spinner\"></div>\r\n            <p style=\"color: #888;\">Ê≠£Âú®Êü•ÊâæCOPYÊåâÈíÆ...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    modal.style.display = 'flex';\r\n\r\n    document.getElementById('modal-close')?.addEventListener('click', () => {\r\n      this.closeModal();\r\n    });\r\n  }\r\n\r\n  private showEmptyResultModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Êü•ÊâæÁªìÊûú</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"empty-result\">\r\n            <div class=\"empty-result-icon\">üòï</div>\r\n            <p>Êú™ÊâæÂà∞COPYÊåâÈíÆ</p>\r\n            <p style=\"font-size: 12px; color: #666; margin-top: 8px;\">\r\n              ËØ∑Á°Æ‰øùÂΩìÂâçÈ°µÈù¢ÊúâAIÂØπËØùÂõûÁ≠îÔºåÂπ∂‰∏îÊúâÂ§çÂà∂ÊåâÈíÆ\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂÖ≥Èó≠</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    modal.style.display = 'flex';\r\n\r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n  }\r\n\r\n  private showCandidatesModal(candidates: ButtonCandidate[]): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç ÊâæÂà∞ ${candidates.length} ‰∏™ÂÄôÈÄâÊåâÈíÆ</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <p style=\"margin-bottom: 12px; font-size: 13px; color: #888;\">\r\n            ÁÇπÂáªÈÄâÊã©‰∏Ä‰∏™COPYÊåâÈíÆÔºö\r\n          </p>\r\n          ${candidates.map((c, i) => `\r\n            <div class=\"button-candidate\" data-index=\"${i}\">\r\n              <div class=\"button-info\">\r\n                <div class=\"button-label\">${this.escapeHtml(c.label)}</div>\r\n                <div class=\"button-selector\">${this.escapeHtml(c.selector)}</div>\r\n                <div class=\"button-details\">\r\n                  ${c.ariaLabel ? `aria-label: ${this.escapeHtml(c.ariaLabel)}` : ''}\r\n                  ${c.score ? ` ‚Ä¢ Áõ∏ÂÖ≥Â∫¶: ${c.score}ÂàÜ` : ''}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          `).join('')}\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂèñÊ∂à</button>\r\n          <button class=\"btn-confirm\" id=\"modal-confirm\" disabled>Á°ÆÂÆö</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    modal.style.display = 'flex';\r\n\r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-confirm')?.addEventListener('click', () => this.confirmSelection());\r\n\r\n    const candidateElements = modal.querySelectorAll('.button-candidate');\r\n    candidateElements.forEach((el) => {\r\n      el.addEventListener('click', (e) => {\r\n        const index = parseInt((e.currentTarget as HTMLElement).getAttribute('data-index') || '0');\r\n        this.selectCandidate(index, candidates);\r\n      });\r\n    });\r\n  }\r\n\r\n  private selectCandidate(index: number, candidates: ButtonCandidate[]): void {\r\n    this.selectedCandidate = candidates[index];\r\n\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.querySelectorAll('.button-candidate').forEach(el => {\r\n      el.classList.remove('selected');\r\n    });\r\n\r\n    const selected = modal.querySelector(`[data-index=\"${index}\"]`);\r\n    selected?.classList.add('selected');\r\n\r\n    const confirmBtn = document.getElementById('modal-confirm') as HTMLButtonElement;\r\n    if (confirmBtn) confirmBtn.disabled = false;\r\n  }\r\n\r\n  private confirmSelection(): void {\r\n    if (!this.selectedCandidate) return;\r\n\r\n    if (this.configSelectorInput) {\r\n      this.configSelectorInput.value = this.selectedCandidate.selector;\r\n    }\r\n\r\n    this.showStatus(`‚úÖ Â∑≤ÈÄâÊã©: ${this.selectedCandidate.selector}`, 'success');\r\n    this.closeModal();\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private closeModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (modal) {\r\n      modal.style.display = 'none';\r\n      modal.innerHTML = '';\r\n    }\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private addUrl(): void {\r\n    const url = this.newUrlInput?.value.trim();\r\n    if (!url) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÁΩëÁ´ôÂüüÂêç', 'error');\r\n      return;\r\n    }\r\n\r\n    if (!/^[\\w\\-.*]+(\\.\\w{2,})?$/.test(url) && url !== 'localhost') {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÂüüÂêçÊ†ºÂºè', 'error');\r\n      return;\r\n    }\r\n\r\n    if (this.currentSettings.enabledUrls.includes(url)) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÂ∑≤Â≠òÂú®', 'error');\r\n      return;\r\n    }\r\n\r\n    this.currentSettings.enabledUrls.push(url);\r\n    this.renderUrlList();\r\n\r\n    if (this.newUrlInput) {\r\n      this.newUrlInput.value = '';\r\n    }\r\n\r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeUrl(index: number): void {\r\n    this.currentSettings.enabledUrls.splice(index, 1);\r\n    this.renderUrlList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private addConfig(): void {\r\n    const hostname = this.configHostnameInput?.value.trim();\r\n    const selector = this.configSelectorInput?.value.trim();\r\n    const container = this.configContainerInput?.value.trim();\r\n\r\n    if (!hostname || !selector) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÂüüÂêçÂíåCOPYÊåâÈíÆÈÄâÊã©Âô®', 'error');\r\n      return;\r\n    }\r\n\r\n    const exists = this.currentSettings.siteConfigs.some(\r\n      config => config.hostname === hostname\r\n    );\r\n\r\n    if (exists) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÈÖçÁΩÆÂ∑≤Â≠òÂú®ÔºåËØ∑ÂÖàÂà†Èô§', 'error');\r\n      return;\r\n    }\r\n\r\n    const newConfig: SiteConfig = {\r\n      hostname,\r\n      copyButtonSelector: selector,\r\n      responseContainerSelector: container || undefined\r\n    };\r\n\r\n    this.currentSettings.siteConfigs.push(newConfig);\r\n    this.renderConfigList();\r\n\r\n    if (this.configHostnameInput) this.configHostnameInput.value = '';\r\n    if (this.configSelectorInput) this.configSelectorInput.value = '';\r\n    if (this.configContainerInput) this.configContainerInput.value = '';\r\n\r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÈÖçÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeConfig(index: number): void {\r\n    this.currentSettings.siteConfigs.splice(index, 1);\r\n    this.renderConfigList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private async saveSettings(): Promise<void> {\r\n    const saveBtn = document.getElementById('save-settings') as HTMLButtonElement;\r\n\r\n    if (!saveBtn) return;\r\n\r\n    try {\r\n      // ‰øùÂ≠òËÆæÁΩÆÈÄªËæë\r\n      this.currentSettings.savePath = this.savePathInput?.value.trim() || '';\r\n\r\n      // ÂàÜÁ¶ªÂ≠òÂÇ®ÔºöÊèêÁ§∫ËØçÊñá‰ª∂‰øùÂ≠òÂà∞ local\r\n      const promptFiles = this.currentSettings.promptFiles || [];\r\n      await chrome.storage.local.set({ promptFiles });\r\n\r\n      // ÂàõÂª∫‰∏çÂåÖÂê´ promptFiles ÁöÑÈÖçÁΩÆÂØπË±°Áî®‰∫é sync Â≠òÂÇ®\r\n      const settingsForSync: Settings = {\r\n        ...this.currentSettings,\r\n        promptFiles: undefined\r\n      };\r\n      // Âà†Èô§ promptFiles Â≠óÊÆµÔºåÈÅøÂÖçÂç†Áî®Á©∫Èó¥\r\n      delete settingsForSync.promptFiles;\r\n\r\n      // Ë∞ÉËØïÔºöËÆ°ÁÆóÈÖçÁΩÆÂ§ßÂ∞è\r\n      const settingsJson = JSON.stringify(settingsForSync);\r\n      const sizeInBytes = new Blob([settingsJson]).size;\r\n      console.log(`‰øùÂ≠òÈÖçÁΩÆÂà∞ syncÔºåÂ§ßÂ∞è: ${sizeInBytes} Â≠óËäÇ (${(sizeInBytes / 1024).toFixed(2)} KB)`);\r\n      if (sizeInBytes > 8192) {\r\n        console.warn('ÈÖçÁΩÆÂ§ßÂ∞èË∂ÖËøá 8KBÔºåÂèØËÉΩË∂ÖÂá∫ chrome.storage.sync ÂçïÈ°πÈôêÂà∂');\r\n      }\r\n      // ËØ¶ÁªÜÂàÜÊûêÂêÑÈÉ®ÂàÜÂ§ßÂ∞è\r\n      const analysis: Record<string, number> = {};\r\n      if (promptFiles.length > 0) {\r\n        let totalPromptSize = 0;\r\n        promptFiles.forEach((p, i) => {\r\n          const promptSize = new Blob([p.path]).size;\r\n          totalPromptSize += promptSize;\r\n          analysis[`promptFiles[${i}].path`] = promptSize;\r\n        });\r\n        analysis['promptFiles.total'] = totalPromptSize;\r\n      }\r\n      analysis['enabledUrls'] = new Blob([JSON.stringify(this.currentSettings.enabledUrls)]).size;\r\n      analysis['siteConfigs'] = new Blob([JSON.stringify(this.currentSettings.siteConfigs)]).size;\r\n      analysis['other'] = sizeInBytes - (analysis['promptFiles.total'] || 0) - analysis['enabledUrls'] - analysis['siteConfigs'];\r\n      console.log('ÈÖçÁΩÆÂ§ßÂ∞èÂàÜÊûê:', analysis);\r\n\r\n      // ‰ΩøÁî®Âçï‰∏Ä key \"settings\" Â≠òÂÇ®Êï¥‰∏™ÈÖçÁΩÆÂØπË±°Ôºà‰∏çÂê´ promptFilesÔºâÔºåÈÅøÂÖçË∂ÖÂá∫Â≠òÂÇ®ÈôêÂà∂\r\n      await new Promise<void>((resolve, reject) => {\r\n        chrome.storage.sync.set(\r\n          { settings: settingsForSync },\r\n          () => {\r\n            const err = chrome.runtime.lastError;\r\n            if (err) {\r\n              console.error('chrome.storage.sync.set error:', err);\r\n              reject(err);\r\n            } else {\r\n              resolve();\r\n            }\r\n          }\r\n        );\r\n      });\r\n\r\n      // ‚úÖ ‰øùÂ≠òÊàêÂäüÔºåÊÅ¢Â§çÊåâÈíÆÈªòËÆ§Áä∂ÊÄÅ\r\n      saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n      saveBtn.className = 'primary';  // ÊÅ¢Â§çËìùËâ≤Ê†∑Âºè\r\n      saveBtn.disabled = false;\r\n\r\n      this.showStatus('‚úÖ ËÆæÁΩÆÂ∑≤‰øùÂ≠ò', 'success');\r\n\r\n      // Ê∏ÖÈô§ËçâÁ®ø\r\n      await chrome.storage.local.remove('draftSettings');\r\n\r\n    } catch (error) {\r\n      console.error('‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:', error);\r\n      // ÊèêÂèñÂèØËØªÁöÑÈîôËØØÊ∂àÊÅØ\r\n      let errorMessage = 'Êú™Áü•ÈîôËØØ';\r\n      if (error instanceof Error) {\r\n        errorMessage = error.message;\r\n      } else if (error && typeof error === 'object') {\r\n        // Â§ÑÁêÜ chrome.runtime.lastError ÂØπË±°\r\n        if ('message' in error && typeof error.message === 'string') {\r\n          errorMessage = error.message;\r\n        } else {\r\n          errorMessage = JSON.stringify(error);\r\n        }\r\n      } else {\r\n        errorMessage = String(error);\r\n      }\r\n      this.showStatus(`‚ùå ‰øùÂ≠òÂ§±Ë¥•: ${errorMessage}`, 'error');\r\n\r\n      // Âá∫Èîô‰πüÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ\r\n      saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n      saveBtn.className = 'primary';\r\n    }\r\n  }\r\n\r\n\r\n  private async resetToDefaults(): Promise<void> {\r\n    if (!confirm('Á°ÆÂÆöË¶ÅÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÂêóÔºüÊâÄÊúâËá™ÂÆö‰πâÈÖçÁΩÆÂ∞ÜË¢´Ê∏ÖÈô§„ÄÇ')) {\r\n      return;\r\n    }\r\n\r\n    this.currentSettings = {\r\n      port: 8765,\r\n      enabledUrls: [...DEFAULT_URLS],\r\n      showOnAllSites: false,\r\n      siteConfigs: [],\r\n      promptFiles: []\r\n    };\r\n\r\n    if (this.portInput) this.portInput.value = '8765';\r\n    if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = false;\r\n\r\n\r\n    this.renderUrlList();\r\n    this.renderConfigList();\r\n    this.renderPromptList();\r\n    this.showStatus('‚úÖ Â∑≤ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠ò', 'success');\r\n  }\r\n\r\n  private async exportConfig(): Promise<void> {\r\n    try {\r\n      const data = await chrome.storage.sync.get(null);\r\n\r\n      const exportData = {\r\n        version: '1.0.0',\r\n        timestamp: new Date().toISOString(),\r\n        extension: 'AI to VSCode Bridge',\r\n        data: data\r\n      };\r\n\r\n      const json = JSON.stringify(exportData, null, 2);\r\n      const blob = new Blob([json], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `ai-vscode-bridge-config-${Date.now()}.json`;\r\n      a.click();\r\n\r\n      URL.revokeObjectURL(url);\r\n\r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂá∫', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂá∫Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂá∫Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    }\r\n  }\r\n\r\n  private async handleImportFile(event: Event): Promise<void> {\r\n    const input = event.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n\r\n    if (!file) return;\r\n\r\n    try {\r\n      const text = await file.text();\r\n      const importData = JSON.parse(text);\r\n\r\n      if (!importData.data || !importData.version) {\r\n        this.showStatus('‚ùå Êó†ÊïàÁöÑÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè', 'error');\r\n        return;\r\n      }\r\n\r\n      if (!confirm('Á°ÆÂÆöË¶ÅÂØºÂÖ•ÈÖçÁΩÆÂêóÔºüÂΩìÂâçÈÖçÁΩÆÂ∞ÜË¢´Ë¶ÜÁõñ„ÄÇ')) {\r\n        return;\r\n      }\r\n\r\n      await chrome.storage.sync.set(importData.data);\r\n      await this.loadSettings();\r\n\r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂÖ•ÔºåËØ∑Âà∑Êñ∞ÁΩëÈ°µ‰ΩøÈÖçÁΩÆÁîüÊïà', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂÖ•Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂÖ•Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    } finally {\r\n      input.value = '';\r\n    }\r\n  }\r\n\r\n  private showStatus(message: string, type: 'success' | 'error'): void {\r\n    if (!this.statusDiv) return;\r\n\r\n    this.statusDiv.textContent = message;\r\n    this.statusDiv.className = type;\r\n    this.statusDiv.style.display = 'block';\r\n\r\n    setTimeout(() => {\r\n      if (this.statusDiv) {\r\n        this.statusDiv.style.display = 'none';\r\n      }\r\n    }, 4000);\r\n  }\r\n\r\n  private escapeHtml(text: string): string {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n\r\n  // ÊèêÁ§∫ËØçÁÆ°ÁêÜÁõ∏ÂÖ≥ÊñπÊ≥ï\r\n  private renderPromptList(): void {\r\n    if (!this.promptList) return;\r\n\r\n    const prompts = this.currentSettings.promptFiles || [];\r\n\r\n    if (prompts.length === 0) {\r\n      this.promptList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÊèêÁ§∫ËØçÈÖçÁΩÆ</div>';\r\n      return;\r\n    }\r\n\r\n    this.promptList.innerHTML = prompts\r\n      .map((prompt, index) => `\r\n      <div class=\"url-item\">\r\n        <div style=\"flex: 1;\">\r\n          <div style=\"font-weight: 500; color: #fff;\">üìù ${this.escapeHtml(prompt.name)}</div>\r\n          <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n            ÂÜÖÂÆπÈïøÂ∫¶: ${prompt.path.length} Â≠óÁ¨¶\r\n          </div>\r\n        </div>\r\n        <div style=\"display: flex; gap: 6px;\">\r\n          <button \r\n            class=\"action-btn rename-btn\" \r\n            data-index=\"${index}\"\r\n            style=\"\r\n              padding: 4px 10px;\r\n              background: #4a4a4a;\r\n              color: white;\r\n              border: none;\r\n              border-radius: 3px;\r\n              cursor: pointer;\r\n              font-size: 12px;\r\n            \"\r\n          >\r\n            ‚úèÔ∏è ÈáçÂëΩÂêç\r\n          </button>\r\n          <button \r\n            class=\"danger\" \r\n            data-index=\"${index}\"\r\n          >\r\n            Âà†Èô§\r\n          </button>\r\n        </div>\r\n      </div>\r\n    `)\r\n      .join('');\r\n\r\n    // ÁªëÂÆöÂà†Èô§ÊåâÈíÆ‰∫ã‰ª∂\r\n    this.promptList.querySelectorAll('.danger').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removePrompt(index);\r\n      });\r\n    });\r\n\r\n    // ÁªëÂÆöÈáçÂëΩÂêçÊåâÈíÆ‰∫ã‰ª∂\r\n    this.promptList.querySelectorAll('.rename-btn').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.renamePrompt(index);\r\n      });\r\n    });\r\n  }\r\n\r\n\r\n  private currentFileName: string = '';\r\n\r\n  private async handleFileSelect(event: Event): Promise<void> {\r\n    const input = event.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n\r\n    if (!file) return;\r\n\r\n    try {\r\n      this.currentFileContent = await file.text();\r\n\r\n      // ÊèêÂèñÊñá‰ª∂ÂêçÔºàÂéªÊéâÊâ©Â±ïÂêçÔºâ\r\n      this.currentFileName = file.name.replace(/\\.(md|markdown|txt)$/i, '');\r\n\r\n      // Êõ¥Êñ∞ÊòæÁ§∫\r\n      if (this.fileNameDisplay) {\r\n        this.fileNameDisplay.textContent = file.name;\r\n        this.fileNameDisplay.style.color = '#fff';\r\n      }\r\n\r\n      this.showStatus(\r\n        `‚úÖ Â∑≤Âä†ËΩΩ: ${file.name} (${this.currentFileContent.length} Â≠óÁ¨¶)`,\r\n        'success'\r\n      );\r\n    } catch (error) {\r\n      console.error('ËØªÂèñÊñá‰ª∂Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ËØªÂèñÊñá‰ª∂Â§±Ë¥•', 'error');\r\n    }\r\n  }\r\n\r\n\r\n  private addPrompt(): void {\r\n    // È™åËØÅÔºöÊ£ÄÊü•ÊòØÂê¶ÈÄâÊã©‰∫ÜÊñá‰ª∂\r\n    if (!this.currentFileContent || this.currentFileContent.trim().length === 0) {\r\n      this.showStatus('‚ùå ËØ∑ÂÖàÈÄâÊã©Êñá‰ª∂', 'error');\r\n      const fileWrapper = document.getElementById('file-selector-wrapper');\r\n      if (fileWrapper) {\r\n        fileWrapper.style.borderColor = '#ff4444';\r\n        setTimeout(() => {\r\n          if (fileWrapper) fileWrapper.style.borderColor = '#3e3e3e';\r\n        }, 2000);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (!this.currentSettings.promptFiles) {\r\n      this.currentSettings.promptFiles = [];\r\n    }\r\n\r\n    // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®ÂêåÂêçÊèêÁ§∫ËØç\r\n    const exists = this.currentSettings.promptFiles.some(\r\n      p => p.name === this.currentFileName\r\n    );\r\n\r\n    if (exists) {\r\n      this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${this.currentFileName}\" Â∑≤Â≠òÂú®`, 'error');\r\n      return;\r\n    }\r\n\r\n    const newPrompt = {\r\n      id: Date.now().toString(),\r\n      name: this.currentFileName, // ‰ΩøÁî®Êñá‰ª∂Âêç\r\n      path: this.currentFileContent,\r\n      enabled: true\r\n    };\r\n\r\n    this.currentSettings.promptFiles.push(newPrompt);\r\n    this.renderPromptList();\r\n\r\n    // Ê∏ÖÁ©∫\r\n    if (this.fileNameDisplay) {\r\n      this.fileNameDisplay.textContent = 'Êú™ÈÄâÊã©Êñá‰ª∂';\r\n      this.fileNameDisplay.style.color = '#888';\r\n    }\r\n    this.currentFileContent = '';\r\n    this.currentFileName = '';\r\n\r\n    // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•Ê°Ü\r\n    if (this.promptFileInput) {\r\n      this.promptFileInput.value = '';\r\n    }\r\n\r\n    this.saveDraft();\r\n\r\n    this.showStatus(`‚úÖ Â∑≤Ê∑ªÂä†ÊèêÁ§∫ËØçÔºö${newPrompt.name}`, 'success');\r\n  }\r\n  private renamePrompt(index: number): void {\r\n    if (!this.currentSettings.promptFiles) return;\r\n\r\n    const prompt = this.currentSettings.promptFiles[index];\r\n    if (!prompt) return;\r\n\r\n    // ÊâæÂà∞ÂØπÂ∫îÁöÑ DOM ÂÖÉÁ¥†\r\n    const items = this.promptList?.querySelectorAll('.url-item');\r\n    if (!items || !items[index]) return;\r\n\r\n    const item = items[index];\r\n    const nameElement = item.querySelector('div > div:first-child') as HTMLElement;\r\n    if (!nameElement) return;\r\n\r\n    // ‰øùÂ≠òÂéüÂßãÂêçÁß∞\r\n    const originalName = prompt.name;\r\n    const originalHTML = nameElement.innerHTML;\r\n\r\n    // ÂàõÂª∫ËæìÂÖ•Ê°Ü\r\n    const input = document.createElement('input');\r\n    input.type = 'text';\r\n    input.value = originalName;\r\n    input.style.cssText = `\r\n    width: 100%;\r\n    padding: 4px 8px;\r\n    background: #2d2d2d;\r\n    border: 1px solid #007bff;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    font-size: 14px;\r\n    font-weight: 500;\r\n  `;\r\n\r\n    // ÊõøÊç¢‰∏∫ËæìÂÖ•Ê°Ü\r\n    nameElement.innerHTML = '';\r\n    nameElement.appendChild(input);\r\n    input.focus();\r\n    input.select();\r\n\r\n    // ‰øùÂ≠òÂáΩÊï∞\r\n    const save = () => {\r\n      const newName = input.value.trim();\r\n\r\n      if (!newName) {\r\n        nameElement.innerHTML = originalHTML;\r\n        this.showStatus('‚ùå ÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫', 'error');\r\n        return;\r\n      }\r\n\r\n      // Ê£ÄÊü•ÈáçÂêç\r\n      const exists = this.currentSettings.promptFiles!.some(\r\n        (p, i) => i !== index && p.name === newName\r\n      );\r\n\r\n      if (exists) {\r\n        nameElement.innerHTML = originalHTML;\r\n        this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${newName}\" Â∑≤Â≠òÂú®`, 'error');\r\n        return;\r\n      }\r\n\r\n      // Êõ¥Êñ∞ÂêçÁß∞\r\n      prompt.name = newName;\r\n      nameElement.innerHTML = `üìù ${this.escapeHtml(newName)}`;\r\n\r\n      this.saveDraft();\r\n      this.showStatus(`‚úÖ Â∑≤ÈáçÂëΩÂêç‰∏∫Ôºö${newName}`, 'success');\r\n    };\r\n\r\n    // ÂèñÊ∂àÂáΩÊï∞\r\n    const cancel = () => {\r\n      nameElement.innerHTML = originalHTML;\r\n    };\r\n\r\n    // ÂõûËΩ¶‰øùÂ≠ò\r\n    input.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Enter') {\r\n        e.preventDefault();\r\n        save();\r\n      } else if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        cancel();\r\n      }\r\n    });\r\n\r\n    // Â§±ÁÑ¶‰øùÂ≠ò\r\n    input.addEventListener('blur', save);\r\n  }\r\n\r\n\r\n\r\n\r\n  private removePrompt(index: number): void {\r\n    if (!this.currentSettings.promptFiles) return;\r\n\r\n    this.currentSettings.promptFiles.splice(index, 1);\r\n    this.renderPromptList();\r\n    this.saveDraft();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private async loadPathMemoryData(): Promise<void> {\r\n    const activeProject = await chrome.storage.local.get(['activeProject']);\r\n    this.activeProjectRoot = activeProject.activeProject?.rootPath || 'default';\r\n\r\n    // Êõ¥Êñ∞ UI ÊòæÁ§∫ÂΩìÂâçÈ°πÁõÆ\r\n    const projectDisplay = document.getElementById('active-project-display');\r\n    const projectText = document.getElementById('project-path-text');\r\n    if (projectDisplay && projectText && activeProject.activeProject) {\r\n      projectDisplay.style.display = 'block';\r\n      projectText.textContent = activeProject.activeProject.projectName || activeProject.activeProject.rootPath;\r\n      projectText.title = activeProject.activeProject.rootPath;\r\n    }\r\n\r\n    const storageKey = `pathMemory_${this.activeProjectRoot}`;\r\n    const result = await chrome.storage.local.get([storageKey]);\r\n    this.pathMemory = result[storageKey] || {};\r\n    this.renderMemoryList();\r\n  }\r\n\r\n  private renderMemoryList(): void {\r\n    if (!this.memoryList) return;\r\n\r\n    const entries = Object.entries(this.pathMemory);\r\n    if (entries.length === 0) {\r\n      this.memoryList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†Ë∑ØÂæÑËÆ∞ÂøÜ</div>';\r\n      return;\r\n    }\r\n\r\n    this.memoryList.innerHTML = entries\r\n      .map(([filename, path]) => `\r\n      <div class=\"memory-item\">\r\n        <div class=\"memory-info\">\r\n          <span class=\"memory-filename\">${this.escapeHtml(filename)}</span>\r\n        </div>\r\n        <div class=\"memory-path\">${this.escapeHtml(path)}</div>\r\n        <div class=\"memory-actions\">\r\n          <button class=\"btn-edit\" data-filename=\"${this.escapeHtml(filename)}\" data-path=\"${this.escapeHtml(path)}\">ÁºñËæë</button>\r\n          <button class=\"btn-delete\" data-filename=\"${this.escapeHtml(filename)}\">Âà†Èô§</button>\r\n        </div>\r\n      </div>\r\n    `)\r\n      .join('');\r\n\r\n    // ÁªëÂÆöÂà†Èô§ÊåâÈíÆ\r\n    this.memoryList.querySelectorAll('.btn-delete').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const filename = (e.target as HTMLElement).getAttribute('data-filename');\r\n        if (filename) this.removeMemory(filename);\r\n      });\r\n    });\r\n\r\n    // ÁªëÂÆöÁºñËæëÊåâÈíÆ\r\n    this.memoryList.querySelectorAll('.btn-edit').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const filename = (e.target as HTMLElement).getAttribute('data-filename');\r\n        const path = (e.target as HTMLElement).getAttribute('data-path');\r\n        if (filename && path) {\r\n          if (this.memFilenameInput) this.memFilenameInput.value = filename;\r\n          if (this.memPathInput) this.memPathInput.value = path;\r\n          this.memPathInput?.focus();\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private async addMemory(): Promise<void> {\r\n    const filename = this.memFilenameInput?.value.trim();\r\n    const path = this.memPathInput?.value.trim();\r\n\r\n    if (!filename || !path) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•Êñá‰ª∂ÂêçÂíåË∑ØÂæÑ', 'error');\r\n      return;\r\n    }\r\n\r\n    this.pathMemory[filename] = path;\r\n    const storageKey = `pathMemory_${this.activeProjectRoot}`;\r\n    await chrome.storage.local.set({ [storageKey]: this.pathMemory });\r\n\r\n    if (this.memFilenameInput) this.memFilenameInput.value = '';\r\n    if (this.memPathInput) this.memPathInput.value = '';\r\n\r\n    this.renderMemoryList();\r\n    this.showStatus('‚úÖ ËÆ∞ÂøÜÂ∑≤Ê∑ªÂä†', 'success');\r\n  }\r\n\r\n  private async removeMemory(filename: string): Promise<void> {\r\n    if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ ${filename} ÁöÑË∑ØÂæÑËÆ∞ÂøÜÂêóÔºü`)) {\r\n      delete this.pathMemory[filename];\r\n      const storageKey = `pathMemory_${this.activeProjectRoot}`;\r\n      await chrome.storage.local.set({ [storageKey]: this.pathMemory });\r\n      this.renderMemoryList();\r\n      this.showStatus('‚úÖ ËÆ∞ÂøÜÂ∑≤Âà†Èô§', 'success');\r\n    }\r\n  }\r\n\r\n  private async clearAllMemory(): Promise<void> {\r\n    if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÂΩìÂâçÈ°πÁõÆÁöÑË∑ØÂæÑËÆ∞ÂøÜÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ')) {\r\n      this.pathMemory = {};\r\n      const storageKey = `pathMemory_${this.activeProjectRoot}`;\r\n      await chrome.storage.local.set({ [storageKey]: {} });\r\n      this.renderMemoryList();\r\n      this.showStatus('‚úÖ ËÆ∞ÂøÜÂ∑≤Ê∏ÖÁ©∫', 'success');\r\n    }\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  new PopupManager();\r\n});\r\n"],"names":["DEFAULT_URLS","PopupManager","constructor","autoSaveTimer","hasDraft","portInput","showOnAllSitesCheckbox","urlList","newUrlInput","saveButton","resetButton","addUrlButton","exportButton","importButton","importFileInput","smartFindButton","statusDiv","configList","configHostnameInput","configSelectorInput","configContainerInput","addConfigButton","promptPathInput","selectFileButton","promptFileInput","addPromptButton","promptList","fileNameDisplay","currentFileContent","savePathInput","memoryList","memFilenameInput","memPathInput","addMemButton","clearMemButton","pathMemory","activeProjectRoot","currentSettings","port","enabledUrls","showOnAllSites","siteConfigs","promptFiles","selectedCandidate","currentFileName","this","initElements","loadSettings","setupEventListeners","setupAutoSave","loadPathMemoryData","document","getElementById","result","chrome","storage","sync","get","settings","local","draft","draftSettings","draftData","fiveMinutes","timestamp","Date","now","showDraftIndicator","remove","value","savePath","toString","checked","renderUrlList","renderConfigList","renderPromptList","textContent","style","background","hideDraftIndicator","addEventListener","scheduleAutoSave","clearTimeout","window","setTimeout","saveDraft","parseInt","set","length","innerHTML","map","url","index","escapeHtml","join","querySelectorAll","forEach","btn","e","target","getAttribute","removeUrl","config","hostname","copyButtonSelector","responseContainerSelector","removeConfig","saveSettings","resetToDefaults","addUrl","addConfig","exportConfig","click","smartFindCopyButtons","handleImportFile","key","ctrlKey","handleFileSelect","addPrompt","addMemory","clearAllMemory","activeTab","tabs","query","active","currentWindow","id","showStatus","URL","console","error","showScanningModal","results","scripting","executeScript","tabId","func","candidates","button","text","toLowerCase","trim","ariaLabel","title","className","score","includes","querySelector","selector","ariaLabelAttr","replace","classes","split","slice","push","label","sort","a","b","showEmptyResultModal","showCandidatesModal","errorMsg","Error","message","closeModal","modal","display","c","i","confirmSelection","el","currentTarget","selectCandidate","classList","selected","add","confirmBtn","disabled","test","splice","container","some","newConfig","undefined","saveBtn","settingsForSync","settingsJson","JSON","stringify","sizeInBytes","Blob","size","log","toFixed","warn","analysis","totalPromptSize","p","promptSize","path","Promise","resolve","reject","err","runtime","lastError","errorMessage","String","confirm","data","exportData","version","toISOString","extension","json","blob","type","createObjectURL","createElement","href","download","revokeObjectURL","event","input","file","files","importData","parse","div","prompts","prompt","name","removePrompt","renamePrompt","color","fileWrapper","borderColor","newPrompt","enabled","items","nameElement","originalName","originalHTML","cssText","appendChild","focus","select","save","newName","preventDefault","activeProject","rootPath","projectDisplay","projectText","projectName","storageKey","renderMemoryList","entries","Object","filename","removeMemory"],"sourceRoot":""}