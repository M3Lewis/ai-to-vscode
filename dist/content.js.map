{"version":3,"file":"content.js","mappings":"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","sources":["webpack://ai-to-vscode-bridge/./src/utils/dom.ts","webpack://ai-to-vscode-bridge/./src/utils/som.ts","webpack://ai-to-vscode-bridge/./src/content.ts"],"sourcesContent":["import { SiteConfig } from '../types';\r\n\r\nexport class DOMHelper {\r\n  private static readonly DEFAULT_SELECTORS: SiteConfig[] = [\r\n    {\r\n      hostname: 'chat.openai.com',\r\n      copyButtonSelector: 'button[aria-label*=\"Copy\"]',\r\n      responseContainerSelector: '[data-message-author-role=\"assistant\"]',\r\n      name: 'ChatGPT'\r\n    },\r\n    {\r\n      hostname: 'claude.ai',\r\n      copyButtonSelector: 'button[data-testid=\"action-bar-copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Claude'\r\n    },\r\n    {\r\n      hostname: 'gemini.google.com',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: '.model-response',\r\n      name: 'Gemini'\r\n    },\r\n    {\r\n      hostname: 'perplexity.ai',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Perplexity'\r\n    },\r\n    {\r\n      hostname: 'aistudio.google.com',\r\n      copyButtonSelector: 'button[mat-menu-item][jslog^=\"282205\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'AI Studio'\r\n    }\r\n  ];\r\n\r\n  public static findLatestCopyButton(): HTMLElement | null {\r\n    const perfStart = performance.now();\r\n    console.group('ğŸ” [æ€§èƒ½ç›‘æ§] æŸ¥æ‰¾COPYæŒ‰é’®');\r\n\r\n    const currentHostname = window.location.hostname;\r\n    console.log('ğŸ“ å½“å‰åŸŸå:', currentHostname);\r\n    console.log('â±ï¸ å¼€å§‹æ—¶é—´:', new Date().toLocaleTimeString());\r\n\r\n    let result: HTMLElement | null = null;\r\n\r\n    try {\r\n      if (currentHostname.includes('perplexity.ai')) {\r\n        console.log('ğŸ¯ ä½¿ç”¨ Perplexity ä¸“ç”¨æŸ¥æ‰¾');\r\n        result = this.findPerplexityCopyButton();\r\n      } else {\r\n        const defaultConfig = this.DEFAULT_SELECTORS.find(c =>\r\n          currentHostname.includes(c.hostname)\r\n        );\r\n\r\n        if (defaultConfig) {\r\n          console.log('âœ… æ‰¾åˆ°é»˜è®¤é…ç½®:', defaultConfig.name);\r\n          result = this.findButtonWithConfig(defaultConfig);\r\n        } else {\r\n          console.log('âš ï¸ ä½¿ç”¨é€šç”¨ç­–ç•¥æŸ¥æ‰¾');\r\n          result = this.findButtonGeneric();\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('âŒ æŸ¥æ‰¾æŒ‰é’®æ—¶å‘ç”Ÿé”™è¯¯:', error);\r\n    }\r\n\r\n    const perfEnd = performance.now();\r\n    const timeTaken = (perfEnd - perfStart).toFixed(2);\r\n\r\n    console.log('â±ï¸ æŸ¥æ‰¾è€—æ—¶:', timeTaken, 'ms');\r\n    console.log('ğŸ“Š ç»“æœ:', result ? 'âœ… æ‰¾åˆ°æŒ‰é’®' : 'âŒ æœªæ‰¾åˆ°æŒ‰é’®');\r\n    console.log('ğŸ’¾ å½“å‰å†…å­˜ä½¿ç”¨:', this.getMemoryUsage());\r\n    console.groupEnd();\r\n\r\n    return result;\r\n  }\r\n\r\n  public static async loadConfigs(): Promise<void> {\r\n    // ç©ºå®ç°ï¼Œä¿ç•™æ¥å£å…¼å®¹æ€§\r\n  }\r\n\r\n  private static findPerplexityCopyButton(): HTMLElement | null {\r\n    const startTime = performance.now();\r\n    console.group('ğŸ” [Perplexity] ä¸“ç”¨æŸ¥æ‰¾');\r\n\r\n    try {\r\n      // æ­¥éª¤1ï¼šæŸ¥æ‰¾å›å¤å®¹å™¨\r\n      console.time('æŸ¥æ‰¾å›å¤å®¹å™¨');\r\n      const replyContainers = document.querySelectorAll(\r\n        'div.py-md.md\\\\:pb-headerHeight.mx-auto.max-w-threadContentWidth > div'\r\n      );\r\n      console.timeEnd('æŸ¥æ‰¾å›å¤å®¹å™¨');\r\n\r\n      console.log('ğŸ“¦ å›å¤å®¹å™¨æ•°é‡:', replyContainers.length);\r\n\r\n      if (replyContainers.length === 0) {\r\n        console.warn('âŒ æœªæ‰¾åˆ°å›å¤å®¹å™¨');\r\n        console.groupEnd();\r\n        return null;\r\n      }\r\n\r\n      // æ­¥éª¤2ï¼šè·å–æœ€åä¸€ä¸ªå®¹å™¨\r\n      const lastReply = replyContainers[replyContainers.length - 1];\r\n      console.log('ğŸ“ ä½¿ç”¨æœ€åä¸€ä¸ªå®¹å™¨ (ç´¢å¼•:', replyContainers.length - 1, ')');\r\n\r\n      // æ­¥éª¤3ï¼šæŸ¥æ‰¾å¤åˆ¶æŒ‰é’®\r\n      console.time('æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®');\r\n      const copyBtns = lastReply.querySelectorAll<HTMLElement>(\r\n        'button[aria-label*=\"Copy\"], button[data-testid*=\"copy\"]'\r\n      );\r\n      console.timeEnd('æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®');\r\n\r\n      console.log('ğŸ”˜ å¤åˆ¶æŒ‰é’®æ•°é‡:', copyBtns.length);\r\n\r\n      if (copyBtns.length > 0) {\r\n        const selectedBtn = copyBtns[copyBtns.length - 1];\r\n        console.log('âœ… é€‰ä¸­æŒ‰é’®:', {\r\n          ariaLabel: selectedBtn.getAttribute('aria-label'),\r\n          dataTestId: selectedBtn.getAttribute('data-testid'),\r\n          text: selectedBtn.textContent?.trim().substring(0, 20)\r\n        });\r\n        console.log('â±ï¸ PerplexityæŸ¥æ‰¾è€—æ—¶:', (performance.now() - startTime).toFixed(2), 'ms');\r\n        console.groupEnd();\r\n        return selectedBtn;\r\n      }\r\n\r\n      // æ­¥éª¤4ï¼šé€’å½’æœç´¢\r\n      console.warn('âš ï¸ æœªæ‰¾åˆ°æ ‡å‡†å¤åˆ¶æŒ‰é’®ï¼Œå°è¯•é€’å½’æœç´¢');\r\n      console.time('é€’å½’æœç´¢æŒ‰é’®');\r\n      const allButtons = Array.from(lastReply.querySelectorAll<HTMLElement>('button'));\r\n      console.log('ğŸ” å®¹å™¨å†…æŒ‰é’®æ€»æ•°:', allButtons.length);\r\n\r\n      for (let i = 0; i < allButtons.length; i++) {\r\n        const button = allButtons[i];\r\n        const ariaLabel = button.getAttribute('aria-label')?.toLowerCase() || '';\r\n        const dataTestId = button.getAttribute('data-testid')?.toLowerCase() || '';\r\n        const text = button.textContent?.toLowerCase() || '';\r\n\r\n        if (ariaLabel.includes('copy') || dataTestId.includes('copy') || text.includes('copy')) {\r\n          console.log('âœ… é€’å½’æ‰¾åˆ°æŒ‰é’® (ç´¢å¼•:', i, ')');\r\n          console.timeEnd('é€’å½’æœç´¢æŒ‰é’®');\r\n          console.groupEnd();\r\n          return button;\r\n        }\r\n      }\r\n      console.timeEnd('é€’å½’æœç´¢æŒ‰é’®');\r\n\r\n    } catch (error) {\r\n      console.error('âŒ PerplexityæŸ¥æ‰¾å‡ºé”™:', error);\r\n    }\r\n\r\n    console.warn('âŒ PerplexityæŸ¥æ‰¾å¤±è´¥');\r\n    console.groupEnd();\r\n    return null;\r\n  }\r\n\r\n  private static findButtonWithConfig(config: SiteConfig): HTMLElement | null {\r\n    const startTime = performance.now();\r\n    console.group('ğŸ” [é…ç½®æŸ¥æ‰¾]', config.name);\r\n\r\n    const selector = config.copyButtonSelector;\r\n    console.log('ğŸ¯ é€‰æ‹©å™¨:', selector);\r\n\r\n    try {\r\n      // ç‰¹æ®Šå¤„ç†\r\n      if (window.location.hostname.includes('aistudio.google.com')) {\r\n        const result = this.findAIStudioCopyButton();\r\n        console.log('â±ï¸ AI StudioæŸ¥æ‰¾è€—æ—¶:', (performance.now() - startTime).toFixed(2), 'ms');\r\n        console.groupEnd();\r\n        return result;\r\n      }\r\n\r\n      if (window.location.hostname.includes('claude.ai')) {\r\n        const result = this.findClaudeCopyButton();\r\n        console.log('â±ï¸ ClaudeæŸ¥æ‰¾è€—æ—¶:', (performance.now() - startTime).toFixed(2), 'ms');\r\n        console.groupEnd();\r\n        return result;\r\n      }\r\n\r\n      // å®¹å™¨æŸ¥æ‰¾\r\n      if (config.responseContainerSelector) {\r\n        console.log('ğŸ“¦ ä½¿ç”¨å®¹å™¨é€‰æ‹©å™¨:', config.responseContainerSelector);\r\n        console.time('æŸ¥æ‰¾å®¹å™¨');\r\n        const responses = document.querySelectorAll(config.responseContainerSelector);\r\n        console.timeEnd('æŸ¥æ‰¾å®¹å™¨');\r\n        console.log('ğŸ“¦ å®¹å™¨æ•°é‡:', responses.length);\r\n\r\n        if (responses.length > 0) {\r\n          const lastResponse = responses[responses.length - 1];\r\n          console.time('å®¹å™¨å†…æŸ¥æ‰¾æŒ‰é’®');\r\n          const button = lastResponse.querySelector<HTMLElement>(selector);\r\n          console.timeEnd('å®¹å™¨å†…æŸ¥æ‰¾æŒ‰é’®');\r\n\r\n          if (button) {\r\n            console.log('âœ… åœ¨å®¹å™¨ä¸­æ‰¾åˆ°æŒ‰é’®');\r\n            console.groupEnd();\r\n            return button;\r\n          }\r\n        }\r\n      }\r\n\r\n      // å…¨å±€æŸ¥æ‰¾\r\n      console.warn('âš ï¸ å›é€€åˆ°å…¨å±€æŸ¥æ‰¾');\r\n      console.time('å…¨å±€æŸ¥æ‰¾æŒ‰é’®');\r\n      const buttons = document.querySelectorAll<HTMLElement>(selector);\r\n      console.timeEnd('å…¨å±€æŸ¥æ‰¾æŒ‰é’®');\r\n      console.log('ğŸ”˜ å…¨å±€æ‰¾åˆ°æŒ‰é’®æ•°:', buttons.length);\r\n\r\n      if (buttons.length > 0) {\r\n        console.log('âœ… è¿”å›æœ€åä¸€ä¸ªæŒ‰é’®');\r\n        console.groupEnd();\r\n        return buttons[buttons.length - 1];\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('âŒ é…ç½®æŸ¥æ‰¾å‡ºé”™:', error);\r\n    }\r\n\r\n    console.warn('âŒ æœªæ‰¾åˆ°æŒ‰é’®');\r\n    console.log('â±ï¸ æ€»è€—æ—¶:', (performance.now() - startTime).toFixed(2), 'ms');\r\n    console.groupEnd();\r\n    return null;\r\n  }\r\n\r\n  private static findClaudeCopyButton(): HTMLElement | null {\r\n    console.group('ğŸ” [Claude] ä¸“ç”¨æŸ¥æ‰¾');\r\n\r\n    try {\r\n      console.time('æŸ¥æ‰¾ClaudeæŒ‰é’®');\r\n      const buttons = Array.from(document.querySelectorAll<HTMLElement>('button[data-testid=\"action-bar-copy\"]'));\r\n      console.timeEnd('æŸ¥æ‰¾ClaudeæŒ‰é’®');\r\n      console.log('ğŸ”˜ æ‰¾åˆ°æŒ‰é’®æ•°:', buttons.length);\r\n\r\n      if (buttons.length > 0) {\r\n        console.groupEnd();\r\n        return buttons[buttons.length - 1];\r\n      }\r\n\r\n      console.warn('âš ï¸ ä½¿ç”¨SVGå¤‡ç”¨æŸ¥æ‰¾');\r\n      console.time('SVGè·¯å¾„æŸ¥æ‰¾');\r\n      const allButtons = Array.from(document.querySelectorAll<HTMLElement>('button'));\r\n      console.log('ğŸ” é¡µé¢æŒ‰é’®æ€»æ•°:', allButtons.length);\r\n\r\n      if (allButtons.length > 1000) {\r\n        console.error('âŒ æŒ‰é’®æ•°é‡å¼‚å¸¸ (>1000)ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼');\r\n      }\r\n\r\n      for (let i = allButtons.length - 1; i >= 0; i--) {\r\n        const btn = allButtons[i];\r\n        const svg = btn.querySelector('svg');\r\n        if (svg) {\r\n          const path = svg.querySelector('path');\r\n          if (path) {\r\n            const d = path.getAttribute('d') || '';\r\n            if (d.includes('M10 1.5C11.1097') || d.includes('clipboard')) {\r\n              console.log('âœ… é€šè¿‡SVGæ‰¾åˆ° (ç´¢å¼•:', i, ')');\r\n              console.timeEnd('SVGè·¯å¾„æŸ¥æ‰¾');\r\n              console.groupEnd();\r\n              return btn;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      console.timeEnd('SVGè·¯å¾„æŸ¥æ‰¾');\r\n\r\n    } catch (error) {\r\n      console.error('âŒ ClaudeæŸ¥æ‰¾å‡ºé”™:', error);\r\n    }\r\n\r\n    console.groupEnd();\r\n    return null;\r\n  }\r\n\r\n  private static findAIStudioCopyButton(): HTMLElement | null {\r\n    console.group('ğŸ” [AI Studio] ä¸“ç”¨æŸ¥æ‰¾');\r\n\r\n    try {\r\n      const strategies = [\r\n        { name: 'jslogå±æ€§', fn: () => document.querySelector<HTMLElement>('button[mat-menu-item][jslog^=\"282205\"]') },\r\n        {\r\n          name: 'copy-markdown-buttonç±»', fn: () => {\r\n            const icon = document.querySelector<HTMLElement>('.copy-markdown-button');\r\n            return icon?.closest('button[mat-menu-item]') as HTMLElement;\r\n          }\r\n        },\r\n        {\r\n          name: 'Copy as markdownæ–‡æœ¬', fn: () => {\r\n            const items = Array.from(document.querySelectorAll<HTMLElement>('button[mat-menu-item]'));\r\n            return items.find(item => item.textContent?.toLowerCase().includes('copy as markdown')) || null;\r\n          }\r\n        }\r\n      ];\r\n\r\n      for (const strategy of strategies) {\r\n        console.time(strategy.name);\r\n        const result = strategy.fn();\r\n        console.timeEnd(strategy.name);\r\n\r\n        if (result) {\r\n          console.log('âœ… ç­–ç•¥æˆåŠŸ:', strategy.name);\r\n          console.groupEnd();\r\n          return result;\r\n        }\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('âŒ AI StudioæŸ¥æ‰¾å‡ºé”™:', error);\r\n    }\r\n\r\n    console.groupEnd();\r\n    return null;\r\n  }\r\n\r\n  private static findButtonGeneric(): HTMLElement | null {\r\n    console.group('ğŸ” [é€šç”¨ç­–ç•¥] æŸ¥æ‰¾');\r\n\r\n    const selectors = [\r\n      'button[data-testid*=\"copy\"]',\r\n      'button[aria-label*=\"Copy\" i]',\r\n      'button[aria-label*=\"å¤åˆ¶\" i]',\r\n      'button[title*=\"Copy\" i]',\r\n      'button.copy-button',\r\n      'button.copy-btn',\r\n      '[data-testid*=\"copy\"]'\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      try {\r\n        console.time(`é€‰æ‹©å™¨: ${selector}`);\r\n        const buttons = document.querySelectorAll<HTMLElement>(selector);\r\n        console.timeEnd(`é€‰æ‹©å™¨: ${selector}`);\r\n        console.log(`  ğŸ“Š æ‰¾åˆ° ${buttons.length} ä¸ªæŒ‰é’®`);\r\n\r\n        if (buttons.length > 100) {\r\n          console.warn(`  âš ï¸ æŒ‰é’®æ•°é‡è¿‡å¤š (${buttons.length})ï¼Œå¯èƒ½å½±å“æ€§èƒ½ï¼`);\r\n        }\r\n\r\n        if (buttons.length > 0) {\r\n          console.log('  âœ… è¿”å›æœ€åä¸€ä¸ªæŒ‰é’®');\r\n          console.groupEnd();\r\n          return buttons[buttons.length - 1];\r\n        }\r\n      } catch (e) {\r\n        console.error(`  âŒ é€‰æ‹©å™¨é”™è¯¯:`, e);\r\n        continue;\r\n      }\r\n    }\r\n\r\n    console.error('âŒ æ‰€æœ‰é€šç”¨ç­–ç•¥éƒ½å¤±è´¥äº†');\r\n    console.groupEnd();\r\n    return null;\r\n  }\r\n\r\n  public static async getClipboardContent(): Promise<string> {\r\n    const startTime = performance.now();\r\n    console.group('ğŸ“‹ [å‰ªè´´æ¿] è¯»å–å†…å®¹');\r\n\r\n    try {\r\n      const content = await navigator.clipboard.readText();\r\n      const timeTaken = (performance.now() - startTime).toFixed(2);\r\n\r\n      console.log('âœ… è¯»å–æˆåŠŸ');\r\n      console.log('ğŸ“ å†…å®¹é•¿åº¦:', content.length, 'å­—ç¬¦');\r\n      console.log('â±ï¸ è¯»å–è€—æ—¶:', timeTaken, 'ms');\r\n\r\n      if (content.length > 50000) {\r\n        console.warn('âš ï¸ å†…å®¹è¿‡å¤§ (>50KB)ï¼Œå¯èƒ½å½±å“æ€§èƒ½ï¼');\r\n      }\r\n\r\n      console.groupEnd();\r\n      return content;\r\n    } catch (error) {\r\n      console.error('âŒ è¯»å–å¤±è´¥:', error);\r\n      console.groupEnd();\r\n      throw new Error('æ— æ³•è¯»å–å‰ªè´´æ¿');\r\n    }\r\n  }\r\n\r\n  private static getMemoryUsage(): string {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      const used = (memory.usedJSHeapSize / 1048576).toFixed(2);\r\n      const total = (memory.totalJSHeapSize / 1048576).toFixed(2);\r\n      return `${used} MB / ${total} MB`;\r\n    }\r\n    return 'ä¸å¯ç”¨';\r\n  }\r\n\r\n  public static makeDraggable(element: HTMLElement): void {\r\n    let isDragging = false;\r\n    let initialX: number;\r\n    let initialY: number;\r\n\r\n    // ä¿®æ­£ï¼šä½¿ç”¨ content.ts ä¸­å®šä¹‰çš„ç±»å .ai-vscode-header\r\n    const header = element.querySelector<HTMLElement>('.ai-vscode-header');\r\n    if (!header) return;\r\n\r\n    header.style.cursor = 'move';\r\n\r\n    header.addEventListener('mousedown', (e: MouseEvent) => {\r\n      // å¦‚æœç‚¹å‡»çš„æ˜¯æŒ‰é’®ï¼Œä¸è§¦å‘æ‹–æ‹½\r\n      if ((e.target as HTMLElement).closest('button')) {\r\n        return;\r\n      }\r\n\r\n      isDragging = true;\r\n      initialX = e.clientX - element.offsetLeft;\r\n      initialY = e.clientY - element.offsetTop;\r\n\r\n      // å¢åŠ æ‹–æ‹½æ—¶çš„æ ·å¼\r\n      element.style.transition = 'none';\r\n      element.classList.add('dragging');\r\n    });\r\n\r\n    document.addEventListener('mousemove', (e: MouseEvent) => {\r\n      if (!isDragging) return;\r\n\r\n      e.preventDefault();\r\n\r\n      let newX = e.clientX - initialX;\r\n      let newY = e.clientY - initialY;\r\n\r\n      // è¾¹ç•Œæ£€æŸ¥ï¼šé˜²æ­¢æ‹–å‡ºå±å¹•\r\n      const padding = 10;\r\n      const maxX = window.innerWidth - element.offsetWidth - padding;\r\n      const maxY = window.innerHeight - element.offsetHeight - padding;\r\n\r\n      newX = Math.max(padding, Math.min(newX, maxX));\r\n      newY = Math.max(padding, Math.min(newY, maxY));\r\n\r\n      element.style.left = `${newX}px`;\r\n      element.style.top = `${newY}px`;\r\n      element.style.right = 'auto';\r\n      element.style.bottom = 'auto';\r\n    });\r\n\r\n    document.addEventListener('mouseup', () => {\r\n      if (isDragging) {\r\n        isDragging = false;\r\n        element.classList.remove('dragging');\r\n        // æ¢å¤è¿‡æ¸¡æ•ˆæœï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰\r\n        element.style.transition = '';\r\n      }\r\n    });\r\n  }\r\n}\r\n","/**\r\n * Visual Anchor Manager (Set-of-Mark)\r\n * è´Ÿè´£åœ¨é¡µé¢å…ƒç´ ä¸Šæ³¨å…¥å’Œç§»é™¤è§†è§‰é”šç‚¹ï¼ˆç¼–å·æ ‡ç­¾ï¼‰\r\n */\r\nexport class VisualAnchorManager {\r\n    private static anchorClass = 'ai-visual-anchor';\r\n    private static overlayId = 'ai-visual-anchor-overlay';\r\n\r\n    /**\r\n     * æ³¨å…¥è§†è§‰é”šç‚¹\r\n     * @returns æ³¨å…¥çš„é”šç‚¹æ˜ å°„è¡¨ { id: element }\r\n     */\r\n    public static injectAnchors(): Map<number, HTMLElement> {\r\n        this.removeAnchors(); // æ¸…ç†æ—§é”šç‚¹\r\n\r\n        const interactiveTags = ['BUTTON', 'A', 'INPUT', 'TEXTAREA', 'SELECT', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'IMG', 'svg'];\r\n        const elements = Array.from(document.querySelectorAll('*')).filter(el => {\r\n            // è¿‡æ»¤ä¸å¯è§å…ƒç´ \r\n            const style = window.getComputedStyle(el);\r\n            if (style.display === 'none' || style.visibility === 'hidden' || style.opacity === '0') return false;\r\n\r\n            // è¿‡æ»¤å¤ªå°çš„å…ƒç´ \r\n            const rect = el.getBoundingClientRect();\r\n            if (rect.width < 10 || rect.height < 10) return false;\r\n\r\n            // åŒ…å«å…³é”®äº¤äº’æ ‡ç­¾\r\n            if (interactiveTags.includes(el.tagName)) return true;\r\n\r\n            // åŒ…å«ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ (ç®€å•åˆ¤æ–­ï¼Œä¸ä¸€å®šå‡†ç¡®)\r\n            // if (el.onclick || el.getAttribute('onclick')) return true;\r\n\r\n            return false;\r\n        });\r\n\r\n        // åˆ›å»ºè¦†ç›–å±‚å®¹å™¨\r\n        const overlay = document.createElement('div');\r\n        overlay.id = this.overlayId;\r\n        Object.assign(overlay.style, {\r\n            position: 'absolute',\r\n            top: '0',\r\n            left: '0',\r\n            width: '100%',\r\n            height: '100%',\r\n            pointerEvents: 'none',\r\n            zIndex: '2147483647', // Max z-index\r\n            overflow: 'hidden'\r\n        });\r\n        document.body.appendChild(overlay);\r\n\r\n        const anchorMap = new Map<number, HTMLElement>();\r\n        let counter = 1;\r\n\r\n        elements.forEach(el => {\r\n            const rect = el.getBoundingClientRect();\r\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n            const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\r\n\r\n            // åˆ›å»ºé«˜äº®æ¡†\r\n            const box = document.createElement('div');\r\n            box.className = this.anchorClass;\r\n            Object.assign(box.style, {\r\n                position: 'absolute',\r\n                top: `${rect.top + scrollTop}px`,\r\n                left: `${rect.left + scrollLeft}px`,\r\n                width: `${rect.width}px`,\r\n                height: `${rect.height}px`,\r\n                border: '2px solid #ff0000',\r\n                boxSizing: 'border-box',\r\n                pointerEvents: 'none'\r\n            });\r\n\r\n            // åˆ›å»ºç¼–å·æ ‡ç­¾\r\n            const label = document.createElement('span');\r\n            label.textContent = `${counter}`;\r\n            Object.assign(label.style, {\r\n                position: 'absolute',\r\n                top: '-2px',\r\n                left: '-2px',\r\n                backgroundColor: '#ff0000',\r\n                color: 'white',\r\n                fontSize: '12px',\r\n                fontWeight: 'bold',\r\n                padding: '0 4px',\r\n                lineHeight: '14px',\r\n                zIndex: '1'\r\n            });\r\n\r\n            box.appendChild(label);\r\n            overlay.appendChild(box);\r\n\r\n            // è®°å½•æ˜ å°„\r\n            anchorMap.set(counter, el as HTMLElement);\r\n            // åœ¨å…ƒç´ ä¸Šä¸´æ—¶å­˜å‚¨ IDï¼Œæ–¹ä¾¿åç»­æå–\r\n            el.setAttribute('data-ai-anchor-id', `${counter}`);\r\n\r\n            counter++;\r\n        });\r\n\r\n        return anchorMap;\r\n    }\r\n\r\n    /**\r\n     * ç§»é™¤æ‰€æœ‰è§†è§‰é”šç‚¹\r\n     */\r\n    public static removeAnchors(): void {\r\n        const overlay = document.getElementById(this.overlayId);\r\n        if (overlay) {\r\n            overlay.remove();\r\n        }\r\n\r\n        // æ¸…ç†å…ƒç´ ä¸Šçš„å±æ€§\r\n        document.querySelectorAll('[data-ai-anchor-id]').forEach(el => {\r\n            el.removeAttribute('data-ai-anchor-id');\r\n        });\r\n    }\r\n}\r\n","import { DOMHelper } from './utils/dom';\r\nimport { VisualAnchorManager } from './utils/som';\r\nimport { PageExtractor } from './extractor';\r\nimport { MessageToVSCode, MessageResponse, ConnectionStatus } from './types';\r\n\r\nclass FloatingPanel {\r\n  private panel: HTMLElement | null = null;\r\n  private statusElement: HTMLElement | null = null;\r\n  private enabled: boolean = false;\r\n  private dailyCounter: number = 1;\r\n  private promptButtons: HTMLElement | null = null;\r\n  private isDebugMode: boolean = false;\r\n  private pathMemory: Record<string, string> = {}; // æ–°å¢ï¼šè·¯å¾„è®°å¿†\r\n  private picker: ElementPicker | null = null;\r\n  private lastSelectedElement: HTMLElement | null = null; // æ–°å¢ï¼šè®°å½•ä¸Šæ¬¡é€‰ä¸­çš„å…ƒç´ \r\n\r\n  constructor() {\r\n    this.initialize();\r\n    this.checkDebugMode();\r\n    this.setupStorageListener();\r\n  }\r\n\r\n  // åœ¨ class FloatingPanel å†…éƒ¨æ·»åŠ \r\n  private setUIVisibility(visible: boolean): void {\r\n    if (this.panel) {\r\n      // ä½¿ç”¨ display: none æ˜¯æœ€å½»åº•çš„ï¼Œç¡®ä¿ä¸å ä½ä¸”ä¸è¢«æ¸²æŸ“\r\n      this.panel.style.display = visible ? 'block' : 'none';\r\n    }\r\n\r\n    // éšè—æ‰€æœ‰æ­£åœ¨æ˜¾ç¤ºçš„é€šçŸ¥å…ƒç´ \r\n    const notifications = document.querySelectorAll('.notification');\r\n    notifications.forEach(el => {\r\n      (el as HTMLElement).style.display = visible ? 'block' : 'none';\r\n    });\r\n  }\r\n\r\n  private checkDebugMode(): void {\r\n    // æ£€æµ‹æ˜¯å¦ä¸ºè°ƒè¯•æ¨¡å¼ï¼ˆå¯ä»¥é€šè¿‡URLå‚æ•°æˆ–localStorageæ§åˆ¶ï¼‰\r\n    this.isDebugMode =\r\n      window.location.search.includes('debug=true') ||\r\n      localStorage.getItem('ai-vscode-debug') === 'true' ||\r\n      window.location.hostname === 'localhost';\r\n  }\r\n\r\n  private debugLog(message: string, ...args: any[]): void {\r\n    if (this.isDebugMode) {\r\n      console.log(message, ...args);\r\n    }\r\n  }\r\n\r\n  private debugWarn(message: string, ...args: any[]): void {\r\n    if (this.isDebugMode) {\r\n      console.warn(message, ...args);\r\n    }\r\n  }\r\n\r\n  private async initialize(): Promise<void> {\r\n    await this.checkAndInitialize();\r\n    await this.loadDailyCounter();\r\n    await this.loadPathMemory(); // æ–°å¢ï¼šåŠ è½½è·¯å¾„è®°å¿†\r\n\r\n    // æ–°å¢ï¼šåˆå§‹åŒ–åç«‹å³æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n    this.queryConnectionStatus();\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¸»åŠ¨æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n  private queryConnectionStatus(): void {\r\n    chrome.runtime.sendMessage({ action: 'getConnectionStatus' }, (response) => {\r\n      if (chrome.runtime.lastError) {\r\n        console.error('æŸ¥è¯¢è¿æ¥çŠ¶æ€å¤±è´¥:', chrome.runtime.lastError);\r\n        return;\r\n      }\r\n\r\n      if (response && response.connected !== undefined) {\r\n        console.log('å½“å‰è¿æ¥çŠ¶æ€:', response.connected ? 'å·²è¿æ¥' : 'æœªè¿æ¥');\r\n        this.updateConnectionStatus(response.connected);\r\n      }\r\n    });\r\n  }\r\n\r\n  private async loadDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    const result = await chrome.storage.local.get(['lastSaveDate', 'dailyCounter']);\r\n\r\n    if (result.lastSaveDate === today) {\r\n      this.dailyCounter = (result.dailyCounter || 0) + 1;\r\n    } else {\r\n      this.dailyCounter = 1;\r\n    }\r\n  }\r\n\r\n  private async updateDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    await chrome.storage.local.set({\r\n      lastSaveDate: today,\r\n      dailyCounter: this.dailyCounter\r\n    });\r\n    this.dailyCounter++;\r\n  }\r\n\r\n  // æ–°å¢ï¼šåŠ è½½è·¯å¾„è®°å¿†\r\n  private async loadPathMemory(): Promise<void> {\r\n    const activeProject = await chrome.storage.local.get(['activeProject']);\r\n    const rootPath = activeProject.activeProject?.rootPath || 'default';\r\n    const storageKey = `pathMemory_${rootPath}`;\r\n\r\n    const result = await chrome.storage.local.get([storageKey]);\r\n    this.pathMemory = result[storageKey] || {};\r\n    console.log(`ğŸ“‚ [${rootPath}] è·¯å¾„è®°å¿†å·²åŠ è½½:`, Object.keys(this.pathMemory).length, 'ä¸ªæ–‡ä»¶');\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¿å­˜è·¯å¾„è®°å¿†\r\n  private async savePathMemory(): Promise<void> {\r\n    const activeProject = await chrome.storage.local.get(['activeProject']);\r\n    const rootPath = activeProject.activeProject?.rootPath || 'default';\r\n    const storageKey = `pathMemory_${rootPath}`;\r\n\r\n    await chrome.storage.local.set({ [storageKey]: this.pathMemory });\r\n  }\r\n\r\n  // æ–°å¢ï¼šç›‘å¬å­˜å‚¨å˜åŒ–\r\n  private setupStorageListener(): void {\r\n    chrome.storage.onChanged.addListener((changes, area) => {\r\n      if (area === 'local' && changes.activeProject) {\r\n        console.log('ğŸ”„ æ£€æµ‹åˆ°æ´»è·ƒé¡¹ç›®å˜æ›´ï¼Œé‡æ–°åŠ è½½è·¯å¾„è®°å¿†');\r\n        this.loadPathMemory();\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  private async checkAndInitialize(): Promise<void> {\r\n    // ç»Ÿä¸€ä» settings é”®è¯»å–é…ç½®\r\n    const storageData = await chrome.storage.sync.get('settings');\r\n    const settings = storageData.settings || {};\r\n\r\n    const defaultUrls = [\r\n      'chat.openai.com',\r\n      'claude.ai',\r\n      'gemini.google.com',\r\n      'chatgpt.com',\r\n      'poe.com',\r\n      'perplexity.ai',\r\n      'deepseek.com',\r\n      'aistudio.google.com'\r\n    ];\r\n\r\n    const enabledUrls: string[] = settings.enabledUrls || defaultUrls;\r\n    const showOnAllSites = settings.showOnAllSites || false;\r\n    const currentHostname = window.location.hostname;\r\n\r\n    if (showOnAllSites || this.isUrlEnabled(currentHostname, enabledUrls)) {\r\n      this.enabled = true;\r\n      this.createPanel();\r\n      this.setupMessageListener();\r\n      console.log('âœ… æ‚¬æµ®çª—å·²å¯ç”¨');\r\n    } else {\r\n      console.log('å½“å‰ç½‘ç«™æœªå¯ç”¨æ‚¬æµ®çª—:', currentHostname);\r\n    }\r\n\r\n    chrome.storage.onChanged.addListener((changes) => {\r\n      if (changes.settings) {\r\n        window.location.reload();\r\n      }\r\n    });\r\n  }\r\n\r\n  private isUrlEnabled(hostname: string, enabledUrls: string[]): boolean {\r\n    return enabledUrls.some(url => {\r\n      if (url.includes('*')) {\r\n        const pattern = url.replace(/\\*/g, '.*');\r\n        return new RegExp(pattern).test(hostname);\r\n      }\r\n      return hostname.includes(url);\r\n    });\r\n  }\r\n\r\n  private createPanel(): void {\r\n    this.panel = document.createElement('div');\r\n    this.panel.id = 'ai-vscode-panel';\r\n    // æ–°å¢ï¼šå¾ˆå¤šæˆªå›¾åº“ï¼ˆå¦‚ html2canvasï¼‰ä¼šè¯†åˆ«è¿™ä¸ªå±æ€§å¹¶è·³è¿‡æ¸²æŸ“\r\n    this.panel.setAttribute('data-html2canvas-ignore', 'true');\r\n\r\n    this.panel.innerHTML = `\r\n    <div class=\"panel-container\">\r\n      <div class=\"ai-vscode-header\">\r\n        <span class=\"ai-vscode-title\">å‘é€åˆ°VS Code</span>\r\n        <button id=\"toggle-prompts\" class=\"ai-vscode-toggle\" title=\"æŠ˜å /å±•å¼€æç¤ºè¯\">â–¾</button>\r\n        <button id=\"close-panel\" class=\"ai-vscode-close\">âœ•</button>\r\n      </div>\r\n      <div id=\"filename-preview\" class=\"filename-preview\">æ–‡ä»¶åé¢„è§ˆ...</div>\r\n\r\n      <div id=\"prompt-section\">\r\n        <div class=\"prompt-section-header\">\r\n          <span>å¸¸ç”¨æç¤ºè¯</span>\r\n        </div>\r\n        <div id=\"prompt-buttons\" class=\"prompt-buttons\"></div>\r\n      </div>\r\n\r\n      <div class=\"ai-vscode-footer\">\r\n        <div class=\"button-group\">\r\n          <button id=\"send-to-vscode\" class=\"primary\">å¤åˆ¶å¹¶ä¿å­˜</button>\r\n          <button id=\"create-files-from-content\" class=\"secondary\" title=\"è¯†åˆ«ä»£ç å—ä¸­çš„è·¯å¾„å¹¶ç›´æ¥åˆ›å»ºæ–‡ä»¶\">è¯†åˆ«å¹¶åˆ›å»º</button>\r\n          <button id=\"patch-files-from-content\" class=\"secondary\" title=\"æ™ºèƒ½è¯†åˆ«è·¯å¾„å¹¶å±€éƒ¨æ›´æ–°æ–‡ä»¶å†…å®¹\">å±€éƒ¨æ›´æ–°</button>\r\n        </div>\r\n        <div class=\"button-group\" style=\"margin-top: 8px;\">\r\n          <button id=\"screenshot-element\" class=\"secondary\" title=\"é€‰æ‹©å…ƒç´ å¹¶æˆªå›¾ï¼ˆå¸¦çº¢æ¡†ï¼‰\">æˆªå›¾å…ƒç´ </button>\r\n          <button id=\"copy-element\" class=\"secondary\" title=\"é€‰æ‹©å…ƒç´ å¹¶å¤åˆ¶å…¶ä»£ç \">å¤åˆ¶å…ƒç´ </button>\r\n          <button id=\"send-screenshot\" class=\"secondary\" title=\"æˆªå–å½“å‰é¡µé¢å¹¶å‘é€åˆ° VS Code\">å…¨å±æˆªå›¾</button>\r\n          <button id=\"clone-page\" class=\"secondary\" title=\"å¤åˆ»å½“å‰é¡µé¢ï¼šæ³¨å…¥é”šç‚¹ -> æˆªå›¾ -> æå–æ•°æ® -> å‘é€\">å¤åˆ»é¡µé¢</button>\r\n        </div>\r\n        <div id=\"connection-status\" class=\"connection-status\">\r\n          <span class=\"status-dot\"></span>\r\n          <span class=\"status-text\">æœªè¿æ¥</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n    document.body.appendChild(this.panel);\r\n    DOMHelper.makeDraggable(this.panel);\r\n\r\n    const sendButton = document.getElementById('send-to-vscode');\r\n    sendButton?.addEventListener('click', () => this.handleSendClick());\r\n\r\n    const createFilesButton = document.getElementById('create-files-from-content');\r\n    createFilesButton?.addEventListener('click', () => this.handleCreateFilesClick());\r\n\r\n    const patchFilesButton = document.getElementById('patch-files-from-content');\r\n    patchFilesButton?.addEventListener('click', () => this.handlePartialUpdateClick());\r\n\r\n    const screenshotElementButton = document.getElementById('screenshot-element');\r\n    screenshotElementButton?.addEventListener('click', () => this.handleScreenshotElementClick());\r\n\r\n    const copyElementButton = document.getElementById('copy-element');\r\n    copyElementButton?.addEventListener('click', () => this.handleCopyElementClick());\r\n\r\n    const sendScreenshotButton = document.getElementById('send-screenshot');\r\n    sendScreenshotButton?.addEventListener('click', () => this.handleSendScreenshotClick());\r\n\r\n    const clonePageButton = document.getElementById('clone-page');\r\n    clonePageButton?.addEventListener('click', () => this.handleClonePageClick());\r\n\r\n    const closeButton = document.getElementById('close-panel');\r\n    closeButton?.addEventListener('click', () => this.togglePanel());\r\n\r\n    // æŠ˜å æŒ‰é’®é€»è¾‘\r\n    const toggleBtn = document.getElementById('toggle-prompts') as HTMLButtonElement | null;\r\n    const promptSection = document.getElementById('prompt-section');\r\n\r\n    if (toggleBtn && promptSection) {\r\n      toggleBtn.addEventListener('click', () => {\r\n        const collapsed = promptSection.classList.toggle('collapsed');\r\n        toggleBtn.textContent = collapsed ? 'â–¸' : 'â–¾';\r\n\r\n        // å¦‚éœ€è®°ä½ç”¨æˆ·é€‰æ‹©ï¼Œå¯ä»¥å†™å…¥ local\r\n        chrome.storage.local.set({ promptsCollapsed: collapsed });\r\n      });\r\n\r\n      // åˆå§‹åŒ–æ—¶è¯»å–æŠ˜å çŠ¶æ€\r\n      chrome.storage.local.get('promptsCollapsed', (res) => {\r\n        if (res.promptsCollapsed) {\r\n          promptSection.classList.add('collapsed');\r\n          toggleBtn.textContent = 'â–¸';\r\n        }\r\n      });\r\n    }\r\n\r\n    this.statusElement = document.getElementById('connection-status');\r\n    this.promptButtons = document.getElementById('prompt-buttons');\r\n\r\n    // åŠ è½½æç¤ºè¯æŒ‰é’®\r\n    this.loadPromptButtons();\r\n  }\r\n\r\n\r\n\r\n  private togglePanel(): void {\r\n    if (this.panel) {\r\n      this.panel.style.display =\r\n        this.panel.style.display === 'none' ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  private async handleSendClick(): Promise<void> {\r\n    const overallStart = performance.now();\r\n\r\n    // --- æ–°å¢ï¼šæˆªå›¾å‰éšè— UI ---\r\n    this.setUIVisibility(false);\r\n    // ç»™æµè§ˆå™¨ 50ms æ—¶é—´è¿›è¡Œé‡ç»˜ï¼Œç¡®ä¿ UI åœ¨æˆªå›¾ä¸­æ¶ˆå¤±\r\n    await this.delay(50);\r\n\r\n    console.group('ğŸš€ [å¤åˆ¶å¹¶ä¿å­˜] å®Œæ•´æµç¨‹');\r\n    console.log('â±ï¸ å¼€å§‹æ—¶é—´:', new Date().toLocaleTimeString());\r\n    console.log('ğŸ’¾ åˆå§‹å†…å­˜:', this.getMemoryUsage());\r\n\r\n    try {\r\n      // AI Studio ç‰¹æ®Šå¤„ç†\r\n      if (window.location.hostname.includes('aistudio.google.com')) {\r\n        await this.handleAIStudioCopy();\r\n        return;\r\n      }\r\n\r\n      // æ­¥éª¤1ï¼šæŸ¥æ‰¾æŒ‰é’®\r\n      console.log('\\nğŸ“ æ­¥éª¤1: æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®');\r\n      const copyButton = DOMHelper.findLatestCopyButton();\r\n\r\n      if (!copyButton) {\r\n        console.error('âŒ æœªæ‰¾åˆ°COPYæŒ‰é’®');\r\n        this.showError('æœªæ‰¾åˆ°COPYæŒ‰é’®');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      // æ­¥éª¤2ï¼šç‚¹å‡»æŒ‰é’®\r\n      console.log('\\nğŸ“ æ­¥éª¤2: ç‚¹å‡»å¤åˆ¶æŒ‰é’®');\r\n      console.time('ç‚¹å‡»å¤åˆ¶');\r\n      copyButton.click();\r\n      console.timeEnd('ç‚¹å‡»å¤åˆ¶');\r\n\r\n      // æ­¥éª¤3ï¼šç­‰å¾…å¤åˆ¶å®Œæˆ\r\n      console.log('\\nğŸ“ æ­¥éª¤3: ç­‰å¾…å¤åˆ¶å®Œæˆ (300ms)');\r\n      await this.delay(300);\r\n\r\n      // æ­¥éª¤4ï¼šè¯»å–å‰ªè´´æ¿\r\n      console.log('\\nğŸ“ æ­¥éª¤4: è¯»å–å‰ªè´´æ¿');\r\n      const content = await DOMHelper.getClipboardContent();\r\n\r\n      if (!content || content.trim().length === 0) {\r\n        console.error('âŒ å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n        this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      // æ­¥éª¤5ï¼šç”Ÿæˆæ–‡ä»¶å\r\n      console.log('\\nğŸ“ æ­¥éª¤5: ç”Ÿæˆæ–‡ä»¶å');\r\n      console.time('ç”Ÿæˆæ–‡ä»¶å');\r\n      const filename = this.generateSmartFilename(content);\r\n      console.timeEnd('ç”Ÿæˆæ–‡ä»¶å');\r\n      console.log('ğŸ“ æ–‡ä»¶å:', filename);\r\n\r\n      // æ­¥éª¤6ï¼šå‘é€åˆ°VS Code\r\n      console.log('\\nğŸ“ æ­¥éª¤6: å‘é€åˆ°VS Code');\r\n      this.showFilenamePreview(filename);\r\n      this.sendToVSCode(content, filename);\r\n\r\n      // æ­¥éª¤7ï¼šæ›´æ–°è®¡æ•°å™¨\r\n      console.log('\\nğŸ“ æ­¥éª¤7: æ›´æ–°è®¡æ•°å™¨');\r\n      await this.updateDailyCounter();\r\n\r\n      const overallEnd = performance.now();\r\n      console.log('\\nâœ… æµç¨‹å®Œæˆ');\r\n      console.log('â±ï¸ æ€»è€—æ—¶:', (overallEnd - overallStart).toFixed(2), 'ms');\r\n      console.log('ğŸ’¾ ç»“æŸå†…å­˜:', this.getMemoryUsage());\r\n      console.groupEnd();\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n      console.error('âŒ æµç¨‹å¤±è´¥:', error);\r\n      console.log('ğŸ’¾ é”™è¯¯æ—¶å†…å­˜:', this.getMemoryUsage());\r\n      this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n      console.groupEnd();\r\n    } finally {\r\n      // --- æ–°å¢ï¼šæ— è®ºæˆåŠŸå¤±è´¥ï¼Œæœ€åå¿…é¡»æ¢å¤ UI æ˜¾ç¤º ---\r\n      this.setUIVisibility(true);\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  private async handleCreateFilesClick(): Promise<void> {\r\n\r\n    this.setUIVisibility(false); // éšè—\r\n    await this.delay(50);        // å¼ºåˆ¶é‡ç»˜\r\n\r\n    console.group('ğŸš€ [è¯†åˆ«å¹¶åˆ›å»ºæ–‡ä»¶] æµç¨‹å¼€å§‹');\r\n    try {\r\n      // 1. è·å–å†…å®¹\r\n      let content = '';\r\n      if (window.location.hostname.includes('aistudio.google.com')) {\r\n        // AI Studio ç‰¹æ®Šå¤„ç†é€»è¾‘\r\n        const moreButtons = Array.from(document.querySelectorAll<HTMLElement>(\r\n          'button[aria-label*=\"options\"], button[iconname=\"more_vert\"], ms-chat-turn-options button'\r\n        ));\r\n        if (moreButtons.length > 0) {\r\n          const menuButton = moreButtons[moreButtons.length - 1];\r\n          menuButton.click();\r\n          await this.delay(500);\r\n          const copyButton = DOMHelper.findLatestCopyButton();\r\n          if (copyButton) {\r\n            copyButton.click();\r\n            await this.delay(300);\r\n            content = await DOMHelper.getClipboardContent();\r\n          }\r\n        }\r\n      } else {\r\n        const copyButton = DOMHelper.findLatestCopyButton();\r\n        if (copyButton) {\r\n          copyButton.click();\r\n          await this.delay(300);\r\n          content = await DOMHelper.getClipboardContent();\r\n        }\r\n      }\r\n\r\n      if (!content || content.trim().length === 0) {\r\n        this.showError('æœªè·å–åˆ°å†…å®¹ï¼Œè¯·ç¡®ä¿é¡µé¢ä¸Šæœ‰å¯å¤åˆ¶çš„å›ç­”');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      // 2. è§£æä»£ç å—\r\n      const files = this.parseFilesFromContent(content);\r\n      if (files.length === 0) {\r\n        this.showError('æœªåœ¨ä»£ç å—ä¸­è¯†åˆ«åˆ°æœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      console.log(`ğŸ” è¯†åˆ«åˆ° ${files.length} ä¸ªæ–‡ä»¶:`, files.map(f => f.path));\r\n\r\n      // 3. é€ä¸ªå‘é€åˆ° VS Code\r\n      let successCount = 0;\r\n      for (const file of files) {\r\n        try {\r\n          await this.sendToVSCode(file.content, file.filename, file.savePath);\r\n          successCount++;\r\n        } catch (err) {\r\n          console.error(`ä¿å­˜æ–‡ä»¶ ${file.path} å¤±è´¥:`, err);\r\n        }\r\n      }\r\n\r\n      if (successCount > 0) {\r\n        this.showSuccess(`âœ… æˆåŠŸè¯†åˆ«å¹¶åˆ›å»º ${successCount} ä¸ªæ–‡ä»¶`);\r\n        await this.updateDailyCounter();\r\n      } else {\r\n        this.showError('åˆ›å»ºæ–‡ä»¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¿æ¥');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('è¯†åˆ«å¹¶åˆ›å»ºæ–‡ä»¶å¤±è´¥:', error);\r\n      this.showError('è¯†åˆ«å¹¶åˆ›å»ºæ–‡ä»¶å¤±è´¥');\r\n    } finally {\r\n      this.setUIVisibility(true);  // æ¢å¤\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  private async handlePartialUpdateClick(): Promise<void> {\r\n    this.setUIVisibility(false); // éšè—\r\n    await this.delay(50);        // å¼ºåˆ¶é‡ç»˜\r\n\r\n    console.group('ğŸš€ [å±€éƒ¨æ›´æ–°æ–‡ä»¶] æµç¨‹å¼€å§‹');\r\n    try {\r\n      // 1. è·å–å†…å®¹\r\n      let content = '';\r\n      if (window.location.hostname.includes('aistudio.google.com')) {\r\n        const moreButtons = Array.from(document.querySelectorAll<HTMLElement>(\r\n          'button[aria-label*=\"options\"], button[iconname=\"more_vert\"], ms-chat-turn-options button'\r\n        ));\r\n        if (moreButtons.length > 0) {\r\n          const menuButton = moreButtons[moreButtons.length - 1];\r\n          menuButton.click();\r\n          await this.delay(500);\r\n          const copyButton = DOMHelper.findLatestCopyButton();\r\n          if (copyButton) {\r\n            copyButton.click();\r\n            await this.delay(300);\r\n            content = await DOMHelper.getClipboardContent();\r\n          }\r\n        }\r\n      } else {\r\n        const copyButton = DOMHelper.findLatestCopyButton();\r\n        if (copyButton) {\r\n          copyButton.click();\r\n          await this.delay(300);\r\n          content = await DOMHelper.getClipboardContent();\r\n        }\r\n      }\r\n\r\n      if (!content || content.trim().length === 0) {\r\n        this.showError('æœªè·å–åˆ°å†…å®¹');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      // 2. è§£æä»£ç å—\r\n      const files = this.parseFilesFromContent(content);\r\n      if (files.length === 0) {\r\n        this.showError('æœªè¯†åˆ«åˆ°æœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„');\r\n        console.groupEnd();\r\n        return;\r\n      }\r\n\r\n      console.log(`ğŸ” è¯†åˆ«åˆ° ${files.length} ä¸ªæ›´æ–°é¡¹:`, files.map(f => f.path));\r\n\r\n      // 3. é€ä¸ªå‘é€åˆ° VS Code (å¸¦æœ‰ patch ç±»å‹)\r\n      let successCount = 0;\r\n      for (const file of files) {\r\n        try {\r\n          await this.sendToVSCode(file.content, file.filename, file.savePath, 'patch');\r\n          successCount++;\r\n        } catch (err) {\r\n          console.error(`æ›´æ–°æ–‡ä»¶ ${file.path} å¤±è´¥:`, err);\r\n        }\r\n      }\r\n\r\n      if (successCount > 0) {\r\n        this.showSuccess(`âœ… æˆåŠŸå‘é€ ${successCount} ä¸ªå±€éƒ¨æ›´æ–°è¯·æ±‚`);\r\n        await this.updateDailyCounter();\r\n      } else {\r\n        this.showError('æ›´æ–°è¯·æ±‚å‘é€å¤±è´¥');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('å±€éƒ¨æ›´æ–°å¤±è´¥:', error);\r\n      this.showError('å±€éƒ¨æ›´æ–°å¤±è´¥');\r\n    } finally {\r\n      this.setUIVisibility(true);  // æ¢å¤\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  private handleScreenshotElementClick(): void {\r\n    if (!this.picker) {\r\n      this.picker = new ElementPicker(async (el) => {\r\n        // è®°å½•é€‰ä¸­çš„å…ƒç´ \r\n        this.lastSelectedElement = el;\r\n        // é€‰æ‹©å…ƒç´ åï¼Œè‡ªåŠ¨è§¦å‘æˆªå›¾ï¼ˆå¸¦çº¢æ¡†ï¼‰ï¼Œä½†ä¸åˆå¹¶æ–‡æœ¬ï¼ˆä¼  nullï¼‰\r\n        await this.handleCaptureWithText(null, el);\r\n      });\r\n    }\r\n    this.picker.start();\r\n    this.showNotification('è¯·é€‰æ‹©è¦æˆªå›¾çš„å…ƒç´  (Esc é€€å‡º)', 'success');\r\n  }\r\n\r\n  private handleCopyElementClick(): void {\r\n    // å¦‚æœæœ‰ä¸Šæ¬¡é€‰ä¸­çš„å…ƒç´ ï¼Œä¸”è¯¥å…ƒç´ ä»åœ¨æ–‡æ¡£ä¸­ï¼Œç›´æ¥ä½¿ç”¨\r\n    if (this.lastSelectedElement && document.body.contains(this.lastSelectedElement)) {\r\n      const info = ElementPicker.getElementInfo(this.lastSelectedElement);\r\n      navigator.clipboard.writeText(info).then(() => {\r\n        this.showSuccess('âœ… å·²å¤åˆ¶ä¸Šæ¬¡é€‰ä¸­å…ƒç´ çš„ä»£ç ');\r\n      }).catch(err => {\r\n        this.showError('å¤åˆ¶å¤±è´¥: ' + err);\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!this.picker) {\r\n      this.picker = new ElementPicker((el) => {\r\n        // åŒæ—¶ä¹Ÿæ›´æ–°è®°å½•\r\n        this.lastSelectedElement = el;\r\n        const info = ElementPicker.getElementInfo(el);\r\n        navigator.clipboard.writeText(info).then(() => {\r\n          this.showSuccess('âœ… å…ƒç´ ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');\r\n        }).catch(err => {\r\n          this.showError('å¤åˆ¶å¤±è´¥: ' + err);\r\n        });\r\n      });\r\n    }\r\n    this.picker.start();\r\n    this.showNotification('è¯·é€‰æ‹©è¦å¤åˆ¶çš„å…ƒç´  (Esc é€€å‡º)', 'success');\r\n  }\r\n\r\n  private async handleSendScreenshotClick(): Promise<void> {\r\n    // æ™®é€šæˆªå›¾ï¼Œä¸å¸¦é¢å¤–æ–‡æœ¬\r\n    await this.handleCaptureWithText(null);\r\n  }\r\n\r\n  private async handleClonePageClick(): Promise<void> {\r\n    this.setUIVisibility(false);\r\n    this.showNotification('æ­£åœ¨å‡†å¤‡å¤åˆ»...', 'success');\r\n\r\n    // 1. æ³¨å…¥è§†è§‰é”šç‚¹\r\n    VisualAnchorManager.injectAnchors();\r\n\r\n    // ç»™æµè§ˆå™¨ä¸€ç‚¹æ—¶é—´æ¸²æŸ“é”šç‚¹\r\n    await this.delay(100);\r\n\r\n    // 2. æˆªå›¾\r\n    chrome.runtime.sendMessage({ action: 'captureScreenshot' }, async (response) => {\r\n      // 3. ç§»é™¤é”šç‚¹ (æˆªå›¾å®Œæˆåç«‹å³ç§»é™¤ï¼Œæ¢å¤åŸå§‹ç•Œé¢)\r\n      VisualAnchorManager.removeAnchors();\r\n      this.setUIVisibility(true);\r\n\r\n      if (chrome.runtime.lastError || !response || !response.success || !response.dataUrl) {\r\n        this.showError('æˆªå›¾å¤±è´¥ï¼Œæ— æ³•ç»§ç»­å¤åˆ»');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // 4. å¤åˆ¶åˆ°å‰ªè´´æ¿\r\n        await this.copyToClipboard(response.dataUrl, null);\r\n        this.showSuccess('âœ… å¸¦æœ‰æ ‡æ³¨çš„æˆªå›¾å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');\r\n\r\n      } catch (e) {\r\n        console.error('å¤åˆ»å¤„ç†å¤±è´¥:', e);\r\n        this.showError('å¤åˆ»å¤„ç†å¤±è´¥: ' + e);\r\n      }\r\n    });\r\n  }\r\n\r\n  // ç»Ÿä¸€çš„æˆªå›¾å¤„ç†æ–¹æ³•ï¼Œæ”¯æŒé™„åŠ æ–‡æœ¬å’Œé«˜äº®å…ƒç´ \r\n  private async handleCaptureWithText(additionalText: string | null, highlightElement: HTMLElement | null = null): Promise<void> {\r\n    // æˆªå›¾å‰éšè—æ‚¬æµ®çª—\r\n    this.setUIVisibility(false);\r\n\r\n    // å¦‚æœæœ‰é«˜äº®å…ƒç´ ï¼Œåˆ›å»ºé«˜äº®æ¡†\r\n    let highlightBox: HTMLElement | null = null;\r\n    if (highlightElement) {\r\n      const rect = highlightElement.getBoundingClientRect();\r\n      highlightBox = document.createElement('div');\r\n      Object.assign(highlightBox.style, {\r\n        position: 'fixed',\r\n        top: `${rect.top}px`,\r\n        left: `${rect.left}px`,\r\n        width: `${rect.width}px`,\r\n        height: `${rect.height}px`,\r\n        border: '3px solid red',\r\n        zIndex: '1000001', // ç¡®ä¿åœ¨æœ€ä¸Šå±‚\r\n        pointerEvents: 'none',\r\n        boxSizing: 'border-box'\r\n      });\r\n      // æ·»åŠ  data-html2canvas-ignore å±æ€§ï¼Œè™½ç„¶æˆ‘ä»¬æ˜¯ç”¨åŸç”Ÿæˆªå›¾ï¼Œä½†ä¿æŒå¥½ä¹ æƒ¯\r\n      highlightBox.setAttribute('data-html2canvas-ignore', 'true');\r\n      document.body.appendChild(highlightBox);\r\n    }\r\n\r\n    this.showNotification('æ­£åœ¨æ•è·...', 'success');\r\n\r\n    // ç»™æµè§ˆå™¨ 50ms æ—¶é—´è¿›è¡Œé‡ç»˜\r\n    await this.delay(50);\r\n\r\n    chrome.runtime.sendMessage({ action: 'captureScreenshot' }, async (response) => {\r\n      // æˆªå›¾å®Œæˆåç«‹å³æ¢å¤æ˜¾ç¤º\r\n      this.setUIVisibility(true);\r\n\r\n      // ç§»é™¤é«˜äº®æ¡†\r\n      if (highlightBox) {\r\n        highlightBox.remove();\r\n      }\r\n\r\n      if (chrome.runtime.lastError) {\r\n        this.showError('æˆªå›¾å¤±è´¥: ' + chrome.runtime.lastError.message);\r\n        return;\r\n      }\r\n      if (response && response.success) {\r\n        if (response.dataUrl) {\r\n          try {\r\n            await this.copyToClipboard(response.dataUrl, additionalText);\r\n            const msg = additionalText\r\n              ? 'âœ… å…ƒç´ ä¿¡æ¯ä¸æˆªå›¾å·²åˆå¹¶å¤åˆ¶ï¼Œè¯· Ctrl+V ç²˜è´´'\r\n              : 'âœ… æˆªå›¾å·²å¤åˆ¶ï¼Œè¯· Ctrl+V ç²˜è´´';\r\n            this.showSuccess(msg);\r\n          } catch (err) {\r\n            console.error('å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥:', err);\r\n            this.showSuccess('âœ… æˆªå›¾å·²å‘é€åˆ° VS Code (å‰ªè´´æ¿å¤åˆ¶å¤±è´¥)');\r\n          }\r\n        } else {\r\n          this.showSuccess('âœ… æˆªå›¾å·²å‘é€åˆ° VS Code');\r\n        }\r\n      } else {\r\n        this.showError('æˆªå›¾å¤±è´¥: ' + (response?.error || 'æœªçŸ¥é”™è¯¯'));\r\n      }\r\n    });\r\n  }\r\n\r\n  private async copyToClipboard(dataUrl: string, text: string | null): Promise<void> {\r\n    const response = await fetch(dataUrl);\r\n    const blob = await response.blob();\r\n\r\n    const data: Record<string, Blob> = {\r\n      [blob.type]: blob\r\n    };\r\n\r\n    if (text) {\r\n      // æ·»åŠ æ–‡æœ¬æ•°æ®\r\n      data['text/plain'] = new Blob([text], { type: 'text/plain' });\r\n    }\r\n\r\n    const item = new ClipboardItem(data);\r\n    await navigator.clipboard.write([item]);\r\n  }\r\n\r\n\r\n  private parseFilesFromContent(content: string): Array<{ path: string; filename: string; savePath: string; content: string }> {\r\n    const files: Array<{ path: string; filename: string; savePath: string; content: string }> = [];\r\n    let memoryUpdated = false;\r\n\r\n    console.log('ğŸ” å¼€å§‹åˆ‡ç‰‡è§£æ (Slice First), é•¿åº¦:', content.length);\r\n\r\n    // æ­¥éª¤ 1: æ™ºèƒ½åˆ‡ç‰‡ - åªåœ¨ä»£ç å—å¤–éƒ¨çš„ --- å¤„åˆ‡åˆ†\r\n    // æ‰‹åŠ¨éå†å†…å®¹ï¼Œè·Ÿè¸ªæ˜¯å¦åœ¨ä»£ç å—å†…\r\n    const slices: string[] = [];\r\n    let currentSliceStart = 0;\r\n    let inCodeBlock = false;\r\n    const lines = content.split('\\n');\r\n    let charIndex = 0;\r\n\r\n    for (let lineNum = 0; lineNum < lines.length; lineNum++) {\r\n      const line = lines[lineNum];\r\n\r\n      // æ£€æŸ¥æ˜¯å¦è¿›å…¥/ç¦»å¼€ä»£ç å—\r\n      if (line.trim().startsWith('```')) {\r\n        inCodeBlock = !inCodeBlock;\r\n      }\r\n\r\n      // æ£€æŸ¥æ˜¯å¦æ˜¯åˆ†éš”ç¬¦ (ä»…åœ¨ä»£ç å—å¤–éƒ¨)\r\n      if (!inCodeBlock && /^[-]{3,}$/.test(line.trim())) {\r\n        // æ‰¾åˆ°åˆ†éš”ç¬¦ï¼Œç»“æŸå½“å‰åˆ‡ç‰‡\r\n        const sliceEnd = charIndex;\r\n        if (sliceEnd > currentSliceStart) {\r\n          slices.push(content.substring(currentSliceStart, sliceEnd).trim());\r\n        }\r\n        // æ–°åˆ‡ç‰‡ä»åˆ†éš”ç¬¦ä¹‹åå¼€å§‹\r\n        currentSliceStart = charIndex + line.length + 1; // +1 for \\n\r\n      }\r\n\r\n      charIndex += line.length + 1; // +1 for \\n\r\n    }\r\n\r\n    // æ·»åŠ æœ€åä¸€ä¸ªåˆ‡ç‰‡\r\n    if (currentSliceStart < content.length) {\r\n      slices.push(content.substring(currentSliceStart).trim());\r\n    }\r\n\r\n    console.log(`ğŸ”ª åˆ‡ç‰‡æ•°é‡: ${slices.length}`);\r\n\r\n    // æ­¥éª¤ 2: å¯¹æ¯ä¸ªåˆ‡ç‰‡ç‹¬ç«‹è§£æ\r\n    for (let i = 0; i < slices.length; i++) {\r\n      const slice = slices[i];\r\n\r\n      // åœ¨åˆ‡ç‰‡å†…å¯»æ‰¾è·¯å¾„æŒ‡ç¤ºå™¨\r\n      // æ ¼å¼ A: æ–‡ä»¶å: `path/to/file.ext`\r\n      // æ ¼å¼ B: **path/to/file.ext**\r\n      // æ ¼å¼ C: è¡Œé¦– path/to/file.ext\r\n      const pathPatterns = [\r\n        /(?:æ–‡ä»¶å|File\\s*(?:Name|Path)?|è·¯å¾„|åç§°)[:ï¼š]\\s*[`\"]?([a-zA-Z0-9._\\-\\/]+\\.[a-zA-Z0-9]+)[`\"]?/i,\r\n        /(?:\\*\\*|__|\\`)([a-zA-Z0-9._\\-\\/]+\\.[a-zA-Z0-9]+)(?:\\*\\*|__|\\`)/,\r\n        /^([a-zA-Z0-9._\\-\\/]+\\.[a-zA-Z0-9]{1,10})$/m\r\n      ];\r\n\r\n      let detectedPath: string | null = null;\r\n      for (const pattern of pathPatterns) {\r\n        const match = slice.match(pattern);\r\n        if (match && match[1]) {\r\n          detectedPath = match[1];\r\n          console.log(`ğŸ¯ åˆ‡ç‰‡ ${i}: æ£€æµ‹åˆ°è·¯å¾„ \"${detectedPath}\"`);\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!detectedPath) {\r\n        console.log(`â­ï¸ åˆ‡ç‰‡ ${i}: æœªæ£€æµ‹åˆ°è·¯å¾„ï¼Œè·³è¿‡ (å‰50å­—ç¬¦: \"${slice.substring(0, 50).replace(/\\n/g, '\\\\n')}...\")`);\r\n        continue;\r\n      }\r\n\r\n      // åœ¨åˆ‡ç‰‡å†…å¯»æ‰¾ä»£ç å— - ä½¿ç”¨ lastIndexOf æ‰¾æœ€åä¸€ä¸ªé—­åˆæ ‡è®°\r\n      const blockStartMatch = slice.match(/```(\\w+)?[\\r\\n]+/);\r\n      if (!blockStartMatch) {\r\n        console.log(`âš ï¸ åˆ‡ç‰‡ ${i}: è·¯å¾„ \"${detectedPath}\" åæœªæ‰¾åˆ°ä»£ç å—å¼€å§‹`);\r\n        continue;\r\n      }\r\n\r\n      const lang = blockStartMatch[1] || 'text';\r\n      const contentStart = blockStartMatch.index! + blockStartMatch[0].length;\r\n\r\n      // å…³é”®ä¿®å¤ï¼šåœ¨åˆ‡ç‰‡å†…å¯»æ‰¾ã€æœ€åä¸€ä¸ªã€‘é—­åˆæ ‡è®°\r\n      const lastClosingIndex = slice.lastIndexOf('```');\r\n\r\n      if (lastClosingIndex <= contentStart) {\r\n        console.log(`âš ï¸ åˆ‡ç‰‡ ${i}: è·¯å¾„ \"${detectedPath}\" çš„ä»£ç å—æœªæ­£ç¡®é—­åˆ`);\r\n        continue;\r\n      }\r\n\r\n      const blockContent = slice.substring(contentStart, lastClosingIndex).trim();\r\n      console.log(`ğŸ“¦ åˆ‡ç‰‡ ${i}: ä»£ç å—é•¿åº¦ ${blockContent.length} chars`);\r\n\r\n      // è·¯å¾„å¤„ç†\r\n      let fullPath = detectedPath.replace(/^\\.?\\//, '');\r\n      const parts = fullPath.split('/');\r\n      const filename = parts.pop() || '';\r\n      let savePath = parts.join('/');\r\n\r\n      console.log(`ğŸ“‚ è·¯å¾„è§£æ: fullPath=\"${fullPath}\", filename=\"${filename}\", savePath=\"${savePath}\"`);\r\n\r\n      // è·¯å¾„è®°å¿†\r\n      if (!savePath) {\r\n        const lowerFilename = filename.toLowerCase();\r\n        const memoryKey = Object.keys(this.pathMemory).find(k => k.toLowerCase() === lowerFilename);\r\n        if (memoryKey) {\r\n          savePath = this.pathMemory[memoryKey];\r\n          fullPath = savePath ? `${savePath}/${filename}` : filename;\r\n          console.log(`ğŸ§  è®°å¿†åŒ¹é…: ${filename} -> ${savePath}`);\r\n        }\r\n      }\r\n\r\n      if (savePath && this.pathMemory[filename] !== savePath) {\r\n        this.pathMemory[filename] = savePath;\r\n        memoryUpdated = true;\r\n        console.log(`ğŸ“ æ›´æ–°è·¯å¾„è®°å¿†: ${filename} -> ${savePath}`);\r\n      }\r\n\r\n      files.push({\r\n        path: fullPath,\r\n        filename: filename,\r\n        savePath: savePath,\r\n        content: blockContent\r\n      });\r\n      console.log(`âœ… æˆåŠŸæå–: ${fullPath} (è¯­è¨€: ${lang}, ${blockContent.length} chars)`);\r\n    }\r\n\r\n    if (memoryUpdated) {\r\n      this.savePathMemory();\r\n    }\r\n\r\n    console.log(`ğŸ“¦ æ€»å…±æå– ${files.length} ä¸ªæ–‡ä»¶`);\r\n    return files;\r\n  }\r\n\r\n  private async sendToVSCode(content: string, filename: string, customSavePath?: string, type: 'save' | 'patch' = 'save'): Promise<void> {\r\n    try {\r\n      // è·å–ä¿å­˜è·¯å¾„é…ç½®\r\n      const settings = await chrome.storage.sync.get({ savePath: '' });\r\n      const defaultSavePath = (settings.savePath || '').trim();\r\n\r\n      // å¦‚æœæœ‰è‡ªå®šä¹‰è·¯å¾„ï¼Œåˆ™æ‹¼æ¥åˆ°é»˜è®¤è·¯å¾„åï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨\r\n      let finalSavePath = customSavePath || '';\r\n      if (defaultSavePath) {\r\n        if (finalSavePath) {\r\n          finalSavePath = `${defaultSavePath}/${finalSavePath}`;\r\n        } else {\r\n          finalSavePath = defaultSavePath;\r\n        }\r\n      }\r\n\r\n      const message: MessageToVSCode = {\r\n        action: 'sendToVSCode',\r\n        content,\r\n        filename,\r\n        savePath: finalSavePath,\r\n        type: type\r\n      };\r\n\r\n      return new Promise((resolve, reject) => {\r\n        chrome.runtime.sendMessage(message, (response: MessageResponse) => {\r\n          if (chrome.runtime.lastError) {\r\n            reject(new Error(chrome.runtime.lastError.message));\r\n            return;\r\n          }\r\n          if (response && response.success) {\r\n            resolve();\r\n          } else {\r\n            reject(new Error(response?.error || 'æœªçŸ¥é”™è¯¯'));\r\n          }\r\n        });\r\n      });\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private getMemoryUsage(): string {\r\n    if ('memory' in performance) {\r\n      const memory = (performance as any).memory;\r\n      const used = (memory.usedJSHeapSize / 1048576).toFixed(2);\r\n      const total = (memory.totalJSHeapSize / 1048576).toFixed(2);\r\n      return `${used} MB / ${total} MB`;\r\n    }\r\n    return 'ä¸å¯ç”¨';\r\n  }\r\n\r\n\r\n  // æ–°å¢ï¼šä¸“é—¨å¤„ç† AI Studio çš„å¤åˆ¶\r\n  private async handleAIStudioCopy(): Promise<void> {\r\n    try {\r\n      this.debugLog('ğŸ” AI Studio ç‰¹æ®Šå¤„ç†ï¼šæŸ¥æ‰¾èœå•æŒ‰é’®');\r\n\r\n      // 1. æŸ¥æ‰¾æ‰€æœ‰çš„ more_vert æŒ‰é’®\r\n      const moreButtons = Array.from(document.querySelectorAll<HTMLElement>(\r\n        'button[aria-label*=\"options\"], ' +\r\n        'button[iconname=\"more_vert\"], ' +\r\n        'button[aria-label*=\"Open options\"], ' +\r\n        'ms-chat-turn-options button'\r\n      ));\r\n\r\n      if (moreButtons.length === 0) {\r\n        this.showError('æœªæ‰¾åˆ°èœå•æŒ‰é’®');\r\n        return;\r\n      }\r\n\r\n      // è·å–æœ€åä¸€ä¸ªï¼ˆæœ€æ–°çš„å›ç­”ï¼‰\r\n      const menuButton = moreButtons[moreButtons.length - 1];\r\n      this.debugLog('âœ… æ‰¾åˆ°èœå•æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n\r\n      // 2. ç‚¹å‡»èœå•æŒ‰é’®å±•å¼€èœå•\r\n      menuButton.click();\r\n      this.debugLog('âœ… èœå•å·²å±•å¼€ï¼Œç­‰å¾…åŠ è½½...');\r\n\r\n      // 3. ç­‰å¾…èœå•å±•å¼€\r\n      await this.delay(500);\r\n\r\n      // 4. æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®\r\n      const copyButton = DOMHelper.findLatestCopyButton();\r\n\r\n      if (!copyButton) {\r\n        console.error('âŒ èœå•å±•å¼€åä»æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n        this.showError('æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n        // å…³é—­èœå•\r\n        menuButton.click();\r\n        return;\r\n      }\r\n\r\n      this.debugLog('âœ… æ‰¾åˆ°å¤åˆ¶æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n\r\n      // 5. ç‚¹å‡»å¤åˆ¶æŒ‰é’®\r\n      copyButton.click();\r\n\r\n      // 6. ç­‰å¾…å¤åˆ¶å®Œæˆ\r\n      await this.delay(300);\r\n\r\n      // 7. è¯»å–å‰ªè´´æ¿å†…å®¹\r\n      const content = await DOMHelper.getClipboardContent();\r\n\r\n      if (!content || content.trim().length === 0) {\r\n        this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n        return;\r\n      }\r\n\r\n      this.debugLog('âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:', content.length);\r\n\r\n      // å†…å®¹é•¿åº¦é™åˆ¶æ£€æŸ¥\r\n      if (content.length > 50000) { // 50KBé™åˆ¶\r\n        this.showError('å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œæ— æ³•ç›´æ¥å¤åˆ¶ï¼Œè¯·åˆ†æ‰¹æ“ä½œï¼');\r\n        return;\r\n      }\r\n\r\n      // 8. ç”Ÿæˆæ–‡ä»¶åå¹¶ä¿å­˜\r\n      const filename = this.generateSmartFilename(content);\r\n      this.debugLog('ğŸ“ ç”Ÿæˆæ–‡ä»¶å:', filename);\r\n\r\n      this.showFilenamePreview(filename);\r\n      this.sendToVSCode(content, filename);\r\n      await this.updateDailyCounter();\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n      console.error('AI Studio å¤åˆ¶å¤±è´¥:', error);\r\n      this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n    }\r\n  }\r\n\r\n\r\n  private generateSmartFilename(content: string): string {\r\n    const now = new Date();\r\n\r\n    // æ ¼å¼åŒ–æ—¥æœŸ: YYYYMMDD\r\n    const date = now.getFullYear() +\r\n      String(now.getMonth() + 1).padStart(2, '0') +\r\n      String(now.getDate()).padStart(2, '0');\r\n\r\n    // æ ¼å¼åŒ–æ—¶é—´: HHmmss\r\n    const time = String(now.getHours()).padStart(2, '0') +\r\n      String(now.getMinutes()).padStart(2, '0') +\r\n      String(now.getSeconds()).padStart(2, '0');\r\n\r\n    // åºå·: 001, 002, 003...\r\n    const sequence = String(this.dailyCounter).padStart(3, '0');\r\n\r\n    // æå–ç¬¬ä¸€å¥è¯\r\n    const firstSentence = this.extractFirstSentence(content);\r\n\r\n    // æ¸…ç†ç¬¬ä¸€å¥è¯\r\n    const cleanedSentence = this.cleanSentence(firstSentence);\r\n\r\n    // é™åˆ¶é•¿åº¦ï¼ˆé˜²æ­¢æ–‡ä»¶åè¿‡é•¿ï¼‰\r\n    const shortSentence = this.truncateFilename(cleanedSentence, 50);\r\n\r\n    // ç»„åˆæ–‡ä»¶å\r\n    return `${date}-${time}-${sequence}-${shortSentence}.md`;\r\n  }\r\n\r\n  private extractFirstSentence(content: string): string {\r\n    // ç§»é™¤Markdownæ ‡è®°\r\n    let text = content.trim();\r\n    text = text.replace(/^#+\\s+/gm, ''); // ç§»é™¤æ ‡é¢˜ç¬¦å·\r\n    text = text.replace(/\\*\\*(.+?)\\*\\*/g, '$1'); // ç§»é™¤åŠ ç²—\r\n    text = text.replace(/\\*(.+?)\\*/g, '$1'); // ç§»é™¤æ–œä½“\r\n    text = text.replace(/`(.+?)`/g, '$1'); // ç§»é™¤ä»£ç æ ‡è®°\r\n    text = text.replace(/\\[(.+?)\\]\\(.+?\\)/g, '$1'); // ç§»é™¤é“¾æ¥ï¼Œä¿ç•™æ–‡æœ¬\r\n\r\n    // åˆ†å‰²æˆå¥å­ï¼ˆæŒ‰å¥å·ã€é—®å·ã€æ„Ÿå¹å·ã€æ¢è¡Œï¼‰\r\n    const sentences = text.split(/[ã€‚.!?ï¼ï¼Ÿ\\n]/);\r\n\r\n    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰å®é™…å†…å®¹çš„å¥å­\r\n    for (const sentence of sentences) {\r\n      const cleaned = sentence.trim();\r\n      if (cleaned.length > 5) { // è‡³å°‘5ä¸ªå­—ç¬¦\r\n        return cleaned;\r\n      }\r\n    }\r\n\r\n    // å¦‚æœæ²¡æ‰¾åˆ°åˆé€‚çš„å¥å­ï¼Œå–å‰50ä¸ªå­—ç¬¦\r\n    return text.substring(0, 50).trim();\r\n  }\r\n\r\n  private cleanSentence(sentence: string): string {\r\n    // ç§»é™¤å¸¸è§çš„å¼€åœºç™½\r\n    const removePatterns = [\r\n      /^å¥½çš„[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å½“ç„¶[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æˆ‘ä¼š[^\\s]{0,5}/i,\r\n      /^æˆ‘å°†[^\\s]{0,5}/i,\r\n      /^è®©æˆ‘[^\\s]{0,5}/i,\r\n      /^æ˜ç™½[äº†å—]?[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ”¶åˆ°[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å¥½[çš„å•¦][ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^OK[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^äº†è§£[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ²¡é—®é¢˜[ï¼!ï¼Œ,ã€‚.\\s]*/i\r\n    ];\r\n\r\n    let cleaned = sentence;\r\n    for (const pattern of removePatterns) {\r\n      cleaned = cleaned.replace(pattern, '');\r\n    }\r\n\r\n    // ç§»é™¤ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼ï¼ˆæ–‡ä»¶åä¸å…è®¸çš„å­—ç¬¦ï¼‰\r\n    cleaned = cleaned.replace(/[<>:\"/\\\\|?*\\x00-\\x1F]/g, '');\r\n\r\n    // ç§»é™¤å¤šä½™ç©ºæ ¼\r\n    cleaned = cleaned.replace(/\\s+/g, '-');\r\n\r\n    // ç§»é™¤å¼€å¤´å’Œç»“å°¾çš„è¿å­—ç¬¦\r\n    cleaned = cleaned.replace(/^-+|-+$/g, '');\r\n\r\n    return cleaned;\r\n  }\r\n\r\n  private truncateFilename(text: string, maxLength: number): string {\r\n    if (text.length <= maxLength) {\r\n      return text;\r\n    }\r\n\r\n    // åœ¨maxLengthå¤„æˆªæ–­ï¼Œä½†å°è¯•åœ¨åˆé€‚çš„ä½ç½®ï¼ˆå¦‚è¿å­—ç¬¦å¤„ï¼‰\r\n    let truncated = text.substring(0, maxLength);\r\n    const lastDash = truncated.lastIndexOf('-');\r\n\r\n    if (lastDash > maxLength * 0.7) {\r\n      // å¦‚æœåœ¨å70%æœ‰è¿å­—ç¬¦ï¼Œåœ¨é‚£é‡Œæˆªæ–­\r\n      truncated = truncated.substring(0, lastDash);\r\n    }\r\n\r\n    return truncated;\r\n  }\r\n\r\n  private showFilenamePreview(filename: string): void {\r\n    const preview = document.getElementById('filename-preview');\r\n    if (preview) {\r\n      preview.textContent = `ğŸ“„ ${filename}`;\r\n      preview.style.display = 'block';\r\n\r\n      // 3ç§’åéšè—\r\n      setTimeout(() => {\r\n        preview.style.display = 'none';\r\n      }, 3000);\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  private setupMessageListener(): void {\r\n    chrome.runtime.onMessage.addListener((message: ConnectionStatus) => {\r\n      if (message.type === 'connectionStatus') {\r\n        this.updateConnectionStatus(message.status === 'connected');\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateConnectionStatus(connected: boolean): void {\r\n    if (!this.statusElement) return;\r\n\r\n    const statusText = this.statusElement.querySelector('.status-text');\r\n    const statusDot = this.statusElement.querySelector('.status-dot');\r\n\r\n    if (connected) {\r\n      this.statusElement.classList.add('connected');\r\n      if (statusText) statusText.textContent = 'å·²è¿æ¥';\r\n      if (statusDot) statusDot.classList.add('active');\r\n    } else {\r\n      this.statusElement.classList.remove('connected');\r\n      if (statusText) statusText.textContent = 'æœªè¿æ¥';\r\n      if (statusDot) statusDot.classList.remove('active');\r\n    }\r\n  }\r\n\r\n  private showSuccess(message: string): void {\r\n    this.showNotification(message, 'success');\r\n  }\r\n\r\n  private showError(message: string): void {\r\n    this.showNotification(message, 'error');\r\n  }\r\n\r\n  private showNotification(message: string, type: 'success' | 'error'): void {\r\n    const notification = document.createElement('div');\r\n    notification.className = `notification ${type}`;\r\n    notification.textContent = message;\r\n    document.body.appendChild(notification);\r\n\r\n    setTimeout(() => notification.remove(), 3000);\r\n  }\r\n\r\n  private delay(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // æç¤ºè¯ç›¸å…³æ–¹æ³•\r\n  private async loadPromptButtons(): Promise<void> {\r\n    try {\r\n      // ä¼˜å…ˆä» local åŠ è½½ï¼ˆæ–°å­˜å‚¨æ–¹å¼ï¼‰\r\n      const localResult = await chrome.storage.local.get(['promptFiles']);\r\n      let promptFiles = localResult.promptFiles || [];\r\n\r\n      // å¦‚æœ local ä¸­æ²¡æœ‰ï¼Œå›é€€åˆ° syncï¼ˆæ—§å­˜å‚¨æ–¹å¼ï¼‰\r\n      if (promptFiles.length === 0) {\r\n        const syncResult = await chrome.storage.sync.get(['promptFiles']);\r\n        promptFiles = syncResult.promptFiles || [];\r\n        if (promptFiles.length > 0) {\r\n          console.log('ä» sync åŠ è½½æç¤ºè¯ï¼ˆæ—§æ ¼å¼ï¼‰');\r\n        }\r\n      }\r\n\r\n      this.createPromptButtons(promptFiles);\r\n    } catch (error) {\r\n      console.error('åŠ è½½æç¤ºè¯å¤±è´¥:', error);\r\n    }\r\n  }\r\n\r\n  private createPromptButtons(prompts: any[]): void {\r\n    if (!this.promptButtons || prompts.length === 0) return;\r\n\r\n    this.promptButtons.innerHTML = prompts\r\n      .filter(p => p.enabled)\r\n      .map(prompt => `\r\n        <button \r\n          class=\"prompt-btn\" \r\n          data-prompt-id=\"${prompt.id}\"\r\n          data-prompt-name=\"${this.escapeHtml(prompt.name)}\"\r\n          style=\"\r\n            padding: 8px 12px;\r\n            background: #6c5ce7;\r\n            color: white;\r\n            border: none;\r\n            border-radius: 4px;\r\n            cursor: pointer;\r\n            font-size: 12px;\r\n            transition: all 0.2s;\r\n            text-align: left;\r\n          \"\r\n        >\r\n          ğŸ“ ${this.escapeHtml(prompt.name)}\r\n        </button>\r\n      `)\r\n      .join('');\r\n\r\n    // ä¿å­˜æç¤ºè¯å†…å®¹åˆ°æŒ‰é’®çš„è‡ªå®šä¹‰å±æ€§\r\n    const buttons = this.promptButtons.querySelectorAll('.prompt-btn');\r\n    buttons.forEach((btn, index) => {\r\n      const htmlBtn = btn as HTMLElement;\r\n      (htmlBtn as any).__promptContent = prompts.filter(p => p.enabled)[index].path;\r\n\r\n      // ç§»å‡ºå†…è”äº‹ä»¶ï¼Œæ”¹ç”¨ addEventListener ä»¥ç¬¦åˆ CSP\r\n      htmlBtn.addEventListener('mouseover', () => {\r\n        htmlBtn.style.background = '#5f4dd1';\r\n      });\r\n      htmlBtn.addEventListener('mouseout', () => {\r\n        htmlBtn.style.background = '#6c5ce7';\r\n      });\r\n\r\n      htmlBtn.addEventListener('click', (e) => {\r\n        const target = e.currentTarget as any;\r\n        const content = target.__promptContent;\r\n        const name = target.getAttribute('data-prompt-name');\r\n        if (content) {\r\n          this.applyPrompt(content, name || '');\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private async applyPrompt(content: string, promptName: string): Promise<void> {\r\n    try {\r\n      console.log('ğŸ“ å¼€å§‹åº”ç”¨æç¤ºè¯:', promptName);\r\n\r\n      if (!content || content.trim().length === 0) {\r\n        this.showError('æç¤ºè¯å†…å®¹ä¸ºç©º');\r\n        return;\r\n      }\r\n\r\n      console.log('âœ… å†…å®¹é•¿åº¦:', content.length);\r\n\r\n      // 1. æŸ¥æ‰¾ System Instructions æŒ‰é’®\r\n      const sysInstructionsBtn = document.querySelector<HTMLElement>(\r\n        'button[data-test-system-instructions-card], ' +\r\n        'button[aria-label=\"System instructions\"], ' +\r\n        'button.system-instructions-card'\r\n      );\r\n\r\n      if (!sysInstructionsBtn) {\r\n        this.showError('æœªæ‰¾åˆ° System Instructions æŒ‰é’®');\r\n        return;\r\n      }\r\n\r\n      console.log('âœ… æ‰¾åˆ° System Instructions æŒ‰é’®');\r\n\r\n      // 2. ç‚¹å‡»æ‰“å¼€ç•Œé¢\r\n      sysInstructionsBtn.click();\r\n      await this.delay(500);\r\n\r\n      // 3. æŸ¥æ‰¾æ–‡æœ¬æ¡†\r\n      const textarea = document.querySelector<HTMLTextAreaElement>(\r\n        'textarea[aria-label=\"System instructions\"], ' +\r\n        'textarea[placeholder*=\"tone and style\"], ' +\r\n        'textarea.in-run-settings'\r\n      );\r\n\r\n      if (!textarea) {\r\n        this.showError('æœªæ‰¾åˆ°æ–‡æœ¬æ¡†');\r\n        // å°è¯•å…³é—­å¯èƒ½æ‰“å¼€çš„å¯¹è¯æ¡†\r\n        this.closeSystemInstructionsDialog();\r\n        return;\r\n      }\r\n\r\n      console.log('âœ… æ‰¾åˆ°æ–‡æœ¬æ¡†');\r\n\r\n      // 4. æ¸…ç©ºç°æœ‰å†…å®¹\r\n      textarea.value = '';\r\n\r\n      // 5. å¡«å……æ–°å†…å®¹\r\n      textarea.value = content;\r\n\r\n      // 6. è§¦å‘äº‹ä»¶ä»¥ç¡®ä¿ Angular æ£€æµ‹åˆ°å˜åŒ–\r\n      textarea.blur();\r\n      textarea.dispatchEvent(new Event('input', { bubbles: true }));\r\n      textarea.dispatchEvent(new Event('change', { bubbles: true }));\r\n      textarea.dispatchEvent(new Event('blur', { bubbles: true }));\r\n\r\n\r\n      // è§¦å‘ Angular çš„ ngModelChange\r\n      const event = new CustomEvent('input', { bubbles: true, cancelable: true });\r\n      textarea.dispatchEvent(event);\r\n\r\n      console.log('âœ… å†…å®¹å·²å¡«å……');\r\n\r\n      // 7. ç­‰å¾… Angular æ›´æ–°\r\n      await this.delay(800);\r\n\r\n      // 8. å…³é—­å¯¹è¯æ¡†\r\n      this.closeSystemInstructionsDialog();\r\n\r\n      this.showSuccess(`âœ… å·²åº”ç”¨: ${promptName}`);\r\n\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n      console.error('åº”ç”¨æç¤ºè¯å¤±è´¥:', error);\r\n      this.showError(`åº”ç”¨å¤±è´¥ï¼š${errorMessage}`);\r\n    }\r\n  }\r\n\r\n  private closeSystemInstructionsDialog(): void {\r\n    // æŸ¥æ‰¾å…¸å‹å…³é—­æŒ‰é’® - ä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨\r\n    const selectors = [\r\n      'button[data-test-close-button]',\r\n      'button[aria-label=\"Close panel\"]',\r\n      'button[mat-dialog-close]',\r\n      'button[iconname=\"close\"]',\r\n      'button.ms-button-icon[iconname=\"close\"]',\r\n      'button[aria-label=\"Close panel\"][data-test-close-button]'\r\n    ];\r\n\r\n    let closeBtn: HTMLElement | null = null;\r\n\r\n    // å°è¯•æ¯ä¸ªé€‰æ‹©å™¨\r\n    for (const selector of selectors) {\r\n      closeBtn = document.querySelector<HTMLElement>(selector);\r\n      if (closeBtn && closeBtn.offsetParent !== null) {\r\n        console.log(`âœ… æ‰¾åˆ°å…³é—­æŒ‰é’®: ${selector}`);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (closeBtn) {\r\n      // æ£€æŸ¥æŒ‰é’®çŠ¶æ€\r\n      const isVisible = closeBtn.offsetParent !== null;\r\n      const isDisabled = closeBtn.hasAttribute('aria-disabled') && closeBtn.getAttribute('aria-disabled') === 'true';\r\n      const isEnabled = closeBtn.getAttribute('aria-disabled') === 'false' || !closeBtn.hasAttribute('aria-disabled');\r\n\r\n      console.log('å…³é—­æŒ‰é’®çŠ¶æ€:', {\r\n        isVisible,\r\n        isDisabled,\r\n        isEnabled,\r\n        ariaDisabled: closeBtn.getAttribute('aria-disabled'),\r\n        className: closeBtn.className\r\n      });\r\n\r\n      // ç¡®ä¿æŒ‰é’®å¯è§ä¸”å¯ç‚¹å‡»\r\n      if (isVisible && isEnabled) {\r\n        try {\r\n          closeBtn.click();\r\n          console.log('âœ… å·²è‡ªåŠ¨å…³é—­System Instructionsç•Œé¢');\r\n        } catch (error) {\r\n          console.error('ç‚¹å‡»å…³é—­æŒ‰é’®å¤±è´¥:', error);\r\n          // å°è¯•å…¶ä»–æ–¹å¼è§¦å‘ç‚¹å‡»\r\n          const clickEvent = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n          });\r\n          closeBtn.dispatchEvent(clickEvent);\r\n          console.log('âœ… å·²é€šè¿‡äº‹ä»¶è§¦å‘å…³é—­System Instructionsç•Œé¢');\r\n        }\r\n      } else {\r\n        console.warn('âŒ å…³é—­æŒ‰é’®ä¸å¯ç”¨æˆ–å·²ç¦ç”¨', {\r\n          isVisible,\r\n          isDisabled,\r\n          isEnabled\r\n        });\r\n      }\r\n    } else {\r\n      console.warn('âŒ æœªæ‰¾åˆ°å¯ç”¨çš„å…³é—­æŒ‰é’®');\r\n      // è°ƒè¯•ï¼šåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„æŒ‰é’®\r\n      const allButtons = document.querySelectorAll('button');\r\n      console.log('é¡µé¢ä¸Šçš„æ‰€æœ‰æŒ‰é’®:', Array.from(allButtons).map(btn => ({\r\n        tagName: btn.tagName,\r\n        className: btn.className,\r\n        ariaLabel: btn.getAttribute('aria-label'),\r\n        dataTest: btn.getAttribute('data-test-close-button'),\r\n        iconName: btn.getAttribute('iconname'),\r\n        matDialogClose: btn.getAttribute('mat-dialog-close')\r\n      })));\r\n    }\r\n  }\r\n\r\n  private escapeHtml(text: string): string {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n}\r\n\r\nclass ElementPicker {\r\n  private overlay: HTMLElement | null = null;\r\n  private hoveredElement: HTMLElement | null = null;\r\n  private onSelect: (element: HTMLElement) => void;\r\n  private isActive: boolean = false;\r\n\r\n  constructor(onSelect: (element: HTMLElement) => void) {\r\n    this.onSelect = onSelect;\r\n    this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    this.handleClick = this.handleClick.bind(this);\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n  }\r\n\r\n  public start(): void {\r\n    if (this.isActive) return;\r\n    this.isActive = true;\r\n    this.createOverlay();\r\n    document.addEventListener('mousemove', this.handleMouseMove, true);\r\n    document.addEventListener('click', this.handleClick, true);\r\n    document.addEventListener('keydown', this.handleKeyDown, true);\r\n    document.body.style.cursor = 'crosshair';\r\n  }\r\n\r\n  public stop(): void {\r\n    if (!this.isActive) return;\r\n    this.isActive = false;\r\n    this.removeOverlay();\r\n    document.removeEventListener('mousemove', this.handleMouseMove, true);\r\n    document.removeEventListener('click', this.handleClick, true);\r\n    document.removeEventListener('keydown', this.handleKeyDown, true);\r\n    document.body.style.cursor = '';\r\n    this.hoveredElement = null;\r\n  }\r\n\r\n  private createOverlay(): void {\r\n    this.overlay = document.createElement('div');\r\n    this.overlay.id = 'ai-vscode-picker-overlay';\r\n    Object.assign(this.overlay.style, {\r\n      position: 'fixed',\r\n      pointerEvents: 'none',\r\n      zIndex: '1000000',\r\n      border: '2px solid #6c5ce7',\r\n      backgroundColor: 'rgba(108, 92, 231, 0.2)',\r\n      transition: 'all 0.1s ease',\r\n      display: 'none'\r\n    });\r\n    document.body.appendChild(this.overlay);\r\n  }\r\n\r\n  private removeOverlay(): void {\r\n    if (this.overlay) {\r\n      this.overlay.remove();\r\n      this.overlay = null;\r\n    }\r\n  }\r\n\r\n  private handleMouseMove(e: MouseEvent): void {\r\n    const target = e.target as HTMLElement;\r\n    if (!target || target === this.overlay || target.closest('#ai-vscode-panel')) {\r\n      if (this.overlay) this.overlay.style.display = 'none';\r\n      return;\r\n    }\r\n\r\n    this.hoveredElement = target;\r\n    const rect = target.getBoundingClientRect();\r\n\r\n    if (this.overlay) {\r\n      Object.assign(this.overlay.style, {\r\n        display: 'block',\r\n        top: `${rect.top}px`,\r\n        left: `${rect.left}px`,\r\n        width: `${rect.width}px`,\r\n        height: `${rect.height}px`\r\n      });\r\n    }\r\n  }\r\n\r\n  private handleClick(e: MouseEvent): void {\r\n    if (!this.isActive) return;\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (this.hoveredElement) {\r\n      this.onSelect(this.hoveredElement);\r\n    }\r\n    this.stop();\r\n  }\r\n\r\n  private handleKeyDown(e: KeyboardEvent): void {\r\n    if (e.key === 'Escape') {\r\n      this.stop();\r\n    }\r\n  }\r\n\r\n  public static getElementInfo(el: HTMLElement): string {\r\n    const tag = el.tagName.toLowerCase();\r\n    const id = el.id ? `#${el.id}` : '';\r\n    const classes = Array.from(el.classList).map(c => `.${c}`).join('');\r\n\r\n    // è·å–è®¡ç®—æ ·å¼\r\n    const styles = window.getComputedStyle(el);\r\n    const importantStyles = [\r\n      'display', 'position', 'width', 'height',\r\n      'margin', 'padding', 'border',\r\n      'background-color', 'color', 'font-family', 'font-size',\r\n      'flex', 'grid', 'justify-content', 'align-items'\r\n    ];\r\n\r\n    let cssText = 'è®¡ç®—æ ·å¼:\\n';\r\n    importantStyles.forEach(prop => {\r\n      cssText += `  ${prop}: ${styles.getPropertyValue(prop)};\\n`;\r\n    });\r\n\r\n    const html = el.outerHTML.split('>')[0] + '>'; // ä»…è·å–å¼€å§‹æ ‡ç­¾\r\n\r\n    return `å…ƒç´ : ${tag}${id}${classes}\\n\\nHTML: ${html}\\n\\n${cssText}\\nå†…éƒ¨æ–‡æœ¬: ${el.innerText.substring(0, 100)}${el.innerText.length > 100 ? '...' : ''}`;\r\n  }\r\n}\r\n\r\n\r\n// åˆå§‹åŒ–\r\nnew FloatingPanel();\r\n"],"names":["DOMHelper","findLatestCopyButton","perfStart","performance","now","console","group","currentHostname","window","location","hostname","log","Date","toLocaleTimeString","result","includes","this","findPerplexityCopyButton","defaultConfig","DEFAULT_SELECTORS","find","c","name","findButtonWithConfig","findButtonGeneric","error","timeTaken","toFixed","getMemoryUsage","groupEnd","loadConfigs","startTime","time","replyContainers","document","querySelectorAll","timeEnd","length","warn","lastReply","copyBtns","selectedBtn","ariaLabel","getAttribute","dataTestId","text","textContent","trim","substring","allButtons","Array","from","i","button","toLowerCase","config","selector","copyButtonSelector","findAIStudioCopyButton","findClaudeCopyButton","responseContainerSelector","responses","lastResponse","querySelector","buttons","btn","svg","path","d","strategies","fn","icon","closest","item","strategy","selectors","e","getClipboardContent","content","navigator","clipboard","readText","Error","memory","usedJSHeapSize","totalJSHeapSize","makeDraggable","element","initialX","initialY","isDragging","header","style","cursor","addEventListener","target","clientX","offsetLeft","clientY","offsetTop","transition","classList","add","preventDefault","newX","newY","maxX","innerWidth","offsetWidth","maxY","innerHeight","offsetHeight","Math","max","min","left","top","right","bottom","remove","undefined","VisualAnchorManager","injectAnchors","removeAnchors","interactiveTags","elements","filter","el","getComputedStyle","display","visibility","opacity","rect","getBoundingClientRect","width","height","tagName","overlay","createElement","id","overlayId","Object","assign","position","pointerEvents","zIndex","overflow","body","appendChild","anchorMap","Map","counter","forEach","scrollTop","pageYOffset","documentElement","scrollLeft","pageXOffset","box","className","anchorClass","border","boxSizing","label","backgroundColor","color","fontSize","fontWeight","padding","lineHeight","set","setAttribute","getElementById","removeAttribute","ElementPicker","constructor","onSelect","hoveredElement","isActive","handleMouseMove","bind","handleClick","handleKeyDown","start","createOverlay","stop","removeOverlay","removeEventListener","stopPropagation","key","getElementInfo","tag","classes","map","join","styles","cssText","prop","getPropertyValue","outerHTML","split","innerText","panel","statusElement","enabled","dailyCounter","promptButtons","isDebugMode","pathMemory","picker","lastSelectedElement","initialize","checkDebugMode","setupStorageListener","setUIVisibility","visible","search","localStorage","getItem","debugLog","message","args","debugWarn","checkAndInitialize","loadDailyCounter","loadPathMemory","queryConnectionStatus","chrome","runtime","sendMessage","action","response","lastError","connected","updateConnectionStatus","today","toDateString","storage","local","get","lastSaveDate","updateDailyCounter","activeProject","rootPath","storageKey","keys","savePathMemory","onChanged","addListener","changes","area","settings","sync","enabledUrls","showOnAllSites","isUrlEnabled","createPanel","setupMessageListener","reload","some","url","pattern","replace","RegExp","test","innerHTML","sendButton","handleSendClick","createFilesButton","handleCreateFilesClick","patchFilesButton","handlePartialUpdateClick","screenshotElementButton","handleScreenshotElementClick","copyElementButton","handleCopyElementClick","sendScreenshotButton","handleSendScreenshotClick","clonePageButton","handleClonePageClick","closeButton","togglePanel","toggleBtn","promptSection","collapsed","toggle","promptsCollapsed","res","loadPromptButtons","overallStart","delay","handleAIStudioCopy","copyButton","showError","click","filename","generateSmartFilename","showFilenamePreview","sendToVSCode","overallEnd","errorMessage","moreButtons","files","parseFilesFromContent","f","successCount","file","savePath","err","showSuccess","async","handleCaptureWithText","showNotification","contains","info","writeText","then","catch","success","dataUrl","copyToClipboard","additionalText","highlightElement","highlightBox","msg","fetch","blob","data","type","Blob","ClipboardItem","write","memoryUpdated","slices","currentSliceStart","inCodeBlock","lines","charIndex","lineNum","line","startsWith","sliceEnd","push","slice","pathPatterns","detectedPath","match","blockStartMatch","lang","contentStart","index","lastClosingIndex","lastIndexOf","blockContent","fullPath","parts","pop","lowerFilename","memoryKey","k","customSavePath","defaultSavePath","finalSavePath","Promise","resolve","reject","menuButton","date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","getSeconds","sequence","firstSentence","extractFirstSentence","cleanedSentence","cleanSentence","truncateFilename","sentences","sentence","cleaned","removePatterns","maxLength","truncated","lastDash","preview","setTimeout","onMessage","status","statusText","statusDot","notification","ms","promptFiles","createPromptButtons","prompts","p","prompt","escapeHtml","htmlBtn","__promptContent","background","currentTarget","applyPrompt","promptName","sysInstructionsBtn","textarea","closeSystemInstructionsDialog","value","blur","dispatchEvent","Event","bubbles","event","CustomEvent","cancelable","closeBtn","offsetParent","isVisible","isDisabled","hasAttribute","isEnabled","ariaDisabled","clickEvent","MouseEvent","view","dataTest","iconName","matDialogClose","div"],"sourceRoot":""}