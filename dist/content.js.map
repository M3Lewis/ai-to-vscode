{"version":3,"file":"content.js","mappings":"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","sources":["webpack://ai-to-vscode-bridge/./src/utils/dom.ts","webpack://ai-to-vscode-bridge/./src/content.ts"],"sourcesContent":["import { SiteConfig } from '../types';\r\n\r\nexport class DOMHelper {\r\n  private static readonly DEFAULT_SELECTORS: SiteConfig[] = [\r\n    {\r\n      hostname: 'chat.openai.com',\r\n      copyButtonSelector: 'button[aria-label*=\"Copy\"]',\r\n      responseContainerSelector: '[data-message-author-role=\"assistant\"]',\r\n      name: 'ChatGPT'\r\n    },\r\n    {\r\n      hostname: 'claude.ai',\r\n      copyButtonSelector: 'button[data-testid=\"action-bar-copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Claude'\r\n    },\r\n    {\r\n      hostname: 'gemini.google.com',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: '.model-response',\r\n      name: 'Gemini'\r\n    },\r\n    {\r\n      hostname: 'perplexity.ai',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Perplexity'\r\n    },\r\n    {\r\n      hostname: 'aistudio.google.com',\r\n      copyButtonSelector: 'button[mat-menu-item][jslog^=\"282205\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'AI Studio'\r\n    }\r\n  ];\r\n\r\n  public static findLatestCopyButton(): HTMLElement | null {\r\n    const currentHostname = window.location.hostname;\r\n    console.log('ğŸ” æŸ¥æ‰¾COPYæŒ‰é’®ï¼Œå½“å‰åŸŸå:', currentHostname);\r\n\r\n    // é’ˆå¯¹Perplexityä½¿ç”¨ä¸“ç”¨æŸ¥æ‰¾ç­–ç•¥\r\n    if (currentHostname.includes('perplexity.ai')) {\r\n      return this.findPerplexityCopyButton();\r\n    }\r\n\r\n    // å…¶å®ƒç«™ç‚¹ä»ç„¶å¯ä»¥ç”¨é»˜è®¤ç­–ç•¥\r\n    const defaultConfig = this.DEFAULT_SELECTORS.find(c =>\r\n      currentHostname.includes(c.hostname)\r\n    );\r\n\r\n    if (defaultConfig) {\r\n      console.log('âœ… æ‰¾åˆ°é»˜è®¤é…ç½®:', defaultConfig.name);\r\n      const button = this.findButtonWithConfig(defaultConfig);\r\n      if (button) {\r\n        console.log('âœ… ä½¿ç”¨é»˜è®¤é…ç½®æ‰¾åˆ°æŒ‰é’®');\r\n        return button;\r\n      }\r\n    }\r\n\r\n    console.log('ä½¿ç”¨é€šç”¨ç­–ç•¥æŸ¥æ‰¾...');\r\n    return this.findButtonGeneric();\r\n  }\r\n\r\n  public static async loadConfigs(): Promise<void> {\r\n    // ç©ºå®ç°ï¼Œä¿ç•™æ¥å£å…¼å®¹æ€§\r\n  }\r\n\r\n  // æ¨èä¸“ç”¨æ–¹æ³• - Perplexityä¸“ç”¨æŸ¥æ‰¾\r\n  private static findPerplexityCopyButton(): HTMLElement | null {\r\n    console.log('ğŸ” ä½¿ç”¨ Perplexity ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘');\r\n  \r\n    // è¿™é‡ŒæŒ‰ä½ çš„è·¯å¾„ç®€åŒ–ç‰ˆæœ¬\r\n    const replyContainers = document.querySelectorAll(\r\n      'div.py-md.md\\\\:pb-headerHeight.mx-auto.max-w-threadContentWidth > div'\r\n    );\r\n  \r\n    if (replyContainers.length === 0) {\r\n      console.log('âŒ æœªæ‰¾åˆ°å›å¤å®¹å™¨');\r\n      return null;\r\n    }\r\n  \r\n    console.log(`âœ… æ‰¾åˆ° ${replyContainers.length} ä¸ªå›å¤å®¹å™¨`);\r\n  \r\n    // ä¾ç„¶å–æœ€åä¸€ä¸ªå›å¤å®¹å™¨ä½œä¸ºæœ€æ–°å›å¤\r\n    const lastReply = replyContainers[replyContainers.length - 1];\r\n  \r\n    // æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®ï¼Œä¼˜å…ˆå°è¯•å¸¸ç”¨çš„data-testidåŠaria-labelé€‰æ‹©å™¨\r\n    const copyBtns = lastReply.querySelectorAll<HTMLElement>(\r\n      'button[aria-label*=\"Copy\"], button[data-testid*=\"copy\"]'\r\n    );\r\n  \r\n    if (copyBtns.length > 0) {\r\n      console.log(`âœ… åœ¨æœ€æ–°å›å¤ä¸­æ‰¾åˆ° ${copyBtns.length} ä¸ªå¤åˆ¶æŒ‰é’®`);\r\n      return copyBtns[copyBtns.length - 1]; \r\n    }\r\n  \r\n    // è¿›ä¸€æ­¥é€’å½’æŸ¥æ‰¾åŒ…å«â€œcopyâ€å…³é”®è¯çš„æŒ‰é’®\r\n    console.log('âš ï¸ æœªæ‰¾åˆ°æ ‡å‡†å¤åˆ¶æŒ‰é’®ï¼Œå°è¯•é€’å½’æœç´¢...');\r\n    const allButtons = Array.from(lastReply.querySelectorAll<HTMLElement>('button'));\r\n  \r\n    for (const button of allButtons) {\r\n      const ariaLabel = button.getAttribute('aria-label')?.toLowerCase() || '';\r\n      const dataTestId = button.getAttribute('data-testid')?.toLowerCase() || '';\r\n      const text = button.textContent?.toLowerCase() || '';\r\n  \r\n      if (ariaLabel.includes('copy') || dataTestId.includes('copy') || text.includes('copy')) {\r\n        console.log('âœ… é€šè¿‡é€’å½’æœç´¢æ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n        return button;\r\n      }\r\n    }\r\n  \r\n    console.log('âŒ æœªæ‰¾åˆ° Perplexity å¤åˆ¶æŒ‰é’®');\r\n    return null;\r\n  }\r\n  \r\n\r\n  private static findButtonWithConfig(config: SiteConfig): HTMLElement | null {\r\n    const selector = config.copyButtonSelector;\r\n    console.log('å°è¯•é€‰æ‹©å™¨:', selector);\r\n\r\n    // ç‰¹æ®Šå¤„ç†ï¼šAI Studio çš„èœå•æŒ‰é’®\r\n    if (window.location.hostname.includes('aistudio.google.com')) {\r\n      return this.findAIStudioCopyButton();\r\n    }\r\n\r\n    // ç‰¹æ®Šå¤„ç†ï¼šClaude çš„æŒ‰é’®ï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼Œå–æœ€åä¸€ä¸ªï¼‰\r\n    if (window.location.hostname.includes('claude.ai')) {\r\n      return this.findClaudeCopyButton();\r\n    }\r\n\r\n    if (config.responseContainerSelector) {\r\n      const responses = document.querySelectorAll(config.responseContainerSelector);\r\n      console.log('æ‰¾åˆ°', responses.length, 'ä¸ªå›ç­”å®¹å™¨');\r\n      \r\n      if (responses.length > 0) {\r\n        const lastResponse = responses[responses.length - 1];\r\n        const button = lastResponse.querySelector<HTMLElement>(selector);\r\n        if (button) {\r\n          console.log('âœ… åœ¨å®¹å™¨ä¸­æ‰¾åˆ°æŒ‰é’®');\r\n          return button;\r\n        }\r\n      }\r\n    }\r\n\r\n    const buttons = document.querySelectorAll<HTMLElement>(selector);\r\n    console.log('å…¨å±€æ‰¾åˆ°', buttons.length, 'ä¸ªåŒ¹é…æŒ‰é’®');\r\n    \r\n    if (buttons.length > 0) {\r\n      console.log('âœ… è¿”å›æœ€åä¸€ä¸ªæŒ‰é’®');\r\n      return buttons[buttons.length - 1];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¸“é—¨å¤„ç† Claude\r\nprivate static findClaudeCopyButton(): HTMLElement | null {\r\n  console.log('ğŸ” ä½¿ç”¨ Claude ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘');\r\n  \r\n  // æ–¹æ³•1ï¼šé€šè¿‡ data-testid æŸ¥æ‰¾ï¼ˆæœ€å‡†ç¡®ï¼‰\r\n  const buttons = Array.from(document.querySelectorAll<HTMLElement>('button[data-testid=\"action-bar-copy\"]'));\r\n  \r\n  if (buttons.length > 0) {\r\n    console.log(`âœ… æ‰¾åˆ° ${buttons.length} ä¸ª Claude å¤åˆ¶æŒ‰é’®`);\r\n    return buttons[buttons.length - 1];\r\n  }\r\n  \r\n  // âš ï¸ å¤‡ç”¨æ–¹æ¡ˆï¼šé™åˆ¶åœ¨å¯¹è¯åŒºåŸŸå†…æŸ¥æ‰¾\r\n  const conversationArea = document.querySelector('main, [role=\"main\"], .conversation-container');\r\n  if (!conversationArea) {\r\n    console.log('âŒ æœªæ‰¾åˆ°å¯¹è¯åŒºåŸŸ');\r\n    return null;\r\n  }\r\n  \r\n  // åªåœ¨å¯¹è¯åŒºåŸŸå†…æŸ¥æ‰¾æŒ‰é’®\r\n  const allButtons = Array.from(conversationArea.querySelectorAll<HTMLElement>('button'));\r\n  for (let i = allButtons.length - 1; i >= 0; i--) {\r\n    const btn = allButtons[i];\r\n    const svg = btn.querySelector('svg');\r\n    if (svg) {\r\n      const path = svg.querySelector('path');\r\n      if (path) {\r\n        const d = path.getAttribute('d') || '';\r\n        if (d.includes('M10 1.5C11.1097') || d.includes('clipboard')) {\r\n          console.log('âœ… é€šè¿‡ SVG è·¯å¾„æ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®');\r\n          return btn;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  console.log('âŒ æœªæ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®');\r\n  return null;\r\n}\r\n\r\n\r\n  private static findAIStudioCopyButton(): HTMLElement | null {\r\n  console.log('ğŸ” ä½¿ç”¨ AI Studio ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘');\r\n  \r\n  // æ–¹æ³•1ï¼šé€šè¿‡ jslog å±æ€§ç²¾ç¡®æŸ¥æ‰¾\r\n  const buttonByJslog = document.querySelector<HTMLElement>('button[mat-menu-item][jslog^=\"282205\"]');\r\n  if (buttonByJslog) {\r\n    console.log('âœ… é€šè¿‡ jslog=\"282205\" æ‰¾åˆ°æŒ‰é’®');\r\n    return buttonByJslog;\r\n  }\r\n  \r\n  // æ–¹æ³•2ï¼šé€šè¿‡ class \"copy-markdown-button\" æŸ¥æ‰¾\r\n  const iconElement = document.querySelector<HTMLElement>('.copy-markdown-button');\r\n  if (iconElement) {\r\n    const parentButton = iconElement.closest('button[mat-menu-item]');\r\n    if (parentButton) {\r\n      console.log('âœ… é€šè¿‡ .copy-markdown-button class æ‰¾åˆ°æŒ‰é’®');\r\n      return parentButton as HTMLElement;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•3ï¼šæŸ¥æ‰¾åŒ…å« \"Copy as markdown\" æ–‡æœ¬çš„æŒ‰é’®\r\n  const menuItems = Array.from(document.querySelectorAll<HTMLElement>('button[mat-menu-item]'));\r\n  \r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.trim() || '';\r\n    \r\n    if (text === 'Copy as markdown' || text.toLowerCase().includes('copy as markdown')) {\r\n      console.log('âœ… é€šè¿‡æ–‡æœ¬ \"Copy as markdown\" æ‰¾åˆ°æŒ‰é’®');\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•4ï¼šæŸ¥æ‰¾åŒ…å« \"markdown\" çš„æŒ‰é’®\r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.toLowerCase() || '';\r\n    \r\n    if (text.includes('markdown') && text.includes('copy')) {\r\n      console.log('âœ… æ‰¾åˆ°åŒ…å« markdown å’Œ copy çš„æŒ‰é’®:', text);\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•5ï¼šæŸ¥æ‰¾æ‰€æœ‰å¯è§çš„èœå•æŒ‰é’®ä¸­ç¬¬ä¸€ä¸ªåŒ…å«\"copy\"çš„\r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.toLowerCase() || '';\r\n    \r\n    if (text.includes('copy')) {\r\n      console.log('âœ… æ‰¾åˆ°åŒ…å« copy çš„æŒ‰é’®:', text);\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // å¦‚æœèœå•æœªå±•å¼€ï¼Œå°è¯•æ‰¾åˆ°èœå•è§¦å‘æŒ‰é’®\r\n  console.log('âš ï¸ èœå•å¯èƒ½æœªå±•å¼€ï¼Œå°è¯•æŸ¥æ‰¾èœå•æŒ‰é’®');\r\n  const menuButtons = Array.from(document.querySelectorAll<HTMLElement>('button[aria-label*=\"options\"], button[iconname=\"more_vert\"]'));\r\n  \r\n  if (menuButtons.length > 0) {\r\n    console.log('âœ… æ‰¾åˆ°', menuButtons.length, 'ä¸ªèœå•è§¦å‘æŒ‰é’®');\r\n    return menuButtons[menuButtons.length - 1];\r\n  }\r\n  \r\n  console.log('âŒ æœªæ‰¾åˆ°æŒ‰é’®');\r\n  return null;\r\n}\r\n\r\n\r\n  private static findButtonGeneric(): HTMLElement | null {\r\n  console.log('ğŸ” ä½¿ç”¨é€šç”¨ç­–ç•¥...');\r\n  \r\n  const selectors = [\r\n    'button[data-testid*=\"copy\"]',\r\n    'button[aria-label*=\"Copy\" i]',\r\n    'button[aria-label*=\"å¤åˆ¶\" i]',\r\n    'button[title*=\"Copy\" i]',\r\n    'button.copy-button',\r\n    'button.copy-btn',\r\n    '[data-testid*=\"copy\"]'\r\n  ];\r\n\r\n  // æ·»åŠ æ€§èƒ½ä¿æŠ¤ï¼šé™åˆ¶æŸ¥æ‰¾èŒƒå›´\r\n  const searchRoot = document.querySelector('main, [role=\"main\"], #root') || document;\r\n\r\n  for (const selector of selectors) {\r\n    try {\r\n      const buttons = searchRoot.querySelectorAll<HTMLElement>(selector);\r\n      if (buttons.length > 0) {\r\n        console.log(`âœ… é€šç”¨é€‰æ‹©å™¨ \"${selector}\" æ‰¾åˆ° ${buttons.length} ä¸ªæŒ‰é’®`);\r\n        \r\n        // ğŸ”¥ æ€§èƒ½ä¿æŠ¤ï¼šå¦‚æœæŒ‰é’®æ•°é‡å¼‚å¸¸å¤šï¼Œåªæ£€æŸ¥æœ€å10ä¸ª\r\n        if (buttons.length > 100) {\r\n          console.warn(`âš ï¸ æŒ‰é’®æ•°é‡è¿‡å¤š (${buttons.length})ï¼Œåªæ£€æŸ¥æœ€å10ä¸ª`);\r\n          const recentButtons = Array.from(buttons).slice(-10);\r\n          return recentButtons[recentButtons.length - 1];\r\n        }\r\n        \r\n        return buttons[buttons.length - 1];\r\n      }\r\n    } catch (e) {\r\n      continue;\r\n    }\r\n  }\r\n\r\n  console.error('âŒ æ‰€æœ‰ç­–ç•¥éƒ½å¤±è´¥äº†');\r\n  return null;\r\n}\r\n\r\n\r\n  public static async getClipboardContent(): Promise<string> {\r\n    try {\r\n      return await navigator.clipboard.readText();\r\n    } catch (error) {\r\n      throw new Error('æ— æ³•è¯»å–å‰ªè´´æ¿');\r\n    }\r\n  }\r\n\r\n  public static makeDraggable(element: HTMLElement): void {\r\n    let isDragging = false;\r\n    let currentX: number;\r\n    let currentY: number;\r\n    let initialX: number;\r\n    let initialY: number;\r\n\r\n    const header = element.querySelector<HTMLElement>('.panel-header');\r\n    if (!header) return;\r\n\r\n    header.style.cursor = 'move';\r\n\r\n    header.addEventListener('mousedown', (e: MouseEvent) => {\r\n      if ((e.target as HTMLElement).classList.contains('close-btn')) {\r\n        return;\r\n      }\r\n\r\n      isDragging = true;\r\n      initialX = e.clientX - element.offsetLeft;\r\n      initialY = e.clientY - element.offsetTop;\r\n    });\r\n\r\n    document.addEventListener('mousemove', (e: MouseEvent) => {\r\n      if (!isDragging) return;\r\n\r\n      e.preventDefault();\r\n      currentX = e.clientX - initialX;\r\n      currentY = e.clientY - initialY;\r\n\r\n      element.style.left = `${currentX}px`;\r\n      element.style.top = `${currentY}px`;\r\n      element.style.right = 'auto';\r\n      element.style.bottom = 'auto';\r\n    });\r\n\r\n    document.addEventListener('mouseup', () => {\r\n      isDragging = false;\r\n    });\r\n  }\r\n}\r\n","import { DOMHelper } from './utils/dom';\r\nimport { MessageToVSCode, MessageResponse, ConnectionStatus } from './types';\r\n\r\nclass FloatingPanel {\r\n  private panel: HTMLElement | null = null;\r\n  private statusElement: HTMLElement | null = null;\r\n  private enabled: boolean = false;\r\n  private dailyCounter: number = 1;\r\n  private promptButtons: HTMLElement | null = null;\r\n  private isDebugMode: boolean = false;\r\n\r\n  constructor() {\r\n    this.initialize();\r\n    this.checkDebugMode();\r\n  }\r\n\r\n  private checkDebugMode(): void {\r\n    // æ£€æµ‹æ˜¯å¦ä¸ºè°ƒè¯•æ¨¡å¼ï¼ˆå¯ä»¥é€šè¿‡URLå‚æ•°æˆ–localStorageæ§åˆ¶ï¼‰\r\n    this.isDebugMode = \r\n      window.location.search.includes('debug=true') ||\r\n      localStorage.getItem('ai-vscode-debug') === 'true' ||\r\n      window.location.hostname === 'localhost';\r\n  }\r\n\r\n  private debugLog(message: string, ...args: any[]): void {\r\n    if (this.isDebugMode) {\r\n      console.log(message, ...args);\r\n    }\r\n  }\r\n\r\n  private debugWarn(message: string, ...args: any[]): void {\r\n    if (this.isDebugMode) {\r\n      console.warn(message, ...args);\r\n    }\r\n  }\r\n\r\n  private async initialize(): Promise<void> {\r\n    await this.checkAndInitialize();\r\n    await this.loadDailyCounter();\r\n\r\n    // æ–°å¢ï¼šåˆå§‹åŒ–åç«‹å³æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n    this.queryConnectionStatus();\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¸»åŠ¨æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n  private queryConnectionStatus(): void {\r\n    chrome.runtime.sendMessage({ action: 'getConnectionStatus' }, (response) => {\r\n      if (chrome.runtime.lastError) {\r\n        console.error('æŸ¥è¯¢è¿æ¥çŠ¶æ€å¤±è´¥:', chrome.runtime.lastError);\r\n        return;\r\n      }\r\n      \r\n      if (response && response.connected !== undefined) {\r\n        console.log('å½“å‰è¿æ¥çŠ¶æ€:', response.connected ? 'å·²è¿æ¥' : 'æœªè¿æ¥');\r\n        this.updateConnectionStatus(response.connected);\r\n      }\r\n    });\r\n  }\r\n\r\n  private async loadDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    const result = await chrome.storage.local.get(['lastSaveDate', 'dailyCounter']);\r\n    \r\n    if (result.lastSaveDate === today) {\r\n      this.dailyCounter = (result.dailyCounter || 0) + 1;\r\n    } else {\r\n      this.dailyCounter = 1;\r\n    }\r\n  }\r\n\r\n  private async updateDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    await chrome.storage.local.set({\r\n      lastSaveDate: today,\r\n      dailyCounter: this.dailyCounter\r\n    });\r\n    this.dailyCounter++;\r\n  }\r\n\r\n  private async checkAndInitialize(): Promise<void> {\r\n    const result = await chrome.storage.sync.get({\r\n      enabledUrls: [\r\n        'chat.openai.com',\r\n        'claude.ai',\r\n        'gemini.google.com',\r\n        'perplexity.ai'\r\n      ],\r\n      showOnAllSites: false\r\n    });\r\n\r\n    const currentHostname = window.location.hostname;\r\n    const showOnAllSites = result.showOnAllSites;\r\n    const enabledUrls: string[] = result.enabledUrls;\r\n\r\n    if (showOnAllSites || this.isUrlEnabled(currentHostname, enabledUrls)) {\r\n      this.enabled = true;\r\n      this.createPanel();\r\n      this.setupMessageListener();\r\n      console.log('âœ… æ‚¬æµ®çª—å·²å¯ç”¨');\r\n    } else {\r\n      console.log('å½“å‰ç½‘ç«™æœªå¯ç”¨æ‚¬æµ®çª—:', currentHostname);\r\n    }\r\n\r\n    chrome.storage.onChanged.addListener((changes) => {\r\n      if (changes.enabledUrls || changes.showOnAllSites || changes.siteConfigs) {\r\n        window.location.reload();\r\n      }\r\n    });\r\n  }\r\n\r\n  private isUrlEnabled(hostname: string, enabledUrls: string[]): boolean {\r\n    return enabledUrls.some(url => {\r\n      if (url.includes('*')) {\r\n        const pattern = url.replace(/\\*/g, '.*');\r\n        return new RegExp(pattern).test(hostname);\r\n      }\r\n      return hostname.includes(url);\r\n    });\r\n  }\r\n\r\nprivate createPanel(): void {\r\n  this.panel = document.createElement('div');\r\n  this.panel.id = 'ai-vscode-panel';\r\n  \r\n  this.panel.innerHTML = `\r\n    <div class=\"panel-container\">\r\n      <div class=\"panel-header\">\r\n        <span>å‘é€åˆ°VS Code</span>\r\n        <button class=\"close-btn\" id=\"close-panel\">Ã—</button>\r\n      </div>\r\n      <div class=\"filename-preview\" id=\"filename-preview\" style=\"\r\n        font-size: 11px;\r\n        color: #888;\r\n        padding: 6px 8px;\r\n        background: #2d2d2d;\r\n        border-radius: 4px;\r\n        margin-bottom: 8px;\r\n        word-break: break-all;\r\n        display: none;\r\n      \">\r\n        æ–‡ä»¶åé¢„è§ˆ...\r\n      </div>\r\n      <button id=\"send-to-vscode\">å¤åˆ¶å¹¶ä¿å­˜</button>\r\n      <div class=\"prompt-buttons\" id=\"prompt-buttons\" style=\"\r\n        margin-top: 8px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 4px;\r\n      \">\r\n        <!-- æç¤ºè¯æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->\r\n      </div>\r\n      <div class=\"status\" id=\"connection-status\">\r\n        <span class=\"status-dot\"></span>\r\n        <span class=\"status-text\">æœªè¿æ¥</span>\r\n      </div>\r\n    </div>\r\n  `;\r\n  \r\n  document.body.appendChild(this.panel);\r\n  DOMHelper.makeDraggable(this.panel);\r\n  \r\n  const sendButton = document.getElementById('send-to-vscode');\r\n  sendButton?.addEventListener('click', () => this.handleSendClick());\r\n\r\n  const closeButton = document.getElementById('close-panel');\r\n  closeButton?.addEventListener('click', () => this.togglePanel());\r\n  \r\n  this.statusElement = document.getElementById('connection-status');\r\n  this.promptButtons = document.getElementById('prompt-buttons');\r\n  \r\n  // åŠ è½½æç¤ºè¯æŒ‰é’®\r\n  this.loadPromptButtons();\r\n}\r\n\r\n\r\n\r\n  private togglePanel(): void {\r\n    if (this.panel) {\r\n      this.panel.style.display = \r\n        this.panel.style.display === 'none' ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  private async handleSendClick(): Promise<void> {\r\n  try {\r\n    this.debugLog('ğŸš€ å¼€å§‹å‘é€æµç¨‹...');\r\n    \r\n    // ç‰¹æ®Šå¤„ç†ï¼šAI Studio éœ€è¦å…ˆæ‰“å¼€èœå•\r\n    if (window.location.hostname.includes('aistudio.google.com')) {\r\n      await this.handleAIStudioCopy();\r\n      return;\r\n    }\r\n    \r\n    const copyButton = DOMHelper.findLatestCopyButton();\r\n    \r\n    if (!copyButton) {\r\n      console.error('âŒ æœªæ‰¾åˆ°COPYæŒ‰é’®');\r\n      this.showError('æœªæ‰¾åˆ°COPYæŒ‰é’®ï¼Œè¯·åœ¨è®¾ç½®ä¸­é…ç½®é€‰æ‹©å™¨');\r\n      return;\r\n    }\r\n\r\n    this.debugLog('âœ… æ‰¾åˆ°æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    copyButton.click();\r\n    \r\n    await this.delay(300);\r\n    \r\n    const content = await DOMHelper.getClipboardContent();\r\n    \r\n    if (!content || content.trim().length === 0) {\r\n      this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n      return;\r\n    }\r\n\r\n    this.debugLog('âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:', content.length);\r\n    \r\n    // å†…å®¹é•¿åº¦é™åˆ¶æ£€æŸ¥\r\n    if (content.length > 50000) { // 50KBé™åˆ¶\r\n      this.showError('å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œæ— æ³•ç›´æ¥å¤åˆ¶ï¼Œè¯·åˆ†æ‰¹æ“ä½œï¼');\r\n      return;\r\n    }\r\n    \r\n    const filename = this.generateSmartFilename(content);\r\n    this.debugLog('ğŸ“ ç”Ÿæˆæ–‡ä»¶å:', filename);\r\n    \r\n    this.showFilenamePreview(filename);\r\n    this.sendToVSCode(content, filename);\r\n    await this.updateDailyCounter();\r\n    \r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n    console.error('å‘é€å¤±è´¥:', error);\r\n    this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n  }\r\n}\r\n\r\n// æ–°å¢ï¼šä¸“é—¨å¤„ç† AI Studio çš„å¤åˆ¶\r\nprivate async handleAIStudioCopy(): Promise<void> {\r\n  try {\r\n    this.debugLog('ğŸ” AI Studio ç‰¹æ®Šå¤„ç†ï¼šæŸ¥æ‰¾èœå•æŒ‰é’®');\r\n    \r\n    // 1. æŸ¥æ‰¾æ‰€æœ‰çš„ more_vert æŒ‰é’®\r\n    const moreButtons = Array.from(document.querySelectorAll<HTMLElement>(\r\n  'button[aria-label*=\"options\"], ' +\r\n  'button[iconname=\"more_vert\"], ' +\r\n  'button[aria-label*=\"Open options\"], ' +\r\n  'ms-chat-turn-options button'\r\n));\r\n    \r\n    if (moreButtons.length === 0) {\r\n      this.showError('æœªæ‰¾åˆ°èœå•æŒ‰é’®');\r\n      return;\r\n    }\r\n    \r\n    // è·å–æœ€åä¸€ä¸ªï¼ˆæœ€æ–°çš„å›ç­”ï¼‰\r\n    const menuButton = moreButtons[moreButtons.length - 1];\r\n    this.debugLog('âœ… æ‰¾åˆ°èœå•æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    \r\n    // 2. ç‚¹å‡»èœå•æŒ‰é’®å±•å¼€èœå•\r\n    menuButton.click();\r\n    this.debugLog('âœ… èœå•å·²å±•å¼€ï¼Œç­‰å¾…åŠ è½½...');\r\n    \r\n    // 3. ç­‰å¾…èœå•å±•å¼€\r\n    await this.delay(500);\r\n    \r\n    // 4. æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®\r\n    const copyButton = DOMHelper.findLatestCopyButton();\r\n    \r\n    if (!copyButton) {\r\n      console.error('âŒ èœå•å±•å¼€åä»æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n      this.showError('æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n      // å…³é—­èœå•\r\n      menuButton.click();\r\n      return;\r\n    }\r\n    \r\n    this.debugLog('âœ… æ‰¾åˆ°å¤åˆ¶æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    \r\n    // 5. ç‚¹å‡»å¤åˆ¶æŒ‰é’®\r\n    copyButton.click();\r\n    \r\n    // 6. ç­‰å¾…å¤åˆ¶å®Œæˆ\r\n    await this.delay(300);\r\n    \r\n    // 7. è¯»å–å‰ªè´´æ¿å†…å®¹\r\n    const content = await DOMHelper.getClipboardContent();\r\n    \r\n    if (!content || content.trim().length === 0) {\r\n      this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n      return;\r\n    }\r\n\r\n    this.debugLog('âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:', content.length);\r\n    \r\n    // å†…å®¹é•¿åº¦é™åˆ¶æ£€æŸ¥\r\n    if (content.length > 50000) { // 50KBé™åˆ¶\r\n      this.showError('å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œæ— æ³•ç›´æ¥å¤åˆ¶ï¼Œè¯·åˆ†æ‰¹æ“ä½œï¼');\r\n      return;\r\n    }\r\n    \r\n    // 8. ç”Ÿæˆæ–‡ä»¶åå¹¶ä¿å­˜\r\n    const filename = this.generateSmartFilename(content);\r\n    this.debugLog('ğŸ“ ç”Ÿæˆæ–‡ä»¶å:', filename);\r\n    \r\n    this.showFilenamePreview(filename);\r\n    this.sendToVSCode(content, filename);\r\n    await this.updateDailyCounter();\r\n    \r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n    console.error('AI Studio å¤åˆ¶å¤±è´¥:', error);\r\n    this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n  }\r\n}\r\n\r\n\r\n  private generateSmartFilename(content: string): string {\r\n    const now = new Date();\r\n    \r\n    // æ ¼å¼åŒ–æ—¥æœŸ: YYYYMMDD\r\n    const date = now.getFullYear() + \r\n                 String(now.getMonth() + 1).padStart(2, '0') + \r\n                 String(now.getDate()).padStart(2, '0');\r\n    \r\n    // æ ¼å¼åŒ–æ—¶é—´: HHmmss\r\n    const time = String(now.getHours()).padStart(2, '0') + \r\n                 String(now.getMinutes()).padStart(2, '0') + \r\n                 String(now.getSeconds()).padStart(2, '0');\r\n    \r\n    // åºå·: 001, 002, 003...\r\n    const sequence = String(this.dailyCounter).padStart(3, '0');\r\n    \r\n    // æå–ç¬¬ä¸€å¥è¯\r\n    const firstSentence = this.extractFirstSentence(content);\r\n    \r\n    // æ¸…ç†ç¬¬ä¸€å¥è¯\r\n    const cleanedSentence = this.cleanSentence(firstSentence);\r\n    \r\n    // é™åˆ¶é•¿åº¦ï¼ˆé˜²æ­¢æ–‡ä»¶åè¿‡é•¿ï¼‰\r\n    const shortSentence = this.truncateFilename(cleanedSentence, 50);\r\n    \r\n    // ç»„åˆæ–‡ä»¶å\r\n    return `${date}-${time}-${sequence}-${shortSentence}.md`;\r\n  }\r\n\r\n  private extractFirstSentence(content: string): string {\r\n    // ç§»é™¤Markdownæ ‡è®°\r\n    let text = content.trim();\r\n    text = text.replace(/^#+\\s+/gm, ''); // ç§»é™¤æ ‡é¢˜ç¬¦å·\r\n    text = text.replace(/\\*\\*(.+?)\\*\\*/g, '$1'); // ç§»é™¤åŠ ç²—\r\n    text = text.replace(/\\*(.+?)\\*/g, '$1'); // ç§»é™¤æ–œä½“\r\n    text = text.replace(/`(.+?)`/g, '$1'); // ç§»é™¤ä»£ç æ ‡è®°\r\n    text = text.replace(/\\[(.+?)\\]\\(.+?\\)/g, '$1'); // ç§»é™¤é“¾æ¥ï¼Œä¿ç•™æ–‡æœ¬\r\n    \r\n    // åˆ†å‰²æˆå¥å­ï¼ˆæŒ‰å¥å·ã€é—®å·ã€æ„Ÿå¹å·ã€æ¢è¡Œï¼‰\r\n    const sentences = text.split(/[ã€‚.!?ï¼ï¼Ÿ\\n]/);\r\n    \r\n    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰å®é™…å†…å®¹çš„å¥å­\r\n    for (const sentence of sentences) {\r\n      const cleaned = sentence.trim();\r\n      if (cleaned.length > 5) { // è‡³å°‘5ä¸ªå­—ç¬¦\r\n        return cleaned;\r\n      }\r\n    }\r\n    \r\n    // å¦‚æœæ²¡æ‰¾åˆ°åˆé€‚çš„å¥å­ï¼Œå–å‰50ä¸ªå­—ç¬¦\r\n    return text.substring(0, 50).trim();\r\n  }\r\n\r\n  private cleanSentence(sentence: string): string {\r\n    // ç§»é™¤å¸¸è§çš„å¼€åœºç™½\r\n    const removePatterns = [\r\n      /^å¥½çš„[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å½“ç„¶[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æˆ‘ä¼š[^\\s]{0,5}/i,\r\n      /^æˆ‘å°†[^\\s]{0,5}/i,\r\n      /^è®©æˆ‘[^\\s]{0,5}/i,\r\n      /^æ˜ç™½[äº†å—]?[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ”¶åˆ°[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å¥½[çš„å•¦][ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^OK[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^äº†è§£[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ²¡é—®é¢˜[ï¼!ï¼Œ,ã€‚.\\s]*/i\r\n    ];\r\n    \r\n    let cleaned = sentence;\r\n    for (const pattern of removePatterns) {\r\n      cleaned = cleaned.replace(pattern, '');\r\n    }\r\n    \r\n    // ç§»é™¤ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼ï¼ˆæ–‡ä»¶åä¸å…è®¸çš„å­—ç¬¦ï¼‰\r\n    cleaned = cleaned.replace(/[<>:\"/\\\\|?*\\x00-\\x1F]/g, '');\r\n    \r\n    // ç§»é™¤å¤šä½™ç©ºæ ¼\r\n    cleaned = cleaned.replace(/\\s+/g, '-');\r\n    \r\n    // ç§»é™¤å¼€å¤´å’Œç»“å°¾çš„è¿å­—ç¬¦\r\n    cleaned = cleaned.replace(/^-+|-+$/g, '');\r\n    \r\n    return cleaned;\r\n  }\r\n\r\n  private truncateFilename(text: string, maxLength: number): string {\r\n    if (text.length <= maxLength) {\r\n      return text;\r\n    }\r\n    \r\n    // åœ¨maxLengthå¤„æˆªæ–­ï¼Œä½†å°è¯•åœ¨åˆé€‚çš„ä½ç½®ï¼ˆå¦‚è¿å­—ç¬¦å¤„ï¼‰\r\n    let truncated = text.substring(0, maxLength);\r\n    const lastDash = truncated.lastIndexOf('-');\r\n    \r\n    if (lastDash > maxLength * 0.7) {\r\n      // å¦‚æœåœ¨å70%æœ‰è¿å­—ç¬¦ï¼Œåœ¨é‚£é‡Œæˆªæ–­\r\n      truncated = truncated.substring(0, lastDash);\r\n    }\r\n    \r\n    return truncated;\r\n  }\r\n\r\n  private showFilenamePreview(filename: string): void {\r\n    const preview = document.getElementById('filename-preview');\r\n    if (preview) {\r\n      preview.textContent = `ğŸ“„ ${filename}`;\r\n      preview.style.display = 'block';\r\n      \r\n      // 3ç§’åéšè—\r\n      setTimeout(() => {\r\n        preview.style.display = 'none';\r\n      }, 3000);\r\n    }\r\n  }\r\n\r\n  private sendToVSCode(content: string, filename: string): void {\r\n  const message: MessageToVSCode = {\r\n    action: 'sendToVSCode',\r\n    content,\r\n    filename\r\n  };\r\n  \r\n  console.log('ğŸ“¤ å‘é€åˆ°VS Code:', filename);\r\n  \r\n  // è®¾ç½®è¶…æ—¶\r\n  const timeout = setTimeout(() => {\r\n    this.showError('å‘é€è¶…æ—¶ï¼Œè¯·æ£€æŸ¥VS Codeæ˜¯å¦å·²å¯åŠ¨WebSocketæœåŠ¡');\r\n  }, 5000);\r\n  \r\n  chrome.runtime.sendMessage(message, (response: MessageResponse) => {\r\n    clearTimeout(timeout);\r\n    \r\n    if (chrome.runtime.lastError) {\r\n      console.error('æ‰©å±•é€šä¿¡å¤±è´¥:', chrome.runtime.lastError);\r\n      this.showError('æ‰©å±•é€šä¿¡å¤±è´¥ï¼Œè¯·é‡æ–°åŠ è½½é¡µé¢');\r\n      return;\r\n    }\r\n    \r\n    if (response && response.success) {\r\n      this.showSuccess(`âœ… å·²ä¿å­˜: ${filename}`);\r\n    } else {\r\n      const errorMsg = response?.error || 'æœªçŸ¥é”™è¯¯';\r\n      this.showError(`å‘é€å¤±è´¥ï¼š${errorMsg}`);\r\n    }\r\n  });\r\n}\r\n\r\n\r\n  private setupMessageListener(): void {\r\n    chrome.runtime.onMessage.addListener((message: ConnectionStatus) => {\r\n      if (message.type === 'connectionStatus') {\r\n        this.updateConnectionStatus(message.status === 'connected');\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateConnectionStatus(connected: boolean): void {\r\n    if (!this.statusElement) return;\r\n    \r\n    const statusText = this.statusElement.querySelector('.status-text');\r\n    const statusDot = this.statusElement.querySelector('.status-dot');\r\n    \r\n    if (connected) {\r\n      this.statusElement.classList.add('connected');\r\n      if (statusText) statusText.textContent = 'å·²è¿æ¥';\r\n      if (statusDot) statusDot.classList.add('active');\r\n    } else {\r\n      this.statusElement.classList.remove('connected');\r\n      if (statusText) statusText.textContent = 'æœªè¿æ¥';\r\n      if (statusDot) statusDot.classList.remove('active');\r\n    }\r\n  }\r\n\r\n  private showSuccess(message: string): void {\r\n    this.showNotification(message, 'success');\r\n  }\r\n\r\n  private showError(message: string): void {\r\n    this.showNotification(message, 'error');\r\n  }\r\n\r\n  private showNotification(message: string, type: 'success' | 'error'): void {\r\n    const notification = document.createElement('div');\r\n    notification.className = `notification ${type}`;\r\n    notification.textContent = message;\r\n    document.body.appendChild(notification);\r\n    \r\n    setTimeout(() => notification.remove(), 3000);\r\n  }\r\n\r\n  private delay(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // æç¤ºè¯ç›¸å…³æ–¹æ³•\r\n  private async loadPromptButtons(): Promise<void> {\r\n    try {\r\n      const result = await chrome.storage.sync.get(['promptFiles']);\r\n      const promptFiles = result.promptFiles || [];\r\n      \r\n      this.createPromptButtons(promptFiles);\r\n    } catch (error) {\r\n      console.error('åŠ è½½æç¤ºè¯å¤±è´¥:', error);\r\n    }\r\n  }\r\n\r\n  private createPromptButtons(prompts: any[]): void {\r\n    if (!this.promptButtons || prompts.length === 0) return;\r\n\r\n    this.promptButtons.innerHTML = prompts\r\n      .filter(p => p.enabled)\r\n      .map(prompt => `\r\n        <button \r\n          class=\"prompt-btn\" \r\n          data-prompt-id=\"${prompt.id}\"\r\n          data-prompt-name=\"${this.escapeHtml(prompt.name)}\"\r\n          style=\"\r\n            padding: 8px 12px;\r\n            background: #6c5ce7;\r\n            color: white;\r\n            border: none;\r\n            border-radius: 4px;\r\n            cursor: pointer;\r\n            font-size: 12px;\r\n            transition: all 0.2s;\r\n            text-align: left;\r\n          \"\r\n          onmouseover=\"this.style.background='#5f4dd1'\"\r\n          onmouseout=\"this.style.background='#6c5ce7'\"\r\n        >\r\n          ğŸ“ ${this.escapeHtml(prompt.name)}\r\n        </button>\r\n      `)\r\n      .join('');\r\n\r\n    // ä¿å­˜æç¤ºè¯å†…å®¹åˆ°æŒ‰é’®çš„è‡ªå®šä¹‰å±æ€§\r\n    const buttons = this.promptButtons.querySelectorAll('.prompt-btn');\r\n    buttons.forEach((btn, index) => {\r\n      (btn as any).__promptContent = prompts.filter(p => p.enabled)[index].path;\r\n      \r\n      btn.addEventListener('click', (e) => {\r\n        const target = e.currentTarget as any;\r\n        const content = target.__promptContent;\r\n        const name = target.getAttribute('data-prompt-name');\r\n        if (content) {\r\n          this.applyPrompt(content, name || '');\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private async applyPrompt(content: string, promptName: string): Promise<void> {\r\n    try {\r\n      console.log('ğŸ“ å¼€å§‹åº”ç”¨æç¤ºè¯:', promptName);\r\n      \r\n      if (!content || content.trim().length === 0) {\r\n        this.showError('æç¤ºè¯å†…å®¹ä¸ºç©º');\r\n        return;\r\n      }\r\n      \r\n      console.log('âœ… å†…å®¹é•¿åº¦:', content.length);\r\n      \r\n      // 1. æŸ¥æ‰¾ System Instructions æŒ‰é’®\r\n      const sysInstructionsBtn = document.querySelector<HTMLElement>(\r\n        'button[data-test-system-instructions-card], ' +\r\n        'button[aria-label=\"System instructions\"], ' +\r\n        'button.system-instructions-card'\r\n      );\r\n      \r\n      if (!sysInstructionsBtn) {\r\n        this.showError('æœªæ‰¾åˆ° System Instructions æŒ‰é’®');\r\n        return;\r\n      }\r\n      \r\n      console.log('âœ… æ‰¾åˆ° System Instructions æŒ‰é’®');\r\n      \r\n      // 2. ç‚¹å‡»æ‰“å¼€ç•Œé¢\r\n      sysInstructionsBtn.click();\r\n      await this.delay(500);\r\n      \r\n      // 3. æŸ¥æ‰¾æ–‡æœ¬æ¡†\r\n      const textarea = document.querySelector<HTMLTextAreaElement>(\r\n        'textarea[aria-label=\"System instructions\"], ' +\r\n        'textarea[placeholder*=\"tone and style\"], ' +\r\n        'textarea.in-run-settings'\r\n      );\r\n      \r\n      if (!textarea) {\r\n        this.showError('æœªæ‰¾åˆ°æ–‡æœ¬æ¡†');\r\n        // å°è¯•å…³é—­å¯èƒ½æ‰“å¼€çš„å¯¹è¯æ¡†\r\n        this.closeSystemInstructionsDialog();\r\n        return;\r\n      }\r\n      \r\n      console.log('âœ… æ‰¾åˆ°æ–‡æœ¬æ¡†');\r\n      \r\n      // 4. æ¸…ç©ºç°æœ‰å†…å®¹\r\n      textarea.value = '';\r\n      \r\n      // 5. å¡«å……æ–°å†…å®¹\r\n      textarea.value = content;\r\n      \r\n      // 6. è§¦å‘äº‹ä»¶ä»¥ç¡®ä¿ Angular æ£€æµ‹åˆ°å˜åŒ–\r\n      textarea.blur();\r\n      textarea.dispatchEvent(new Event('input', { bubbles: true }));\r\n      textarea.dispatchEvent(new Event('change', { bubbles: true }));\r\n      textarea.dispatchEvent(new Event('blur', { bubbles: true }));\r\n      \r\n\r\n      // è§¦å‘ Angular çš„ ngModelChange\r\n      const event = new CustomEvent('input', { bubbles: true, cancelable: true });\r\n      textarea.dispatchEvent(event);\r\n      \r\n      console.log('âœ… å†…å®¹å·²å¡«å……');\r\n      \r\n      // 7. ç­‰å¾… Angular æ›´æ–°\r\n      await this.delay(800);\r\n      \r\n      // 8. å…³é—­å¯¹è¯æ¡†\r\n      this.closeSystemInstructionsDialog();\r\n      \r\n      this.showSuccess(`âœ… å·²åº”ç”¨: ${promptName}`);\r\n      \r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n      console.error('åº”ç”¨æç¤ºè¯å¤±è´¥:', error);\r\n      this.showError(`åº”ç”¨å¤±è´¥ï¼š${errorMessage}`);\r\n    }\r\n  }\r\n\r\n  private closeSystemInstructionsDialog(): void {\r\n    // æŸ¥æ‰¾å…¸å‹å…³é—­æŒ‰é’® - ä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨\r\n    const selectors = [\r\n      'button[data-test-close-button]',\r\n      'button[aria-label=\"Close panel\"]',\r\n      'button[mat-dialog-close]',\r\n      'button[iconname=\"close\"]',\r\n      'button.ms-button-icon[iconname=\"close\"]',\r\n      'button[aria-label=\"Close panel\"][data-test-close-button]'\r\n    ];\r\n    \r\n    let closeBtn: HTMLElement | null = null;\r\n    \r\n    // å°è¯•æ¯ä¸ªé€‰æ‹©å™¨\r\n    for (const selector of selectors) {\r\n      closeBtn = document.querySelector<HTMLElement>(selector);\r\n      if (closeBtn && closeBtn.offsetParent !== null) {\r\n        console.log(`âœ… æ‰¾åˆ°å…³é—­æŒ‰é’®: ${selector}`);\r\n        break;\r\n      }\r\n    }\r\n    \r\n    if (closeBtn) {\r\n      // æ£€æŸ¥æŒ‰é’®çŠ¶æ€\r\n      const isVisible = closeBtn.offsetParent !== null;\r\n      const isDisabled = closeBtn.hasAttribute('aria-disabled') && closeBtn.getAttribute('aria-disabled') === 'true';\r\n      const isEnabled = closeBtn.getAttribute('aria-disabled') === 'false' || !closeBtn.hasAttribute('aria-disabled');\r\n      \r\n      console.log('å…³é—­æŒ‰é’®çŠ¶æ€:', {\r\n        isVisible,\r\n        isDisabled,\r\n        isEnabled,\r\n        ariaDisabled: closeBtn.getAttribute('aria-disabled'),\r\n        className: closeBtn.className\r\n      });\r\n      \r\n      // ç¡®ä¿æŒ‰é’®å¯è§ä¸”å¯ç‚¹å‡»\r\n      if (isVisible && isEnabled) {\r\n        try {\r\n          closeBtn.click();\r\n          console.log('âœ… å·²è‡ªåŠ¨å…³é—­System Instructionsç•Œé¢');\r\n        } catch (error) {\r\n          console.error('ç‚¹å‡»å…³é—­æŒ‰é’®å¤±è´¥:', error);\r\n          // å°è¯•å…¶ä»–æ–¹å¼è§¦å‘ç‚¹å‡»\r\n          const clickEvent = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n          });\r\n          closeBtn.dispatchEvent(clickEvent);\r\n          console.log('âœ… å·²é€šè¿‡äº‹ä»¶è§¦å‘å…³é—­System Instructionsç•Œé¢');\r\n        }\r\n      } else {\r\n        console.warn('âŒ å…³é—­æŒ‰é’®ä¸å¯ç”¨æˆ–å·²ç¦ç”¨', {\r\n          isVisible,\r\n          isDisabled,\r\n          isEnabled\r\n        });\r\n      }\r\n    } else {\r\n      console.warn('âŒ æœªæ‰¾åˆ°å¯ç”¨çš„å…³é—­æŒ‰é’®');\r\n      // è°ƒè¯•ï¼šåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„æŒ‰é’®\r\n      const allButtons = document.querySelectorAll('button');\r\n      console.log('é¡µé¢ä¸Šçš„æ‰€æœ‰æŒ‰é’®:', Array.from(allButtons).map(btn => ({\r\n        tagName: btn.tagName,\r\n        className: btn.className,\r\n        ariaLabel: btn.getAttribute('aria-label'),\r\n        dataTest: btn.getAttribute('data-test-close-button'),\r\n        iconName: btn.getAttribute('iconname'),\r\n        matDialogClose: btn.getAttribute('mat-dialog-close')\r\n      })));\r\n    }\r\n  }\r\n\r\n  private escapeHtml(text: string): string {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n}\r\n\r\n// åˆå§‹åŒ–\r\nnew FloatingPanel();\r\n"],"names":["DOMHelper","findLatestCopyButton","currentHostname","window","location","hostname","console","log","includes","this","findPerplexityCopyButton","defaultConfig","DEFAULT_SELECTORS","find","c","name","button","findButtonWithConfig","findButtonGeneric","loadConfigs","replyContainers","document","querySelectorAll","length","lastReply","copyBtns","allButtons","Array","from","ariaLabel","getAttribute","toLowerCase","dataTestId","text","textContent","config","selector","copyButtonSelector","findAIStudioCopyButton","findClaudeCopyButton","responseContainerSelector","responses","querySelector","buttons","conversationArea","i","btn","svg","path","d","buttonByJslog","iconElement","parentButton","closest","menuItems","item","trim","menuButtons","selectors","searchRoot","warn","recentButtons","slice","e","error","getClipboardContent","navigator","clipboard","readText","Error","makeDraggable","element","currentX","currentY","initialX","initialY","isDragging","header","style","cursor","addEventListener","target","classList","contains","clientX","offsetLeft","clientY","offsetTop","preventDefault","left","top","right","bottom","undefined","constructor","panel","statusElement","enabled","dailyCounter","promptButtons","isDebugMode","initialize","checkDebugMode","search","localStorage","getItem","debugLog","message","args","debugWarn","checkAndInitialize","loadDailyCounter","queryConnectionStatus","chrome","runtime","sendMessage","action","response","lastError","connected","updateConnectionStatus","today","Date","toDateString","result","storage","local","get","lastSaveDate","updateDailyCounter","set","sync","enabledUrls","showOnAllSites","isUrlEnabled","createPanel","setupMessageListener","onChanged","addListener","changes","siteConfigs","reload","some","url","pattern","replace","RegExp","test","createElement","id","innerHTML","body","appendChild","sendButton","getElementById","handleSendClick","closeButton","togglePanel","loadPromptButtons","display","handleAIStudioCopy","copyButton","showError","click","delay","content","filename","generateSmartFilename","showFilenamePreview","sendToVSCode","errorMessage","moreButtons","menuButton","now","date","getFullYear","String","getMonth","padStart","getDate","time","getHours","getMinutes","getSeconds","sequence","firstSentence","extractFirstSentence","cleanedSentence","cleanSentence","truncateFilename","sentences","split","sentence","cleaned","substring","removePatterns","maxLength","truncated","lastDash","lastIndexOf","preview","setTimeout","timeout","clearTimeout","success","showSuccess","errorMsg","onMessage","type","status","statusText","statusDot","add","remove","showNotification","notification","className","ms","Promise","resolve","promptFiles","createPromptButtons","prompts","filter","p","map","prompt","escapeHtml","join","forEach","index","__promptContent","currentTarget","applyPrompt","promptName","sysInstructionsBtn","textarea","closeSystemInstructionsDialog","value","blur","dispatchEvent","Event","bubbles","event","CustomEvent","cancelable","closeBtn","offsetParent","isVisible","isDisabled","hasAttribute","isEnabled","ariaDisabled","clickEvent","MouseEvent","view","tagName","dataTest","iconName","matDialogClose","div"],"sourceRoot":""}