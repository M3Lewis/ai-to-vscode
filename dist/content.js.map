{"version":3,"file":"content.js","mappings":"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","sources":["webpack://ai-to-vscode-bridge/./src/utils/dom.ts","webpack://ai-to-vscode-bridge/./src/content.ts"],"sourcesContent":["import { SiteConfig } from '../types';\r\n\r\nexport class DOMHelper {\r\n  private static readonly DEFAULT_SELECTORS: SiteConfig[] = [\r\n    {\r\n      hostname: 'chat.openai.com',\r\n      copyButtonSelector: 'button[aria-label*=\"Copy\"]',\r\n      responseContainerSelector: '[data-message-author-role=\"assistant\"]',\r\n      name: 'ChatGPT'\r\n    },\r\n    {\r\n      hostname: 'claude.ai',\r\n      copyButtonSelector: 'button[data-testid=\"action-bar-copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Claude'\r\n    },\r\n    {\r\n      hostname: 'gemini.google.com',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: '.model-response',\r\n      name: 'Gemini'\r\n    },\r\n    {\r\n      hostname: 'perplexity.ai',\r\n      copyButtonSelector: 'button[aria-label=\"Copy\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'Perplexity'\r\n    },\r\n    {\r\n      hostname: 'aistudio.google.com',\r\n      copyButtonSelector: 'button[mat-menu-item][jslog^=\"282205\"]',\r\n      responseContainerSelector: undefined,\r\n      name: 'AI Studio'\r\n    }\r\n  ];\r\n\r\n  public static findLatestCopyButton(): HTMLElement | null {\r\n    const currentHostname = window.location.hostname;\r\n    console.log('ğŸ” æŸ¥æ‰¾COPYæŒ‰é’®ï¼Œå½“å‰åŸŸå:', currentHostname);\r\n\r\n    const defaultConfig = this.DEFAULT_SELECTORS.find(c =>\r\n      currentHostname.includes(c.hostname)\r\n    );\r\n\r\n    if (defaultConfig) {\r\n      console.log('âœ… æ‰¾åˆ°é»˜è®¤é…ç½®:', defaultConfig.name);\r\n      const button = this.findButtonWithConfig(defaultConfig);\r\n      if (button) {\r\n        console.log('âœ… ä½¿ç”¨é»˜è®¤é…ç½®æ‰¾åˆ°æŒ‰é’®');\r\n        return button;\r\n      }\r\n    }\r\n\r\n    console.log('ä½¿ç”¨é€šç”¨ç­–ç•¥æŸ¥æ‰¾...');\r\n    return this.findButtonGeneric();\r\n  }\r\n\r\n  public static async loadConfigs(): Promise<void> {\r\n    // ç©ºå®ç°ï¼Œä¿ç•™æ¥å£å…¼å®¹æ€§\r\n  }\r\n\r\n  private static findButtonWithConfig(config: SiteConfig): HTMLElement | null {\r\n    const selector = config.copyButtonSelector;\r\n    console.log('å°è¯•é€‰æ‹©å™¨:', selector);\r\n\r\n    // ç‰¹æ®Šå¤„ç†ï¼šAI Studio çš„èœå•æŒ‰é’®\r\n    if (window.location.hostname.includes('aistudio.google.com')) {\r\n      return this.findAIStudioCopyButton();\r\n    }\r\n\r\n    // ç‰¹æ®Šå¤„ç†ï¼šClaude çš„æŒ‰é’®ï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼Œå–æœ€åä¸€ä¸ªï¼‰\r\n    if (window.location.hostname.includes('claude.ai')) {\r\n      return this.findClaudeCopyButton();\r\n    }\r\n\r\n    if (config.responseContainerSelector) {\r\n      const responses = document.querySelectorAll(config.responseContainerSelector);\r\n      console.log('æ‰¾åˆ°', responses.length, 'ä¸ªå›ç­”å®¹å™¨');\r\n      \r\n      if (responses.length > 0) {\r\n        const lastResponse = responses[responses.length - 1];\r\n        const button = lastResponse.querySelector<HTMLElement>(selector);\r\n        if (button) {\r\n          console.log('âœ… åœ¨å®¹å™¨ä¸­æ‰¾åˆ°æŒ‰é’®');\r\n          return button;\r\n        }\r\n      }\r\n    }\r\n\r\n    const buttons = document.querySelectorAll<HTMLElement>(selector);\r\n    console.log('å…¨å±€æ‰¾åˆ°', buttons.length, 'ä¸ªåŒ¹é…æŒ‰é’®');\r\n    \r\n    if (buttons.length > 0) {\r\n      console.log('âœ… è¿”å›æœ€åä¸€ä¸ªæŒ‰é’®');\r\n      return buttons[buttons.length - 1];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¸“é—¨å¤„ç† Claude\r\n  private static findClaudeCopyButton(): HTMLElement | null {\r\n    console.log('ğŸ” ä½¿ç”¨ Claude ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘');\r\n    \r\n    // æ–¹æ³•1ï¼šé€šè¿‡ data-testid æŸ¥æ‰¾ï¼ˆæœ€å‡†ç¡®ï¼‰\r\n    const buttons = Array.from(document.querySelectorAll<HTMLElement>('button[data-testid=\"action-bar-copy\"]'));\r\n    \r\n    if (buttons.length > 0) {\r\n      console.log(`âœ… æ‰¾åˆ° ${buttons.length} ä¸ª Claude å¤åˆ¶æŒ‰é’®`);\r\n      // è¿”å›æœ€åä¸€ä¸ªï¼ˆæœ€æ–°çš„å›ç­”ï¼‰\r\n      return buttons[buttons.length - 1];\r\n    }\r\n    \r\n    // æ–¹æ³•2ï¼šé€šè¿‡ SVG è·¯å¾„æŸ¥æ‰¾ï¼ˆå¤åˆ¶å›¾æ ‡çš„ç‰¹å¾ï¼‰\r\n    const allButtons = Array.from(document.querySelectorAll<HTMLElement>('button'));\r\n    for (let i = allButtons.length - 1; i >= 0; i--) {\r\n      const btn = allButtons[i];\r\n      const svg = btn.querySelector('svg');\r\n      if (svg) {\r\n        const path = svg.querySelector('path');\r\n        if (path) {\r\n          const d = path.getAttribute('d') || '';\r\n          // Claude å¤åˆ¶æŒ‰é’®çš„ SVG path åŒ…å«ç‰¹å®šçš„è·¯å¾„\r\n          if (d.includes('M10 1.5C11.1097') || d.includes('clipboard')) {\r\n            console.log('âœ… é€šè¿‡ SVG è·¯å¾„æ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®');\r\n            return btn;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    console.log('âŒ æœªæ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®');\r\n    return null;\r\n  }\r\n\r\n  private static findAIStudioCopyButton(): HTMLElement | null {\r\n  console.log('ğŸ” ä½¿ç”¨ AI Studio ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘');\r\n  \r\n  // æ–¹æ³•1ï¼šé€šè¿‡ jslog å±æ€§ç²¾ç¡®æŸ¥æ‰¾\r\n  const buttonByJslog = document.querySelector<HTMLElement>('button[mat-menu-item][jslog^=\"282205\"]');\r\n  if (buttonByJslog) {\r\n    console.log('âœ… é€šè¿‡ jslog=\"282205\" æ‰¾åˆ°æŒ‰é’®');\r\n    return buttonByJslog;\r\n  }\r\n  \r\n  // æ–¹æ³•2ï¼šé€šè¿‡ class \"copy-markdown-button\" æŸ¥æ‰¾\r\n  const iconElement = document.querySelector<HTMLElement>('.copy-markdown-button');\r\n  if (iconElement) {\r\n    const parentButton = iconElement.closest('button[mat-menu-item]');\r\n    if (parentButton) {\r\n      console.log('âœ… é€šè¿‡ .copy-markdown-button class æ‰¾åˆ°æŒ‰é’®');\r\n      return parentButton as HTMLElement;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•3ï¼šæŸ¥æ‰¾åŒ…å« \"Copy as markdown\" æ–‡æœ¬çš„æŒ‰é’®\r\n  const menuItems = Array.from(document.querySelectorAll<HTMLElement>('button[mat-menu-item]'));\r\n  \r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.trim() || '';\r\n    \r\n    if (text === 'Copy as markdown' || text.toLowerCase().includes('copy as markdown')) {\r\n      console.log('âœ… é€šè¿‡æ–‡æœ¬ \"Copy as markdown\" æ‰¾åˆ°æŒ‰é’®');\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•4ï¼šæŸ¥æ‰¾åŒ…å« \"markdown\" çš„æŒ‰é’®\r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.toLowerCase() || '';\r\n    \r\n    if (text.includes('markdown') && text.includes('copy')) {\r\n      console.log('âœ… æ‰¾åˆ°åŒ…å« markdown å’Œ copy çš„æŒ‰é’®:', text);\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // æ–¹æ³•5ï¼šæŸ¥æ‰¾æ‰€æœ‰å¯è§çš„èœå•æŒ‰é’®ä¸­ç¬¬ä¸€ä¸ªåŒ…å«\"copy\"çš„\r\n  for (const item of menuItems) {\r\n    const text = item.textContent?.toLowerCase() || '';\r\n    \r\n    if (text.includes('copy')) {\r\n      console.log('âœ… æ‰¾åˆ°åŒ…å« copy çš„æŒ‰é’®:', text);\r\n      return item;\r\n    }\r\n  }\r\n  \r\n  // å¦‚æœèœå•æœªå±•å¼€ï¼Œå°è¯•æ‰¾åˆ°èœå•è§¦å‘æŒ‰é’®\r\n  console.log('âš ï¸ èœå•å¯èƒ½æœªå±•å¼€ï¼Œå°è¯•æŸ¥æ‰¾èœå•æŒ‰é’®');\r\n  const menuButtons = Array.from(document.querySelectorAll<HTMLElement>('button[aria-label*=\"options\"], button[iconname=\"more_vert\"]'));\r\n  \r\n  if (menuButtons.length > 0) {\r\n    console.log('âœ… æ‰¾åˆ°', menuButtons.length, 'ä¸ªèœå•è§¦å‘æŒ‰é’®');\r\n    return menuButtons[menuButtons.length - 1];\r\n  }\r\n  \r\n  console.log('âŒ æœªæ‰¾åˆ°æŒ‰é’®');\r\n  return null;\r\n}\r\n\r\n\r\n  private static findButtonGeneric(): HTMLElement | null {\r\n    console.log('ğŸ” ä½¿ç”¨é€šç”¨ç­–ç•¥...');\r\n    \r\n    const selectors = [\r\n      'button[data-testid*=\"copy\"]', // æ–°å¢ï¼šä¼˜å…ˆæŸ¥æ‰¾ data-testid\r\n      'button[aria-label*=\"Copy\" i]',\r\n      'button[aria-label*=\"å¤åˆ¶\" i]',\r\n      'button[title*=\"Copy\" i]',\r\n      'button.copy-button',\r\n      'button.copy-btn',\r\n      '[data-testid*=\"copy\"]'\r\n    ];\r\n\r\n    for (const selector of selectors) {\r\n      try {\r\n        const buttons = document.querySelectorAll<HTMLElement>(selector);\r\n        if (buttons.length > 0) {\r\n          console.log(`âœ… é€šç”¨é€‰æ‹©å™¨ \"${selector}\" æ‰¾åˆ° ${buttons.length} ä¸ªæŒ‰é’®`);\r\n          return buttons[buttons.length - 1];\r\n        }\r\n      } catch (e) {\r\n        continue;\r\n      }\r\n    }\r\n\r\n    console.error('âŒ æ‰€æœ‰ç­–ç•¥éƒ½å¤±è´¥äº†');\r\n    return null;\r\n  }\r\n\r\n  public static async getClipboardContent(): Promise<string> {\r\n    try {\r\n      return await navigator.clipboard.readText();\r\n    } catch (error) {\r\n      throw new Error('æ— æ³•è¯»å–å‰ªè´´æ¿');\r\n    }\r\n  }\r\n\r\n  public static makeDraggable(element: HTMLElement): void {\r\n    let isDragging = false;\r\n    let currentX: number;\r\n    let currentY: number;\r\n    let initialX: number;\r\n    let initialY: number;\r\n\r\n    const header = element.querySelector<HTMLElement>('.panel-header');\r\n    if (!header) return;\r\n\r\n    header.style.cursor = 'move';\r\n\r\n    header.addEventListener('mousedown', (e: MouseEvent) => {\r\n      if ((e.target as HTMLElement).classList.contains('close-btn')) {\r\n        return;\r\n      }\r\n\r\n      isDragging = true;\r\n      initialX = e.clientX - element.offsetLeft;\r\n      initialY = e.clientY - element.offsetTop;\r\n    });\r\n\r\n    document.addEventListener('mousemove', (e: MouseEvent) => {\r\n      if (!isDragging) return;\r\n\r\n      e.preventDefault();\r\n      currentX = e.clientX - initialX;\r\n      currentY = e.clientY - initialY;\r\n\r\n      element.style.left = `${currentX}px`;\r\n      element.style.top = `${currentY}px`;\r\n      element.style.right = 'auto';\r\n      element.style.bottom = 'auto';\r\n    });\r\n\r\n    document.addEventListener('mouseup', () => {\r\n      isDragging = false;\r\n    });\r\n  }\r\n}\r\n","import { DOMHelper } from './utils/dom';\r\nimport { MessageToVSCode, MessageResponse, ConnectionStatus } from './types';\r\n\r\nclass FloatingPanel {\r\n  private panel: HTMLElement | null = null;\r\n  private statusElement: HTMLElement | null = null;\r\n  private enabled: boolean = false;\r\n  private dailyCounter: number = 1;\r\n\r\n  constructor() {\r\n    this.initialize();\r\n\r\n  }\r\n\r\n  private async initialize(): Promise<void> {\r\n    await this.checkAndInitialize();\r\n    await this.loadDailyCounter();\r\n\r\n    // æ–°å¢ï¼šåˆå§‹åŒ–åç«‹å³æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n    this.queryConnectionStatus();\r\n  }\r\n\r\n  // æ–°å¢ï¼šä¸»åŠ¨æŸ¥è¯¢è¿æ¥çŠ¶æ€\r\n  private queryConnectionStatus(): void {\r\n    chrome.runtime.sendMessage({ action: 'getConnectionStatus' }, (response) => {\r\n      if (chrome.runtime.lastError) {\r\n        console.error('æŸ¥è¯¢è¿æ¥çŠ¶æ€å¤±è´¥:', chrome.runtime.lastError);\r\n        return;\r\n      }\r\n      \r\n      if (response && response.connected !== undefined) {\r\n        console.log('å½“å‰è¿æ¥çŠ¶æ€:', response.connected ? 'å·²è¿æ¥' : 'æœªè¿æ¥');\r\n        this.updateConnectionStatus(response.connected);\r\n      }\r\n    });\r\n  }\r\n\r\n  private async loadDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    const result = await chrome.storage.local.get(['lastSaveDate', 'dailyCounter']);\r\n    \r\n    if (result.lastSaveDate === today) {\r\n      this.dailyCounter = (result.dailyCounter || 0) + 1;\r\n    } else {\r\n      this.dailyCounter = 1;\r\n    }\r\n  }\r\n\r\n  private async updateDailyCounter(): Promise<void> {\r\n    const today = new Date().toDateString();\r\n    await chrome.storage.local.set({\r\n      lastSaveDate: today,\r\n      dailyCounter: this.dailyCounter\r\n    });\r\n    this.dailyCounter++;\r\n  }\r\n\r\n  private async checkAndInitialize(): Promise<void> {\r\n    const result = await chrome.storage.sync.get({\r\n      enabledUrls: [\r\n        'chat.openai.com',\r\n        'claude.ai',\r\n        'gemini.google.com',\r\n        'perplexity.ai'\r\n      ],\r\n      showOnAllSites: false\r\n    });\r\n\r\n    const currentHostname = window.location.hostname;\r\n    const showOnAllSites = result.showOnAllSites;\r\n    const enabledUrls: string[] = result.enabledUrls;\r\n\r\n    if (showOnAllSites || this.isUrlEnabled(currentHostname, enabledUrls)) {\r\n      this.enabled = true;\r\n      this.createPanel();\r\n      this.setupMessageListener();\r\n      console.log('âœ… æ‚¬æµ®çª—å·²å¯ç”¨');\r\n    } else {\r\n      console.log('å½“å‰ç½‘ç«™æœªå¯ç”¨æ‚¬æµ®çª—:', currentHostname);\r\n    }\r\n\r\n    chrome.storage.onChanged.addListener((changes) => {\r\n      if (changes.enabledUrls || changes.showOnAllSites || changes.siteConfigs) {\r\n        window.location.reload();\r\n      }\r\n    });\r\n  }\r\n\r\n  private isUrlEnabled(hostname: string, enabledUrls: string[]): boolean {\r\n    return enabledUrls.some(url => {\r\n      if (url.includes('*')) {\r\n        const pattern = url.replace(/\\*/g, '.*');\r\n        return new RegExp(pattern).test(hostname);\r\n      }\r\n      return hostname.includes(url);\r\n    });\r\n  }\r\n\r\nprivate createPanel(): void {\r\n  this.panel = document.createElement('div');\r\n  this.panel.id = 'ai-vscode-panel';\r\n  \r\n  this.panel.innerHTML = `\r\n    <div class=\"panel-container\">\r\n      <div class=\"panel-header\">\r\n        <span>å‘é€åˆ°VS Code</span>\r\n        <button class=\"close-btn\" id=\"close-panel\">Ã—</button>\r\n      </div>\r\n      <div class=\"filename-preview\" id=\"filename-preview\" style=\"\r\n        font-size: 11px;\r\n        color: #888;\r\n        padding: 6px 8px;\r\n        background: #2d2d2d;\r\n        border-radius: 4px;\r\n        margin-bottom: 8px;\r\n        word-break: break-all;\r\n        display: none;\r\n      \">\r\n        æ–‡ä»¶åé¢„è§ˆ...\r\n      </div>\r\n      <button id=\"send-to-vscode\">å¤åˆ¶å¹¶ä¿å­˜</button>\r\n      <div class=\"status\" id=\"connection-status\">\r\n        <span class=\"status-dot\"></span>\r\n        <span class=\"status-text\">æœªè¿æ¥</span>\r\n      </div>\r\n    </div>\r\n  `;\r\n  \r\n  document.body.appendChild(this.panel);\r\n  DOMHelper.makeDraggable(this.panel);\r\n  \r\n  const sendButton = document.getElementById('send-to-vscode');\r\n  sendButton?.addEventListener('click', () => this.handleSendClick());\r\n\r\n  const closeButton = document.getElementById('close-panel');\r\n  closeButton?.addEventListener('click', () => this.togglePanel());\r\n  \r\n  this.statusElement = document.getElementById('connection-status');\r\n}\r\n\r\n\r\n\r\n  private togglePanel(): void {\r\n    if (this.panel) {\r\n      this.panel.style.display = \r\n        this.panel.style.display === 'none' ? 'block' : 'none';\r\n    }\r\n  }\r\n\r\n  private async handleSendClick(): Promise<void> {\r\n  try {\r\n    console.log('ğŸš€ å¼€å§‹å‘é€æµç¨‹...');\r\n    \r\n    // ç‰¹æ®Šå¤„ç†ï¼šAI Studio éœ€è¦å…ˆæ‰“å¼€èœå•\r\n    if (window.location.hostname.includes('aistudio.google.com')) {\r\n      await this.handleAIStudioCopy();\r\n      return;\r\n    }\r\n    \r\n    const copyButton = DOMHelper.findLatestCopyButton();\r\n    \r\n    if (!copyButton) {\r\n      console.error('âŒ æœªæ‰¾åˆ°COPYæŒ‰é’®');\r\n      this.showError('æœªæ‰¾åˆ°COPYæŒ‰é’®ï¼Œè¯·åœ¨è®¾ç½®ä¸­é…ç½®é€‰æ‹©å™¨');\r\n      return;\r\n    }\r\n\r\n    console.log('âœ… æ‰¾åˆ°æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    copyButton.click();\r\n    \r\n    await this.delay(300);\r\n    \r\n    const content = await DOMHelper.getClipboardContent();\r\n    \r\n    if (!content || content.trim().length === 0) {\r\n      this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n      return;\r\n    }\r\n\r\n    console.log('âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:', content.length);\r\n    \r\n    const filename = this.generateSmartFilename(content);\r\n    console.log('ğŸ“ ç”Ÿæˆæ–‡ä»¶å:', filename);\r\n    \r\n    this.showFilenamePreview(filename);\r\n    this.sendToVSCode(content, filename);\r\n    await this.updateDailyCounter();\r\n    \r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n    console.error('å‘é€å¤±è´¥:', error);\r\n    this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n  }\r\n}\r\n\r\n// æ–°å¢ï¼šä¸“é—¨å¤„ç† AI Studio çš„å¤åˆ¶\r\nprivate async handleAIStudioCopy(): Promise<void> {\r\n  try {\r\n    console.log('ğŸ” AI Studio ç‰¹æ®Šå¤„ç†ï¼šæŸ¥æ‰¾èœå•æŒ‰é’®');\r\n    \r\n    // 1. æŸ¥æ‰¾æ‰€æœ‰çš„ more_vert æŒ‰é’®\r\n    const moreButtons = Array.from(document.querySelectorAll<HTMLElement>(\r\n  'button[aria-label*=\"options\"], ' +\r\n  'button[iconname=\"more_vert\"], ' +\r\n  'button[aria-label*=\"Open options\"], ' +\r\n  'ms-chat-turn-options button'\r\n));\r\n    \r\n    if (moreButtons.length === 0) {\r\n      this.showError('æœªæ‰¾åˆ°èœå•æŒ‰é’®');\r\n      return;\r\n    }\r\n    \r\n    // è·å–æœ€åä¸€ä¸ªï¼ˆæœ€æ–°çš„å›ç­”ï¼‰\r\n    const menuButton = moreButtons[moreButtons.length - 1];\r\n    console.log('âœ… æ‰¾åˆ°èœå•æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    \r\n    // 2. ç‚¹å‡»èœå•æŒ‰é’®å±•å¼€èœå•\r\n    menuButton.click();\r\n    console.log('âœ… èœå•å·²å±•å¼€ï¼Œç­‰å¾…åŠ è½½...');\r\n    \r\n    // 3. ç­‰å¾…èœå•å±•å¼€\r\n    await this.delay(500);\r\n    \r\n    // 4. æŸ¥æ‰¾å¤åˆ¶æŒ‰é’®\r\n    const copyButton = DOMHelper.findLatestCopyButton();\r\n    \r\n    if (!copyButton) {\r\n      console.error('âŒ èœå•å±•å¼€åä»æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n      this.showError('æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®');\r\n      // å…³é—­èœå•\r\n      menuButton.click();\r\n      return;\r\n    }\r\n    \r\n    console.log('âœ… æ‰¾åˆ°å¤åˆ¶æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»');\r\n    \r\n    // 5. ç‚¹å‡»å¤åˆ¶æŒ‰é’®\r\n    copyButton.click();\r\n    \r\n    // 6. ç­‰å¾…å¤åˆ¶å®Œæˆ\r\n    await this.delay(300);\r\n    \r\n    // 7. è¯»å–å‰ªè´´æ¿å†…å®¹\r\n    const content = await DOMHelper.getClipboardContent();\r\n    \r\n    if (!content || content.trim().length === 0) {\r\n      this.showError('å‰ªè´´æ¿å†…å®¹ä¸ºç©º');\r\n      return;\r\n    }\r\n\r\n    console.log('âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:', content.length);\r\n    \r\n    // 8. ç”Ÿæˆæ–‡ä»¶åå¹¶ä¿å­˜\r\n    const filename = this.generateSmartFilename(content);\r\n    console.log('ğŸ“ ç”Ÿæˆæ–‡ä»¶å:', filename);\r\n    \r\n    this.showFilenamePreview(filename);\r\n    this.sendToVSCode(content, filename);\r\n    await this.updateDailyCounter();\r\n    \r\n  } catch (error) {\r\n    const errorMessage = error instanceof Error ? error.message : 'æœªçŸ¥é”™è¯¯';\r\n    console.error('AI Studio å¤åˆ¶å¤±è´¥:', error);\r\n    this.showError(`æ“ä½œå¤±è´¥ï¼š${errorMessage}`);\r\n  }\r\n}\r\n\r\n\r\n  private generateSmartFilename(content: string): string {\r\n    const now = new Date();\r\n    \r\n    // æ ¼å¼åŒ–æ—¥æœŸ: YYYYMMDD\r\n    const date = now.getFullYear() + \r\n                 String(now.getMonth() + 1).padStart(2, '0') + \r\n                 String(now.getDate()).padStart(2, '0');\r\n    \r\n    // æ ¼å¼åŒ–æ—¶é—´: HHmmss\r\n    const time = String(now.getHours()).padStart(2, '0') + \r\n                 String(now.getMinutes()).padStart(2, '0') + \r\n                 String(now.getSeconds()).padStart(2, '0');\r\n    \r\n    // åºå·: 001, 002, 003...\r\n    const sequence = String(this.dailyCounter).padStart(3, '0');\r\n    \r\n    // æå–ç¬¬ä¸€å¥è¯\r\n    const firstSentence = this.extractFirstSentence(content);\r\n    \r\n    // æ¸…ç†ç¬¬ä¸€å¥è¯\r\n    const cleanedSentence = this.cleanSentence(firstSentence);\r\n    \r\n    // é™åˆ¶é•¿åº¦ï¼ˆé˜²æ­¢æ–‡ä»¶åè¿‡é•¿ï¼‰\r\n    const shortSentence = this.truncateFilename(cleanedSentence, 50);\r\n    \r\n    // ç»„åˆæ–‡ä»¶å\r\n    return `${date}-${time}-${sequence}-${shortSentence}.md`;\r\n  }\r\n\r\n  private extractFirstSentence(content: string): string {\r\n    // ç§»é™¤Markdownæ ‡è®°\r\n    let text = content.trim();\r\n    text = text.replace(/^#+\\s+/gm, ''); // ç§»é™¤æ ‡é¢˜ç¬¦å·\r\n    text = text.replace(/\\*\\*(.+?)\\*\\*/g, '$1'); // ç§»é™¤åŠ ç²—\r\n    text = text.replace(/\\*(.+?)\\*/g, '$1'); // ç§»é™¤æ–œä½“\r\n    text = text.replace(/`(.+?)`/g, '$1'); // ç§»é™¤ä»£ç æ ‡è®°\r\n    text = text.replace(/\\[(.+?)\\]\\(.+?\\)/g, '$1'); // ç§»é™¤é“¾æ¥ï¼Œä¿ç•™æ–‡æœ¬\r\n    \r\n    // åˆ†å‰²æˆå¥å­ï¼ˆæŒ‰å¥å·ã€é—®å·ã€æ„Ÿå¹å·ã€æ¢è¡Œï¼‰\r\n    const sentences = text.split(/[ã€‚.!?ï¼ï¼Ÿ\\n]/);\r\n    \r\n    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰å®é™…å†…å®¹çš„å¥å­\r\n    for (const sentence of sentences) {\r\n      const cleaned = sentence.trim();\r\n      if (cleaned.length > 5) { // è‡³å°‘5ä¸ªå­—ç¬¦\r\n        return cleaned;\r\n      }\r\n    }\r\n    \r\n    // å¦‚æœæ²¡æ‰¾åˆ°åˆé€‚çš„å¥å­ï¼Œå–å‰50ä¸ªå­—ç¬¦\r\n    return text.substring(0, 50).trim();\r\n  }\r\n\r\n  private cleanSentence(sentence: string): string {\r\n    // ç§»é™¤å¸¸è§çš„å¼€åœºç™½\r\n    const removePatterns = [\r\n      /^å¥½çš„[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å½“ç„¶[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æˆ‘ä¼š[^\\s]{0,5}/i,\r\n      /^æˆ‘å°†[^\\s]{0,5}/i,\r\n      /^è®©æˆ‘[^\\s]{0,5}/i,\r\n      /^æ˜ç™½[äº†å—]?[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ”¶åˆ°[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^å¥½[çš„å•¦][ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^OK[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^äº†è§£[ï¼!ï¼Œ,ã€‚.\\s]*/i,\r\n      /^æ²¡é—®é¢˜[ï¼!ï¼Œ,ã€‚.\\s]*/i\r\n    ];\r\n    \r\n    let cleaned = sentence;\r\n    for (const pattern of removePatterns) {\r\n      cleaned = cleaned.replace(pattern, '');\r\n    }\r\n    \r\n    // ç§»é™¤ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼ï¼ˆæ–‡ä»¶åä¸å…è®¸çš„å­—ç¬¦ï¼‰\r\n    cleaned = cleaned.replace(/[<>:\"/\\\\|?*\\x00-\\x1F]/g, '');\r\n    \r\n    // ç§»é™¤å¤šä½™ç©ºæ ¼\r\n    cleaned = cleaned.replace(/\\s+/g, '-');\r\n    \r\n    // ç§»é™¤å¼€å¤´å’Œç»“å°¾çš„è¿å­—ç¬¦\r\n    cleaned = cleaned.replace(/^-+|-+$/g, '');\r\n    \r\n    return cleaned;\r\n  }\r\n\r\n  private truncateFilename(text: string, maxLength: number): string {\r\n    if (text.length <= maxLength) {\r\n      return text;\r\n    }\r\n    \r\n    // åœ¨maxLengthå¤„æˆªæ–­ï¼Œä½†å°è¯•åœ¨åˆé€‚çš„ä½ç½®ï¼ˆå¦‚è¿å­—ç¬¦å¤„ï¼‰\r\n    let truncated = text.substring(0, maxLength);\r\n    const lastDash = truncated.lastIndexOf('-');\r\n    \r\n    if (lastDash > maxLength * 0.7) {\r\n      // å¦‚æœåœ¨å70%æœ‰è¿å­—ç¬¦ï¼Œåœ¨é‚£é‡Œæˆªæ–­\r\n      truncated = truncated.substring(0, lastDash);\r\n    }\r\n    \r\n    return truncated;\r\n  }\r\n\r\n  private showFilenamePreview(filename: string): void {\r\n    const preview = document.getElementById('filename-preview');\r\n    if (preview) {\r\n      preview.textContent = `ğŸ“„ ${filename}`;\r\n      preview.style.display = 'block';\r\n      \r\n      // 3ç§’åéšè—\r\n      setTimeout(() => {\r\n        preview.style.display = 'none';\r\n      }, 3000);\r\n    }\r\n  }\r\n\r\n  private sendToVSCode(content: string, filename: string): void {\r\n  const message: MessageToVSCode = {\r\n    action: 'sendToVSCode',\r\n    content,\r\n    filename\r\n  };\r\n  \r\n  console.log('ğŸ“¤ å‘é€åˆ°VS Code:', filename);\r\n  \r\n  // è®¾ç½®è¶…æ—¶\r\n  const timeout = setTimeout(() => {\r\n    this.showError('å‘é€è¶…æ—¶ï¼Œè¯·æ£€æŸ¥VS Codeæ˜¯å¦å·²å¯åŠ¨WebSocketæœåŠ¡');\r\n  }, 5000);\r\n  \r\n  chrome.runtime.sendMessage(message, (response: MessageResponse) => {\r\n    clearTimeout(timeout);\r\n    \r\n    if (chrome.runtime.lastError) {\r\n      console.error('æ‰©å±•é€šä¿¡å¤±è´¥:', chrome.runtime.lastError);\r\n      this.showError('æ‰©å±•é€šä¿¡å¤±è´¥ï¼Œè¯·é‡æ–°åŠ è½½é¡µé¢');\r\n      return;\r\n    }\r\n    \r\n    if (response && response.success) {\r\n      this.showSuccess(`âœ… å·²ä¿å­˜: ${filename}`);\r\n    } else {\r\n      const errorMsg = response?.error || 'æœªçŸ¥é”™è¯¯';\r\n      this.showError(`å‘é€å¤±è´¥ï¼š${errorMsg}`);\r\n    }\r\n  });\r\n}\r\n\r\n\r\n  private setupMessageListener(): void {\r\n    chrome.runtime.onMessage.addListener((message: ConnectionStatus) => {\r\n      if (message.type === 'connectionStatus') {\r\n        this.updateConnectionStatus(message.status === 'connected');\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateConnectionStatus(connected: boolean): void {\r\n    if (!this.statusElement) return;\r\n    \r\n    const statusText = this.statusElement.querySelector('.status-text');\r\n    const statusDot = this.statusElement.querySelector('.status-dot');\r\n    \r\n    if (connected) {\r\n      this.statusElement.classList.add('connected');\r\n      if (statusText) statusText.textContent = 'å·²è¿æ¥';\r\n      if (statusDot) statusDot.classList.add('active');\r\n    } else {\r\n      this.statusElement.classList.remove('connected');\r\n      if (statusText) statusText.textContent = 'æœªè¿æ¥';\r\n      if (statusDot) statusDot.classList.remove('active');\r\n    }\r\n  }\r\n\r\n  private showSuccess(message: string): void {\r\n    this.showNotification(message, 'success');\r\n  }\r\n\r\n  private showError(message: string): void {\r\n    this.showNotification(message, 'error');\r\n  }\r\n\r\n  private showNotification(message: string, type: 'success' | 'error'): void {\r\n    const notification = document.createElement('div');\r\n    notification.className = `notification ${type}`;\r\n    notification.textContent = message;\r\n    document.body.appendChild(notification);\r\n    \r\n    setTimeout(() => notification.remove(), 3000);\r\n  }\r\n\r\n  private delay(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n}\r\n\r\n// åˆå§‹åŒ–\r\nnew FloatingPanel();\r\n"],"names":["DOMHelper","findLatestCopyButton","currentHostname","window","location","hostname","console","log","defaultConfig","this","DEFAULT_SELECTORS","find","c","includes","name","button","findButtonWithConfig","findButtonGeneric","loadConfigs","config","selector","copyButtonSelector","findAIStudioCopyButton","findClaudeCopyButton","responseContainerSelector","responses","document","querySelectorAll","length","querySelector","buttons","Array","from","allButtons","i","btn","svg","path","d","getAttribute","buttonByJslog","iconElement","parentButton","closest","menuItems","item","text","textContent","trim","toLowerCase","menuButtons","selectors","e","error","getClipboardContent","navigator","clipboard","readText","Error","makeDraggable","element","currentX","currentY","initialX","initialY","isDragging","header","style","cursor","addEventListener","target","classList","contains","clientX","offsetLeft","clientY","offsetTop","preventDefault","left","top","right","bottom","undefined","constructor","panel","statusElement","enabled","dailyCounter","initialize","checkAndInitialize","loadDailyCounter","queryConnectionStatus","chrome","runtime","sendMessage","action","response","lastError","connected","updateConnectionStatus","today","Date","toDateString","result","storage","local","get","lastSaveDate","updateDailyCounter","set","sync","enabledUrls","showOnAllSites","isUrlEnabled","createPanel","setupMessageListener","onChanged","addListener","changes","siteConfigs","reload","some","url","pattern","replace","RegExp","test","createElement","id","innerHTML","body","appendChild","sendButton","getElementById","handleSendClick","closeButton","togglePanel","display","handleAIStudioCopy","copyButton","showError","click","delay","content","filename","generateSmartFilename","showFilenamePreview","sendToVSCode","errorMessage","message","moreButtons","menuButton","now","date","getFullYear","String","getMonth","padStart","getDate","time","getHours","getMinutes","getSeconds","sequence","firstSentence","extractFirstSentence","cleanedSentence","cleanSentence","truncateFilename","sentences","split","sentence","cleaned","substring","removePatterns","maxLength","truncated","lastDash","lastIndexOf","preview","setTimeout","timeout","clearTimeout","success","showSuccess","errorMsg","onMessage","type","status","statusText","statusDot","add","remove","showNotification","notification","className","ms","Promise","resolve"],"sourceRoot":""}