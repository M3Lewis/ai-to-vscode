{"version":3,"file":"popup.js","mappings":"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","sources":["webpack://ai-to-vscode-bridge/./src/popup.ts"],"sourcesContent":["interface SiteConfig {\r\n  hostname: string;\r\n  copyButtonSelector: string;\r\n  responseContainerSelector?: string;\r\n  name?: string;\r\n}\r\n\r\ninterface PromptFile {\r\n  id: string;\r\n  name: string;      // ÊòæÁ§∫ÂêçÁß∞\r\n  path: string;      // Â≠òÂÇ®Êñá‰ª∂ÂÜÖÂÆπÔºàËÄå‰∏çÊòØË∑ØÂæÑÔºâ\r\n  enabled: boolean;  // ÊòØÂê¶ÂêØÁî®\r\n}\r\n\r\ninterface Settings {\r\n  port: number;\r\n  enabledUrls: string[];\r\n  showOnAllSites: boolean;\r\n  siteConfigs: SiteConfig[];\r\n  promptFiles?: PromptFile[];  // ÊèêÁ§∫ËØçÊñá‰ª∂ÂàóË°®\r\n  savePath?: string;\r\n}\r\n\r\n// ‰øÆÊîπÂéüÊù•ÁöÑ ButtonCandidate Êé•Âè£ÔºåÂéªÊéâ element Â±ûÊÄß\r\ninterface ButtonCandidate {\r\n  selector: string;\r\n  label: string;\r\n  ariaLabel: string;\r\n  text: string;\r\n  score: number;\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöËçâÁ®øÊé•Âè£\r\ninterface DraftSettings {\r\n  port?: number;\r\n  enabledUrls?: string[];\r\n  showOnAllSites?: boolean;\r\n  siteConfigs?: SiteConfig[];\r\n  promptFiles?: PromptFile[];\r\n  timestamp?: number;\r\n}\r\n\r\nconst DEFAULT_URLS = [\r\n  'chat.openai.com',\r\n  'claude.ai',\r\n  'gemini.google.com',\r\n  'chatgpt.com',\r\n  'poe.com',\r\n  'perplexity.ai'\r\n];\r\n\r\n\r\nclass PopupManager {\r\n  private autoSaveTimer: number | null = null; // Êñ∞Â¢ûÔºöËá™Âä®‰øùÂ≠òÂÆöÊó∂Âô®\r\n  private hasDraft: boolean = false; // Êñ∞Â¢ûÔºöÊòØÂê¶ÊúâËçâÁ®ø\r\n\r\n  private portInput: HTMLInputElement | null = null;\r\n  private showOnAllSitesCheckbox: HTMLInputElement | null = null;\r\n  private urlList: HTMLElement | null = null;\r\n  private newUrlInput: HTMLInputElement | null = null;\r\n  private saveButton: HTMLButtonElement | null = null;\r\n  private resetButton: HTMLButtonElement | null = null;\r\n  private addUrlButton: HTMLButtonElement | null = null;\r\n  private exportButton: HTMLButtonElement | null = null;\r\n  private importButton: HTMLButtonElement | null = null;\r\n  private importFileInput: HTMLInputElement | null = null;\r\n  private smartFindButton: HTMLButtonElement | null = null;\r\n  private statusDiv: HTMLElement | null = null;\r\n  \r\n  private configList: HTMLElement | null = null;\r\n  private configHostnameInput: HTMLInputElement | null = null;\r\n  private configSelectorInput: HTMLInputElement | null = null;\r\n  private configContainerInput: HTMLInputElement | null = null;\r\n  private addConfigButton: HTMLButtonElement | null = null;\r\n  \r\n  // ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n  private promptPathInput: HTMLInputElement | null = null;\r\n  private selectFileButton: HTMLButtonElement | null = null;\r\n  private promptFileInput: HTMLInputElement | null = null;\r\n  private addPromptButton: HTMLButtonElement | null = null;\r\n  private promptList: HTMLElement | null = null;\r\n  private fileNameDisplay: HTMLElement | null = null;\r\n  private currentFileContent: string = '';\r\n\r\n  private savePathInput: HTMLInputElement | null = null;\r\n  \r\n  private currentSettings: Settings = {\r\n    port: 8765,\r\n    enabledUrls: [...DEFAULT_URLS],\r\n    showOnAllSites: false,\r\n    siteConfigs: [],\r\n    promptFiles: [],\r\n  };\r\n\r\n  private selectedCandidate: ButtonCandidate | null = null;\r\n\r\n  constructor() {\r\n    this.initElements();\r\n    this.loadSettings();\r\n    this.setupEventListeners();\r\n    this.setupAutoSave();\r\n  }\r\n\r\n  private initElements(): void {\r\n    this.portInput = document.getElementById('port-input') as HTMLInputElement;\r\n    this.showOnAllSitesCheckbox = document.getElementById('show-on-all-sites') as HTMLInputElement;\r\n    this.urlList = document.getElementById('url-list');\r\n    this.newUrlInput = document.getElementById('new-url-input') as HTMLInputElement;\r\n    this.saveButton = document.getElementById('save-settings') as HTMLButtonElement;\r\n    this.resetButton = document.getElementById('reset-defaults') as HTMLButtonElement;\r\n    this.addUrlButton = document.getElementById('add-url-btn') as HTMLButtonElement;\r\n    this.exportButton = document.getElementById('export-config') as HTMLButtonElement;\r\n    this.importButton = document.getElementById('import-config') as HTMLButtonElement;\r\n    this.importFileInput = document.getElementById('import-file-input') as HTMLInputElement;\r\n    this.smartFindButton = document.getElementById('smart-find-btn') as HTMLButtonElement;\r\n    this.statusDiv = document.getElementById('status');\r\n    \r\n    this.configList = document.getElementById('config-list');\r\n    this.configHostnameInput = document.getElementById('config-hostname') as HTMLInputElement;\r\n    this.configSelectorInput = document.getElementById('config-selector') as HTMLInputElement;\r\n    this.configContainerInput = document.getElementById('config-container') as HTMLInputElement;\r\n    this.addConfigButton = document.getElementById('add-config-btn') as HTMLButtonElement;\r\n    \r\n    // ÂàùÂßãÂåñÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n    this.promptPathInput = document.getElementById('prompt-path') as HTMLInputElement;\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.addPromptButton = document.getElementById('add-prompt-btn') as HTMLButtonElement;\r\n    this.promptList = document.getElementById('prompt-list');\r\n\r\n    // Âú® initElements ‰∏≠Ê∑ªÂä†\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.fileNameDisplay = document.getElementById('file-name-display');\r\n\r\n    this.savePathInput = document.getElementById('save-path') as HTMLInputElement;\r\n  }\r\n\r\n  private async loadSettings(): Promise<void> {\r\n  // ÂÖàÂä†ËΩΩÊ≠£ÂºèÈÖçÁΩÆÔºå‰ΩøÁî®Âçï‰∏Ä key \"settings\"\r\n  const result = await chrome.storage.sync.get('settings');\r\n  let settings: Settings;\r\n  if (result.settings) {\r\n    settings = result.settings as Settings;\r\n  } else {\r\n    // ÂõûÈÄÄÂà∞ÊóßÊ†ºÂºèÔºàÂÖºÂÆπÊÄßÔºâ\r\n    const oldSettings = await chrome.storage.sync.get({\r\n      port: 8765,\r\n      enabledUrls: [...DEFAULT_URLS],\r\n      showOnAllSites: false,\r\n      siteConfigs: [],\r\n      promptFiles: []\r\n    }) as Settings;\r\n    settings = oldSettings;\r\n  }\r\n\r\n  // ‰ªé local Âä†ËΩΩÊèêÁ§∫ËØçÊñá‰ª∂ÔºàÂàÜÁ¶ªÂ≠òÂÇ®Ôºâ\r\n  const promptResult = await chrome.storage.local.get('promptFiles');\r\n  const promptFiles: PromptFile[] = promptResult.promptFiles || [];\r\n  settings.promptFiles = promptFiles;\r\n\r\n  // Â∞ùËØïÂä†ËΩΩËçâÁ®ø\r\n  const draft = await chrome.storage.local.get('draftSettings');\r\n  \r\n  if (draft.draftSettings) {\r\n    const draftData: DraftSettings = draft.draftSettings;\r\n    \r\n    // Ê£ÄÊü•ËçâÁ®øÊòØÂê¶Âú®5ÂàÜÈíüÂÜÖÔºàÈÅøÂÖçÂä†ËΩΩËøáÊúüËçâÁ®øÔºâ\r\n    const fiveMinutes = 5 * 60 * 1000;\r\n    if (draftData.timestamp && Date.now() - draftData.timestamp < fiveMinutes) {\r\n      // ‰ΩøÁî®ËçâÁ®øË¶ÜÁõñËÆæÁΩÆ\r\n      this.currentSettings = {\r\n        port: draftData.port ?? settings.port,\r\n        enabledUrls: draftData.enabledUrls ?? settings.enabledUrls,\r\n        showOnAllSites: draftData.showOnAllSites ?? settings.showOnAllSites,\r\n        siteConfigs: draftData.siteConfigs ?? settings.siteConfigs,\r\n        promptFiles: draftData.promptFiles ?? settings.promptFiles\r\n      };\r\n      \r\n      this.hasDraft = true;\r\n      this.showDraftIndicator();\r\n    } else {\r\n      // ËçâÁ®øËøáÊúüÔºå‰ΩøÁî®Ê≠£ÂºèÈÖçÁΩÆ\r\n      this.currentSettings = settings;\r\n      await chrome.storage.local.remove('draftSettings');\r\n    }\r\n  } else {\r\n    this.currentSettings = settings;\r\n  }\r\n\r\n  if (this.savePathInput) {\r\n    this.savePathInput.value = this.currentSettings.savePath || '';\r\n  }\r\n  // Êõ¥Êñ∞UI\r\n  if (this.portInput) this.portInput.value = this.currentSettings.port.toString();\r\n  if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = this.currentSettings.showOnAllSites;\r\n  \r\n  \r\n  this.renderUrlList();\r\n  this.renderConfigList();\r\n  this.renderPromptList();\r\n}\r\n\r\n  // Êñ∞Â¢ûÔºöÊòæÁ§∫ËçâÁ®øÊåáÁ§∫Âô®\r\nprivate showDraftIndicator(): void {\r\n  if (this.saveButton) {\r\n    this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ (ÊúâÊú™‰øùÂ≠òÁöÑÊõ¥Êîπ)';\r\n    this.saveButton.style.background = '#e67e22';\r\n  }\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöÈöêËóèËçâÁ®øÊåáÁ§∫Âô®\r\nprivate hideDraftIndicator(): void {\r\n  if (this.saveButton) {\r\n    this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n    this.saveButton.style.background = '#007acc';\r\n  }\r\n  this.hasDraft = false;\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöËÆæÁΩÆËá™Âä®‰øùÂ≠ò\r\nprivate setupAutoSave(): void {\r\n  // ÁõëÂê¨ÊâÄÊúâÂèØËÉΩ‰øÆÊîπÈÖçÁΩÆÁöÑËæìÂÖ•\r\n  this.portInput?.addEventListener('input', () => this.scheduleAutoSave());\r\n  this.showOnAllSitesCheckbox?.addEventListener('change', () => this.scheduleAutoSave());\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöÂª∂ËøüËá™Âä®‰øùÂ≠òÔºàÈò≤Ê≠¢È¢ëÁπÅ‰øùÂ≠òÔºâ\r\nprivate scheduleAutoSave(): void {\r\n  if (this.autoSaveTimer) {\r\n    clearTimeout(this.autoSaveTimer);\r\n  }\r\n\r\n  this.autoSaveTimer = window.setTimeout(() => {\r\n    this.saveDraft();\r\n  }, 500); // 500msÂêé‰øùÂ≠òËçâÁ®ø\r\n}\r\n\r\n// Êñ∞Â¢ûÔºö‰øùÂ≠òËçâÁ®ø\r\nprivate async saveDraft(): Promise<void> {\r\n  const draft: DraftSettings = {\r\n    port: parseInt(this.portInput?.value || '8765'),\r\n    enabledUrls: this.currentSettings.enabledUrls,\r\n    showOnAllSites: this.showOnAllSitesCheckbox?.checked || false,\r\n    siteConfigs: this.currentSettings.siteConfigs,\r\n    promptFiles: this.currentSettings.promptFiles,\r\n    timestamp: Date.now()\r\n  };\r\n\r\n  await chrome.storage.local.set({ draftSettings: draft });\r\n  \r\n  if (!this.hasDraft) {\r\n    this.hasDraft = true;\r\n    this.showDraftIndicator();\r\n  }\r\n}\r\n\r\n  private renderUrlList(): void {\r\n    if (!this.urlList) return;\r\n\r\n    if (this.currentSettings.enabledUrls.length === 0) {\r\n      this.urlList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÁΩëÁ´ô</div>';\r\n      return;\r\n    }\r\n\r\n    this.urlList.innerHTML = this.currentSettings.enabledUrls\r\n      .map((url, index) => `\r\n        <div class=\"url-item\">\r\n          <span>${this.escapeHtml(url)}</span>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.urlList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeUrl(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private renderConfigList(): void {\r\n    if (!this.configList) return;\r\n\r\n    if (this.currentSettings.siteConfigs.length === 0) {\r\n      this.configList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†Ëá™ÂÆö‰πâÈÖçÁΩÆ</div>';\r\n      return;\r\n    }\r\n\r\n    this.configList.innerHTML = this.currentSettings.siteConfigs\r\n      .map((config, index) => `\r\n        <div class=\"url-item\">\r\n          <div style=\"flex: 1;\">\r\n            <div style=\"font-weight: 500; color: #fff;\">${this.escapeHtml(config.hostname)}</div>\r\n            <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n              ${this.escapeHtml(config.copyButtonSelector)}\r\n            </div>\r\n            ${config.responseContainerSelector ? `\r\n              <div style=\"font-size: 10px; color: #666; margin-top: 2px;\">\r\n                ÂÆπÂô®: ${this.escapeHtml(config.responseContainerSelector)}\r\n              </div>\r\n            ` : ''}\r\n          </div>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.configList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeConfig(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n  // Âü∫Êú¨ÂäüËÉΩ\r\n  this.saveButton?.addEventListener('click', () => this.saveSettings());\r\n  this.resetButton?.addEventListener('click', () => this.resetToDefaults());\r\n  this.addUrlButton?.addEventListener('click', () => this.addUrl());\r\n  this.addConfigButton?.addEventListener('click', () => this.addConfig());\r\n  this.exportButton?.addEventListener('click', () => this.exportConfig());\r\n  this.importButton?.addEventListener('click', () => this.importFileInput?.click());\r\n  this.smartFindButton?.addEventListener('click', () => this.smartFindCopyButtons());\r\n  this.importFileInput?.addEventListener('change', (e) => this.handleImportFile(e));\r\n  this.savePathInput?.addEventListener('input', () => this.saveDraft());\r\n\r\n  // URL ËæìÂÖ•ÂõûËΩ¶Âø´Êç∑ÈîÆ\r\n  this.newUrlInput?.addEventListener('keypress', (e) => {\r\n    if (e.key === 'Enter') this.addUrl();\r\n  });\r\n\r\n  // ÈÖçÁΩÆËæìÂÖ• Ctrl+Enter Âø´Êç∑ÈîÆ\r\n  this.configSelectorInput?.addEventListener('keypress', (e) => {\r\n    if (e.key === 'Enter' && e.ctrlKey) this.addConfig();\r\n  });\r\n\r\n  // ‚úÖ ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÔºàÂè™‰øùÁïô‰∏ÄÊ¨°Ôºâ\r\n  this.selectFileButton?.addEventListener('click', () => this.promptFileInput?.click());\r\n  this.promptFileInput?.addEventListener('change', (e) => this.handleFileSelect(e));\r\n  this.addPromptButton?.addEventListener('click', () => this.addPrompt());\r\n\r\n}\r\n\r\nprivate async smartFindCopyButtons(): Promise<void> {\r\n  try {\r\n    const tabs = await chrome.tabs.query({ active: true, currentWindow: true });\r\n    const activeTab = tabs[0];\r\n    \r\n    if (!activeTab || !activeTab.id) {\r\n      this.showStatus('Êó†Ê≥ïËé∑ÂèñÂΩìÂâçÊ†áÁ≠æÈ°µ', 'error');\r\n      return;\r\n    }\r\n\r\n    // Ëá™Âä®Â°´ÂÖÖÂüüÂêç\r\n    if (activeTab.url) {\r\n      try {\r\n        const url = new URL(activeTab.url);\r\n        if (this.configHostnameInput) {\r\n          this.configHostnameInput.value = url.hostname;\r\n        }\r\n      } catch (e) {\r\n        console.error('Ëß£ÊûêURLÂ§±Ë¥•:', e);\r\n      }\r\n    }\r\n\r\n    this.showScanningModal();\r\n\r\n    // Ê≥®ÂÖ•ËÑöÊú¨Êü•ÊâæÊåâÈíÆ\r\n    const results = await chrome.scripting.executeScript({\r\n      target: { tabId: activeTab.id },\r\n      func: () => {\r\n        // === ËøôÊÆµ‰ª£Á†Å‰ºöÂú®ÁõÆÊ†áÈ°µÈù¢‰∏≠ÊâßË°å ===\r\n        // Âú®ËøôÈáåÈáçÊñ∞ÂÆö‰πâÔºåÈÅøÂÖç‰∏éÂ§ñÈÉ®ÂÜ≤Á™Å\r\n        type CandidateResult = {\r\n          selector: string;\r\n          label: string;\r\n          ariaLabel: string;\r\n          text: string;\r\n          score: number;\r\n        };\r\n\r\n        const candidates: CandidateResult[] = [];\r\n        const buttons = document.querySelectorAll('button');\r\n\r\n        buttons.forEach((button) => {\r\n          const text = button.textContent?.toLowerCase().trim() || '';\r\n          const ariaLabel = button.getAttribute('aria-label')?.toLowerCase() || '';\r\n          const title = button.getAttribute('title')?.toLowerCase() || '';\r\n          const className = button.className.toLowerCase();\r\n          \r\n          let score = 0;\r\n          \r\n          // ËØÑÂàÜËßÑÂàô\r\n          if (text.includes('copy') || text.includes('Â§çÂà∂')) score += 10;\r\n          if (ariaLabel.includes('copy') || ariaLabel.includes('Â§çÂà∂')) score += 10;\r\n          if (title.includes('copy') || title.includes('Â§çÂà∂')) score += 5;\r\n          if (className.includes('copy')) score += 5;\r\n          \r\n          const svg = button.querySelector('svg');\r\n          if (svg) score += 2;\r\n          \r\n          // Âè™‰øùÁïôÁõ∏ÂÖ≥Â∫¶Ë∂≥Â§üÈ´òÁöÑÊåâÈíÆ\r\n          if (score >= 5) {\r\n            let selector = '';\r\n            const ariaLabelAttr = button.getAttribute('aria-label');\r\n            \r\n            // ÁîüÊàêÈÄâÊã©Âô®\r\n            if (ariaLabelAttr) {\r\n              // ËΩ¨‰πâÂºïÂè∑\r\n              const escapedLabel = ariaLabelAttr.replace(/\"/g, '\\\\\"');\r\n              selector = `button[aria-label=\"${escapedLabel}\"]`;\r\n            } else if (button.id) {\r\n              selector = `button#${button.id}`;\r\n            } else if (button.className && button.className.trim()) {\r\n              const classes = button.className.trim().split(/\\s+/).slice(0, 2);\r\n              if (classes.length > 0) {\r\n                selector = `button.${classes.join('.')}`;\r\n              } else {\r\n                selector = 'button';\r\n              }\r\n            } else {\r\n              selector = 'button';\r\n            }\r\n\r\n            candidates.push({\r\n              selector: selector,\r\n              label: text || ariaLabel || '(Êó†Ê†áÁ≠æ)',\r\n              ariaLabel: ariaLabelAttr || '',\r\n              text: text,\r\n              score: score\r\n            });\r\n          }\r\n        });\r\n\r\n        // ÊåâÂàÜÊï∞ÊéíÂ∫è\r\n        candidates.sort((a, b) => b.score - a.score);\r\n        \r\n        // ËøîÂõûÂâç10‰∏™\r\n        return candidates.slice(0, 10);\r\n      }\r\n    });\r\n\r\n    const candidates: ButtonCandidate[] = results[0]?.result || [];\r\n\r\n    if (candidates.length === 0) {\r\n      this.showEmptyResultModal();\r\n    } else {\r\n      this.showCandidatesModal(candidates);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•:', error);\r\n    \r\n    let errorMsg = 'Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•';\r\n    if (error instanceof Error) {\r\n      errorMsg += ': ' + error.message;\r\n    }\r\n    \r\n    this.showStatus(errorMsg, 'error');\r\n    this.closeModal();\r\n  }\r\n}\r\n\r\n\r\n  private showScanningModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Ê≠£Âú®Êâ´ÊèèÈ°µÈù¢...</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"scanning-indicator\">\r\n            <div class=\"spinner\"></div>\r\n            <p style=\"color: #888;\">Ê≠£Âú®Êü•ÊâæCOPYÊåâÈíÆ...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => {\r\n      this.closeModal();\r\n    });\r\n  }\r\n\r\n  private showEmptyResultModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Êü•ÊâæÁªìÊûú</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"empty-result\">\r\n            <div class=\"empty-result-icon\">üòï</div>\r\n            <p>Êú™ÊâæÂà∞COPYÊåâÈíÆ</p>\r\n            <p style=\"font-size: 12px; color: #666; margin-top: 8px;\">\r\n              ËØ∑Á°Æ‰øùÂΩìÂâçÈ°µÈù¢ÊúâAIÂØπËØùÂõûÁ≠îÔºåÂπ∂‰∏îÊúâÂ§çÂà∂ÊåâÈíÆ\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂÖ≥Èó≠</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n  }\r\n\r\n  private showCandidatesModal(candidates: ButtonCandidate[]): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç ÊâæÂà∞ ${candidates.length} ‰∏™ÂÄôÈÄâÊåâÈíÆ</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <p style=\"margin-bottom: 12px; font-size: 13px; color: #888;\">\r\n            ÁÇπÂáªÈÄâÊã©‰∏Ä‰∏™COPYÊåâÈíÆÔºö\r\n          </p>\r\n          ${candidates.map((c, i) => `\r\n            <div class=\"button-candidate\" data-index=\"${i}\">\r\n              <div class=\"button-info\">\r\n                <div class=\"button-label\">${this.escapeHtml(c.label)}</div>\r\n                <div class=\"button-selector\">${this.escapeHtml(c.selector)}</div>\r\n                <div class=\"button-details\">\r\n                  ${c.ariaLabel ? `aria-label: ${this.escapeHtml(c.ariaLabel)}` : ''}\r\n                  ${c.score ? ` ‚Ä¢ Áõ∏ÂÖ≥Â∫¶: ${c.score}ÂàÜ` : ''}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          `).join('')}\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂèñÊ∂à</button>\r\n          <button class=\"btn-confirm\" id=\"modal-confirm\" disabled>Á°ÆÂÆö</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-confirm')?.addEventListener('click', () => this.confirmSelection());\r\n    \r\n    const candidateElements = modal.querySelectorAll('.button-candidate');\r\n    candidateElements.forEach((el) => {\r\n      el.addEventListener('click', (e) => {\r\n        const index = parseInt((e.currentTarget as HTMLElement).getAttribute('data-index') || '0');\r\n        this.selectCandidate(index, candidates);\r\n      });\r\n    });\r\n  }\r\n\r\n  private selectCandidate(index: number, candidates: ButtonCandidate[]): void {\r\n    this.selectedCandidate = candidates[index];\r\n    \r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n    \r\n    modal.querySelectorAll('.button-candidate').forEach(el => {\r\n      el.classList.remove('selected');\r\n    });\r\n    \r\n    const selected = modal.querySelector(`[data-index=\"${index}\"]`);\r\n    selected?.classList.add('selected');\r\n    \r\n    const confirmBtn = document.getElementById('modal-confirm') as HTMLButtonElement;\r\n    if (confirmBtn) confirmBtn.disabled = false;\r\n  }\r\n\r\n  private confirmSelection(): void {\r\n    if (!this.selectedCandidate) return;\r\n    \r\n    if (this.configSelectorInput) {\r\n      this.configSelectorInput.value = this.selectedCandidate.selector;\r\n    }\r\n    \r\n    this.showStatus(`‚úÖ Â∑≤ÈÄâÊã©: ${this.selectedCandidate.selector}`, 'success');\r\n    this.closeModal();\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private closeModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (modal) {\r\n      modal.style.display = 'none';\r\n      modal.innerHTML = '';\r\n    }\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private addUrl(): void {\r\n    const url = this.newUrlInput?.value.trim();\r\n    if (!url) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÁΩëÁ´ôÂüüÂêç', 'error');\r\n      return;\r\n    }\r\n\r\n    if (!/^[\\w\\-.*]+(\\.\\w{2,})?$/.test(url) && url !== 'localhost') {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÂüüÂêçÊ†ºÂºè', 'error');\r\n      return;\r\n    }\r\n\r\n    if (this.currentSettings.enabledUrls.includes(url)) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÂ∑≤Â≠òÂú®', 'error');\r\n      return;\r\n    }\r\n\r\n    this.currentSettings.enabledUrls.push(url);\r\n    this.renderUrlList();\r\n    \r\n    if (this.newUrlInput) {\r\n      this.newUrlInput.value = '';\r\n    }\r\n    \r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeUrl(index: number): void {\r\n    this.currentSettings.enabledUrls.splice(index, 1);\r\n    this.renderUrlList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private addConfig(): void {\r\n    const hostname = this.configHostnameInput?.value.trim();\r\n    const selector = this.configSelectorInput?.value.trim();\r\n    const container = this.configContainerInput?.value.trim();\r\n\r\n    if (!hostname || !selector) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÂüüÂêçÂíåCOPYÊåâÈíÆÈÄâÊã©Âô®', 'error');\r\n      return;\r\n    }\r\n\r\n    const exists = this.currentSettings.siteConfigs.some(\r\n      config => config.hostname === hostname\r\n    );\r\n\r\n    if (exists) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÈÖçÁΩÆÂ∑≤Â≠òÂú®ÔºåËØ∑ÂÖàÂà†Èô§', 'error');\r\n      return;\r\n    }\r\n\r\n    const newConfig: SiteConfig = {\r\n      hostname,\r\n      copyButtonSelector: selector,\r\n      responseContainerSelector: container || undefined\r\n    };\r\n\r\n    this.currentSettings.siteConfigs.push(newConfig);\r\n    this.renderConfigList();\r\n\r\n    if (this.configHostnameInput) this.configHostnameInput.value = '';\r\n    if (this.configSelectorInput) this.configSelectorInput.value = '';\r\n    if (this.configContainerInput) this.configContainerInput.value = '';\r\n\r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÈÖçÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeConfig(index: number): void {\r\n    this.currentSettings.siteConfigs.splice(index, 1);\r\n    this.renderConfigList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n private async saveSettings(): Promise<void> {\r\n const saveBtn = document.getElementById('save-settings') as HTMLButtonElement;\r\n \r\n if (!saveBtn) return;\r\n\r\n try {\r\n   // ‰øùÂ≠òËÆæÁΩÆÈÄªËæë\r\n   this.currentSettings.savePath = this.savePathInput?.value.trim() || '';\r\n \r\n   // ÂàÜÁ¶ªÂ≠òÂÇ®ÔºöÊèêÁ§∫ËØçÊñá‰ª∂‰øùÂ≠òÂà∞ local\r\n   const promptFiles = this.currentSettings.promptFiles || [];\r\n   await chrome.storage.local.set({ promptFiles });\r\n   \r\n   // ÂàõÂª∫‰∏çÂåÖÂê´ promptFiles ÁöÑÈÖçÁΩÆÂØπË±°Áî®‰∫é sync Â≠òÂÇ®\r\n   const settingsForSync: Settings = {\r\n     ...this.currentSettings,\r\n     promptFiles: undefined\r\n   };\r\n   // Âà†Èô§ promptFiles Â≠óÊÆµÔºåÈÅøÂÖçÂç†Áî®Á©∫Èó¥\r\n   delete settingsForSync.promptFiles;\r\n \r\n   // Ë∞ÉËØïÔºöËÆ°ÁÆóÈÖçÁΩÆÂ§ßÂ∞è\r\n   const settingsJson = JSON.stringify(settingsForSync);\r\n   const sizeInBytes = new Blob([settingsJson]).size;\r\n   console.log(`‰øùÂ≠òÈÖçÁΩÆÂà∞ syncÔºåÂ§ßÂ∞è: ${sizeInBytes} Â≠óËäÇ (${(sizeInBytes / 1024).toFixed(2)} KB)`);\r\n   if (sizeInBytes > 8192) {\r\n     console.warn('ÈÖçÁΩÆÂ§ßÂ∞èË∂ÖËøá 8KBÔºåÂèØËÉΩË∂ÖÂá∫ chrome.storage.sync ÂçïÈ°πÈôêÂà∂');\r\n   }\r\n   // ËØ¶ÁªÜÂàÜÊûêÂêÑÈÉ®ÂàÜÂ§ßÂ∞è\r\n   const analysis: Record<string, number> = {};\r\n   if (promptFiles.length > 0) {\r\n     let totalPromptSize = 0;\r\n     promptFiles.forEach((p, i) => {\r\n       const promptSize = new Blob([p.path]).size;\r\n       totalPromptSize += promptSize;\r\n       analysis[`promptFiles[${i}].path`] = promptSize;\r\n     });\r\n     analysis['promptFiles.total'] = totalPromptSize;\r\n   }\r\n   analysis['enabledUrls'] = new Blob([JSON.stringify(this.currentSettings.enabledUrls)]).size;\r\n   analysis['siteConfigs'] = new Blob([JSON.stringify(this.currentSettings.siteConfigs)]).size;\r\n   analysis['other'] = sizeInBytes - (analysis['promptFiles.total'] || 0) - analysis['enabledUrls'] - analysis['siteConfigs'];\r\n   console.log('ÈÖçÁΩÆÂ§ßÂ∞èÂàÜÊûê:', analysis);\r\n \r\n   // ‰ΩøÁî®Âçï‰∏Ä key \"settings\" Â≠òÂÇ®Êï¥‰∏™ÈÖçÁΩÆÂØπË±°Ôºà‰∏çÂê´ promptFilesÔºâÔºåÈÅøÂÖçË∂ÖÂá∫Â≠òÂÇ®ÈôêÂà∂\r\n   await new Promise<void>((resolve, reject) => {\r\n     chrome.storage.sync.set(\r\n       { settings: settingsForSync },\r\n       () => {\r\n         const err = chrome.runtime.lastError;\r\n         if (err) {\r\n           console.error('chrome.storage.sync.set error:', err);\r\n           reject(err);\r\n         } else {\r\n           resolve();\r\n         }\r\n       }\r\n     );\r\n   });\r\n   \r\n   // ‚úÖ ‰øùÂ≠òÊàêÂäüÔºåÊÅ¢Â§çÊåâÈíÆÈªòËÆ§Áä∂ÊÄÅ\r\n   saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n   saveBtn.className = 'primary';  // ÊÅ¢Â§çËìùËâ≤Ê†∑Âºè\r\n   saveBtn.disabled = false;\r\n   \r\n   this.showStatus('‚úÖ ËÆæÁΩÆÂ∑≤‰øùÂ≠ò', 'success');\r\n   \r\n   // Ê∏ÖÈô§ËçâÁ®ø\r\n   await chrome.storage.local.remove('draftSettings');\r\n   \r\n } catch (error) {\r\n   console.error('‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:', error);\r\n   // ÊèêÂèñÂèØËØªÁöÑÈîôËØØÊ∂àÊÅØ\r\n   let errorMessage = 'Êú™Áü•ÈîôËØØ';\r\n   if (error instanceof Error) {\r\n     errorMessage = error.message;\r\n   } else if (error && typeof error === 'object') {\r\n     // Â§ÑÁêÜ chrome.runtime.lastError ÂØπË±°\r\n     if ('message' in error && typeof error.message === 'string') {\r\n       errorMessage = error.message;\r\n     } else {\r\n       errorMessage = JSON.stringify(error);\r\n     }\r\n   } else {\r\n     errorMessage = String(error);\r\n   }\r\n   this.showStatus(`‚ùå ‰øùÂ≠òÂ§±Ë¥•: ${errorMessage}`, 'error');\r\n   \r\n   // Âá∫Èîô‰πüÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ\r\n   saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n   saveBtn.className = 'primary';\r\n }\r\n}\r\n\r\n\r\n  private async resetToDefaults(): Promise<void> {\r\n    if (!confirm('Á°ÆÂÆöË¶ÅÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÂêóÔºüÊâÄÊúâËá™ÂÆö‰πâÈÖçÁΩÆÂ∞ÜË¢´Ê∏ÖÈô§„ÄÇ')) {\r\n      return;\r\n    }\r\n\r\n    this.currentSettings = {\r\n      port: 8765,\r\n      enabledUrls: [...DEFAULT_URLS],\r\n      showOnAllSites: false,\r\n      siteConfigs: [],\r\n      promptFiles: []\r\n    };\r\n\r\n    if (this.portInput) this.portInput.value = '8765';\r\n    if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = false;\r\n    \r\n    \r\n    this.renderUrlList();\r\n    this.renderConfigList();\r\n    this.renderPromptList();\r\n    this.showStatus('‚úÖ Â∑≤ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠ò', 'success');\r\n  }\r\n\r\n  private async exportConfig(): Promise<void> {\r\n    try {\r\n      const data = await chrome.storage.sync.get(null);\r\n      \r\n      const exportData = {\r\n        version: '1.0.0',\r\n        timestamp: new Date().toISOString(),\r\n        extension: 'AI to VSCode Bridge',\r\n        data: data\r\n      };\r\n\r\n      const json = JSON.stringify(exportData, null, 2);\r\n      const blob = new Blob([json], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      \r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `ai-vscode-bridge-config-${Date.now()}.json`;\r\n      a.click();\r\n      \r\n      URL.revokeObjectURL(url);\r\n      \r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂá∫', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂá∫Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂá∫Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    }\r\n  }\r\n\r\n  private async handleImportFile(event: Event): Promise<void> {\r\n    const input = event.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n    \r\n    if (!file) return;\r\n\r\n    try {\r\n      const text = await file.text();\r\n      const importData = JSON.parse(text);\r\n\r\n      if (!importData.data || !importData.version) {\r\n        this.showStatus('‚ùå Êó†ÊïàÁöÑÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè', 'error');\r\n        return;\r\n      }\r\n\r\n      if (!confirm('Á°ÆÂÆöË¶ÅÂØºÂÖ•ÈÖçÁΩÆÂêóÔºüÂΩìÂâçÈÖçÁΩÆÂ∞ÜË¢´Ë¶ÜÁõñ„ÄÇ')) {\r\n        return;\r\n      }\r\n\r\n      await chrome.storage.sync.set(importData.data);\r\n      await this.loadSettings();\r\n      \r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂÖ•ÔºåËØ∑Âà∑Êñ∞ÁΩëÈ°µ‰ΩøÈÖçÁΩÆÁîüÊïà', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂÖ•Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂÖ•Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    } finally {\r\n      input.value = '';\r\n    }\r\n  }\r\n\r\n  private showStatus(message: string, type: 'success' | 'error'): void {\r\n    if (!this.statusDiv) return;\r\n    \r\n    this.statusDiv.textContent = message;\r\n    this.statusDiv.className = type;\r\n    this.statusDiv.style.display = 'block';\r\n    \r\n    setTimeout(() => {\r\n      if (this.statusDiv) {\r\n        this.statusDiv.style.display = 'none';\r\n      }\r\n    }, 4000);\r\n  }\r\n\r\n  private escapeHtml(text: string): string {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n\r\n  // ÊèêÁ§∫ËØçÁÆ°ÁêÜÁõ∏ÂÖ≥ÊñπÊ≥ï\r\n  private renderPromptList(): void {\r\n  if (!this.promptList) return;\r\n\r\n  const prompts = this.currentSettings.promptFiles || [];\r\n\r\n  if (prompts.length === 0) {\r\n    this.promptList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÊèêÁ§∫ËØçÈÖçÁΩÆ</div>';\r\n    return;\r\n  }\r\n\r\n  this.promptList.innerHTML = prompts\r\n    .map((prompt, index) => `\r\n      <div class=\"url-item\">\r\n        <div style=\"flex: 1;\">\r\n          <div style=\"font-weight: 500; color: #fff;\">üìù ${this.escapeHtml(prompt.name)}</div>\r\n          <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n            ÂÜÖÂÆπÈïøÂ∫¶: ${prompt.path.length} Â≠óÁ¨¶\r\n          </div>\r\n        </div>\r\n        <div style=\"display: flex; gap: 6px;\">\r\n          <button \r\n            class=\"action-btn rename-btn\" \r\n            data-index=\"${index}\"\r\n            style=\"\r\n              padding: 4px 10px;\r\n              background: #4a4a4a;\r\n              color: white;\r\n              border: none;\r\n              border-radius: 3px;\r\n              cursor: pointer;\r\n              font-size: 12px;\r\n            \"\r\n          >\r\n            ‚úèÔ∏è ÈáçÂëΩÂêç\r\n          </button>\r\n          <button \r\n            class=\"danger\" \r\n            data-index=\"${index}\"\r\n          >\r\n            Âà†Èô§\r\n          </button>\r\n        </div>\r\n      </div>\r\n    `)\r\n    .join('');\r\n\r\n  // ÁªëÂÆöÂà†Èô§ÊåâÈíÆ‰∫ã‰ª∂\r\n  this.promptList.querySelectorAll('.danger').forEach(btn => {\r\n    btn.addEventListener('click', (e) => {\r\n      const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n      this.removePrompt(index);\r\n    });\r\n  });\r\n\r\n  // ÁªëÂÆöÈáçÂëΩÂêçÊåâÈíÆ‰∫ã‰ª∂\r\n  this.promptList.querySelectorAll('.rename-btn').forEach(btn => {\r\n    btn.addEventListener('click', (e) => {\r\n      const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n      this.renamePrompt(index);\r\n    });\r\n  });\r\n}\r\n\r\n\r\nprivate currentFileName: string = '';\r\n\r\nprivate async handleFileSelect(event: Event): Promise<void> {\r\n  const input = event.target as HTMLInputElement;\r\n  const file = input.files?.[0];\r\n  \r\n  if (!file) return;\r\n\r\n  try {\r\n    this.currentFileContent = await file.text();\r\n    \r\n    // ÊèêÂèñÊñá‰ª∂ÂêçÔºàÂéªÊéâÊâ©Â±ïÂêçÔºâ\r\n    this.currentFileName = file.name.replace(/\\.(md|markdown|txt)$/i, '');\r\n    \r\n    // Êõ¥Êñ∞ÊòæÁ§∫\r\n    if (this.fileNameDisplay) {\r\n      this.fileNameDisplay.textContent = file.name;\r\n      this.fileNameDisplay.style.color = '#fff';\r\n    }\r\n    \r\n    this.showStatus(\r\n      `‚úÖ Â∑≤Âä†ËΩΩ: ${file.name} (${this.currentFileContent.length} Â≠óÁ¨¶)`, \r\n      'success'\r\n    );\r\n  } catch (error) {\r\n    console.error('ËØªÂèñÊñá‰ª∂Â§±Ë¥•:', error);\r\n    this.showStatus('‚ùå ËØªÂèñÊñá‰ª∂Â§±Ë¥•', 'error');\r\n  }\r\n}\r\n\r\n\r\nprivate addPrompt(): void {\r\n  // È™åËØÅÔºöÊ£ÄÊü•ÊòØÂê¶ÈÄâÊã©‰∫ÜÊñá‰ª∂\r\n  if (!this.currentFileContent || this.currentFileContent.trim().length === 0) {\r\n    this.showStatus('‚ùå ËØ∑ÂÖàÈÄâÊã©Êñá‰ª∂', 'error');\r\n    const fileWrapper = document.getElementById('file-selector-wrapper');\r\n    if (fileWrapper) {\r\n      fileWrapper.style.borderColor = '#ff4444';\r\n      setTimeout(() => {\r\n        if (fileWrapper) fileWrapper.style.borderColor = '#3e3e3e';\r\n      }, 2000);\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (!this.currentSettings.promptFiles) {\r\n    this.currentSettings.promptFiles = [];\r\n  }\r\n\r\n  // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®ÂêåÂêçÊèêÁ§∫ËØç\r\n  const exists = this.currentSettings.promptFiles.some(\r\n    p => p.name === this.currentFileName\r\n  );\r\n  \r\n  if (exists) {\r\n    this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${this.currentFileName}\" Â∑≤Â≠òÂú®`, 'error');\r\n    return;\r\n  }\r\n\r\n  const newPrompt = {\r\n    id: Date.now().toString(),\r\n    name: this.currentFileName, // ‰ΩøÁî®Êñá‰ª∂Âêç\r\n    path: this.currentFileContent,\r\n    enabled: true\r\n  };\r\n\r\n  this.currentSettings.promptFiles.push(newPrompt);\r\n  this.renderPromptList();\r\n\r\n  // Ê∏ÖÁ©∫\r\n  if (this.fileNameDisplay) {\r\n    this.fileNameDisplay.textContent = 'Êú™ÈÄâÊã©Êñá‰ª∂';\r\n    this.fileNameDisplay.style.color = '#888';\r\n  }\r\n  this.currentFileContent = '';\r\n  this.currentFileName = '';\r\n\r\n  // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•Ê°Ü\r\n  if (this.promptFileInput) {\r\n    this.promptFileInput.value = '';\r\n  }\r\n\r\n  this.saveDraft();\r\n  \r\n  this.showStatus(`‚úÖ Â∑≤Ê∑ªÂä†ÊèêÁ§∫ËØçÔºö${newPrompt.name}`, 'success');\r\n}\r\nprivate renamePrompt(index: number): void {\r\n  if (!this.currentSettings.promptFiles) return;\r\n\r\n  const prompt = this.currentSettings.promptFiles[index];\r\n  if (!prompt) return;\r\n\r\n  // ÊâæÂà∞ÂØπÂ∫îÁöÑ DOM ÂÖÉÁ¥†\r\n  const items = this.promptList?.querySelectorAll('.url-item');\r\n  if (!items || !items[index]) return;\r\n\r\n  const item = items[index];\r\n  const nameElement = item.querySelector('div > div:first-child') as HTMLElement;\r\n  if (!nameElement) return;\r\n\r\n  // ‰øùÂ≠òÂéüÂßãÂêçÁß∞\r\n  const originalName = prompt.name;\r\n  const originalHTML = nameElement.innerHTML;\r\n\r\n  // ÂàõÂª∫ËæìÂÖ•Ê°Ü\r\n  const input = document.createElement('input');\r\n  input.type = 'text';\r\n  input.value = originalName;\r\n  input.style.cssText = `\r\n    width: 100%;\r\n    padding: 4px 8px;\r\n    background: #2d2d2d;\r\n    border: 1px solid #007bff;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    font-size: 14px;\r\n    font-weight: 500;\r\n  `;\r\n\r\n  // ÊõøÊç¢‰∏∫ËæìÂÖ•Ê°Ü\r\n  nameElement.innerHTML = '';\r\n  nameElement.appendChild(input);\r\n  input.focus();\r\n  input.select();\r\n\r\n  // ‰øùÂ≠òÂáΩÊï∞\r\n  const save = () => {\r\n    const newName = input.value.trim();\r\n\r\n    if (!newName) {\r\n      nameElement.innerHTML = originalHTML;\r\n      this.showStatus('‚ùå ÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫', 'error');\r\n      return;\r\n    }\r\n\r\n    // Ê£ÄÊü•ÈáçÂêç\r\n    const exists = this.currentSettings.promptFiles!.some(\r\n      (p, i) => i !== index && p.name === newName\r\n    );\r\n\r\n    if (exists) {\r\n      nameElement.innerHTML = originalHTML;\r\n      this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${newName}\" Â∑≤Â≠òÂú®`, 'error');\r\n      return;\r\n    }\r\n\r\n    // Êõ¥Êñ∞ÂêçÁß∞\r\n    prompt.name = newName;\r\n    nameElement.innerHTML = `üìù ${this.escapeHtml(newName)}`;\r\n    \r\n    this.saveDraft();\r\n    this.showStatus(`‚úÖ Â∑≤ÈáçÂëΩÂêç‰∏∫Ôºö${newName}`, 'success');\r\n  };\r\n\r\n  // ÂèñÊ∂àÂáΩÊï∞\r\n  const cancel = () => {\r\n    nameElement.innerHTML = originalHTML;\r\n  };\r\n\r\n  // ÂõûËΩ¶‰øùÂ≠ò\r\n  input.addEventListener('keydown', (e) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      save();\r\n    } else if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      cancel();\r\n    }\r\n  });\r\n\r\n  // Â§±ÁÑ¶‰øùÂ≠ò\r\n  input.addEventListener('blur', save);\r\n}\r\n\r\n\r\n\r\n\r\n  private removePrompt(index: number): void {\r\n    if (!this.currentSettings.promptFiles) return;\r\n    \r\n    this.currentSettings.promptFiles.splice(index, 1);\r\n    this.renderPromptList();\r\n    this.saveDraft();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  new PopupManager();\r\n});\r\n"],"names":["DEFAULT_URLS","PopupManager","constructor","autoSaveTimer","hasDraft","portInput","showOnAllSitesCheckbox","urlList","newUrlInput","saveButton","resetButton","addUrlButton","exportButton","importButton","importFileInput","smartFindButton","statusDiv","configList","configHostnameInput","configSelectorInput","configContainerInput","addConfigButton","promptPathInput","selectFileButton","promptFileInput","addPromptButton","promptList","fileNameDisplay","currentFileContent","savePathInput","currentSettings","port","enabledUrls","showOnAllSites","siteConfigs","promptFiles","selectedCandidate","currentFileName","this","initElements","loadSettings","setupEventListeners","setupAutoSave","document","getElementById","result","chrome","storage","sync","get","settings","local","draft","draftSettings","draftData","fiveMinutes","timestamp","Date","now","showDraftIndicator","remove","value","savePath","toString","checked","renderUrlList","renderConfigList","renderPromptList","textContent","style","background","hideDraftIndicator","addEventListener","scheduleAutoSave","clearTimeout","window","setTimeout","saveDraft","parseInt","set","length","innerHTML","map","url","index","escapeHtml","join","querySelectorAll","forEach","btn","e","target","getAttribute","removeUrl","config","hostname","copyButtonSelector","responseContainerSelector","removeConfig","saveSettings","resetToDefaults","addUrl","addConfig","exportConfig","click","smartFindCopyButtons","handleImportFile","key","ctrlKey","handleFileSelect","addPrompt","activeTab","tabs","query","active","currentWindow","id","showStatus","URL","console","error","showScanningModal","results","scripting","executeScript","tabId","func","candidates","button","text","toLowerCase","trim","ariaLabel","title","className","score","includes","querySelector","selector","ariaLabelAttr","replace","classes","split","slice","push","label","sort","a","b","showEmptyResultModal","showCandidatesModal","errorMsg","Error","message","closeModal","modal","display","c","i","confirmSelection","el","currentTarget","selectCandidate","classList","selected","add","confirmBtn","disabled","test","splice","container","some","newConfig","undefined","saveBtn","settingsForSync","settingsJson","JSON","stringify","sizeInBytes","Blob","size","log","toFixed","warn","analysis","totalPromptSize","p","promptSize","path","Promise","resolve","reject","err","runtime","lastError","errorMessage","String","confirm","data","exportData","version","toISOString","extension","json","blob","type","createObjectURL","createElement","href","download","revokeObjectURL","event","input","file","files","importData","parse","div","prompts","prompt","name","removePrompt","renamePrompt","color","fileWrapper","borderColor","newPrompt","enabled","items","nameElement","originalName","originalHTML","cssText","appendChild","focus","select","save","newName","preventDefault"],"sourceRoot":""}