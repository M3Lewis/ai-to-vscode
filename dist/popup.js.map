{"version":3,"file":"popup.js","mappings":"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","sources":["webpack://ai-to-vscode-bridge/./src/popup.ts"],"sourcesContent":["interface SiteConfig {\r\n  hostname: string;\r\n  copyButtonSelector: string;\r\n  responseContainerSelector?: string;\r\n  name?: string;\r\n}\r\n\r\ninterface PromptFile {\r\n  id: string;\r\n  name: string;      // ÊòæÁ§∫ÂêçÁß∞\r\n  path: string;      // Â≠òÂÇ®Êñá‰ª∂ÂÜÖÂÆπÔºàËÄå‰∏çÊòØË∑ØÂæÑÔºâ\r\n  enabled: boolean;  // ÊòØÂê¶ÂêØÁî®\r\n}\r\n\r\ninterface Settings {\r\n  port: number;\r\n  enabledUrls: string[];\r\n  showOnAllSites: boolean;\r\n  siteConfigs: SiteConfig[];\r\n  promptFiles?: PromptFile[];  // ÊèêÁ§∫ËØçÊñá‰ª∂ÂàóË°®\r\n  savePath?: string;\r\n}\r\n\r\n// ‰øÆÊîπÂéüÊù•ÁöÑ ButtonCandidate Êé•Âè£ÔºåÂéªÊéâ element Â±ûÊÄß\r\ninterface ButtonCandidate {\r\n  selector: string;\r\n  label: string;\r\n  ariaLabel: string;\r\n  text: string;\r\n  score: number;\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöËçâÁ®øÊé•Âè£\r\ninterface DraftSettings {\r\n  port?: number;\r\n  enabledUrls?: string[];\r\n  showOnAllSites?: boolean;\r\n  siteConfigs?: SiteConfig[];\r\n  promptFiles?: PromptFile[];\r\n  timestamp?: number;\r\n}\r\n\r\nconst DEFAULT_URLS = [\r\n  'chat.openai.com',\r\n  'claude.ai',\r\n  'gemini.google.com',\r\n  'chatgpt.com',\r\n  'poe.com',\r\n  'perplexity.ai'\r\n];\r\n\r\n\r\nclass PopupManager {\r\n  private autoSaveTimer: number | null = null; // Êñ∞Â¢ûÔºöËá™Âä®‰øùÂ≠òÂÆöÊó∂Âô®\r\n  private hasDraft: boolean = false; // Êñ∞Â¢ûÔºöÊòØÂê¶ÊúâËçâÁ®ø\r\n\r\n  private portInput: HTMLInputElement | null = null;\r\n  private showOnAllSitesCheckbox: HTMLInputElement | null = null;\r\n  private urlList: HTMLElement | null = null;\r\n  private newUrlInput: HTMLInputElement | null = null;\r\n  private saveButton: HTMLButtonElement | null = null;\r\n  private resetButton: HTMLButtonElement | null = null;\r\n  private addUrlButton: HTMLButtonElement | null = null;\r\n  private exportButton: HTMLButtonElement | null = null;\r\n  private importButton: HTMLButtonElement | null = null;\r\n  private importFileInput: HTMLInputElement | null = null;\r\n  private smartFindButton: HTMLButtonElement | null = null;\r\n  private statusDiv: HTMLElement | null = null;\r\n  \r\n  private configList: HTMLElement | null = null;\r\n  private configHostnameInput: HTMLInputElement | null = null;\r\n  private configSelectorInput: HTMLInputElement | null = null;\r\n  private configContainerInput: HTMLInputElement | null = null;\r\n  private addConfigButton: HTMLButtonElement | null = null;\r\n  \r\n  // ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n  private promptPathInput: HTMLInputElement | null = null;\r\n  private selectFileButton: HTMLButtonElement | null = null;\r\n  private promptFileInput: HTMLInputElement | null = null;\r\n  private addPromptButton: HTMLButtonElement | null = null;\r\n  private promptList: HTMLElement | null = null;\r\n  private fileNameDisplay: HTMLElement | null = null;\r\n  private currentFileContent: string = '';\r\n\r\n  private savePathInput: HTMLInputElement | null = null;\r\n  \r\n  private currentSettings: Settings = {\r\n    port: 8765,\r\n    enabledUrls: [...DEFAULT_URLS],\r\n    showOnAllSites: false,\r\n    siteConfigs: [],\r\n    promptFiles: [],\r\n  };\r\n\r\n  private selectedCandidate: ButtonCandidate | null = null;\r\n\r\n  constructor() {\r\n    this.initElements();\r\n    this.loadSettings();\r\n    this.setupEventListeners();\r\n    this.setupAutoSave();\r\n  }\r\n\r\n  private initElements(): void {\r\n    this.portInput = document.getElementById('port-input') as HTMLInputElement;\r\n    this.showOnAllSitesCheckbox = document.getElementById('show-on-all-sites') as HTMLInputElement;\r\n    this.urlList = document.getElementById('url-list');\r\n    this.newUrlInput = document.getElementById('new-url-input') as HTMLInputElement;\r\n    this.saveButton = document.getElementById('save-settings') as HTMLButtonElement;\r\n    this.resetButton = document.getElementById('reset-defaults') as HTMLButtonElement;\r\n    this.addUrlButton = document.getElementById('add-url-btn') as HTMLButtonElement;\r\n    this.exportButton = document.getElementById('export-config') as HTMLButtonElement;\r\n    this.importButton = document.getElementById('import-config') as HTMLButtonElement;\r\n    this.importFileInput = document.getElementById('import-file-input') as HTMLInputElement;\r\n    this.smartFindButton = document.getElementById('smart-find-btn') as HTMLButtonElement;\r\n    this.statusDiv = document.getElementById('status');\r\n    \r\n    this.configList = document.getElementById('config-list');\r\n    this.configHostnameInput = document.getElementById('config-hostname') as HTMLInputElement;\r\n    this.configSelectorInput = document.getElementById('config-selector') as HTMLInputElement;\r\n    this.configContainerInput = document.getElementById('config-container') as HTMLInputElement;\r\n    this.addConfigButton = document.getElementById('add-config-btn') as HTMLButtonElement;\r\n    \r\n    // ÂàùÂßãÂåñÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÂÖÉÁ¥†\r\n    this.promptPathInput = document.getElementById('prompt-path') as HTMLInputElement;\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.addPromptButton = document.getElementById('add-prompt-btn') as HTMLButtonElement;\r\n    this.promptList = document.getElementById('prompt-list');\r\n\r\n    // Âú® initElements ‰∏≠Ê∑ªÂä†\r\n    this.selectFileButton = document.getElementById('select-file-btn') as HTMLButtonElement;\r\n    this.promptFileInput = document.getElementById('prompt-file-input') as HTMLInputElement;\r\n    this.fileNameDisplay = document.getElementById('file-name-display');\r\n\r\n    this.savePathInput = document.getElementById('save-path') as HTMLInputElement;\r\n  }\r\n\r\n  private async loadSettings(): Promise<void> {\r\n  // ÂÖàÂä†ËΩΩÊ≠£ÂºèÈÖçÁΩÆ\r\n  const settings = await chrome.storage.sync.get({\r\n    port: 8765,\r\n    enabledUrls: [...DEFAULT_URLS],\r\n    showOnAllSites: false,\r\n    siteConfigs: [],\r\n    promptFiles: []\r\n  }) as Settings;\r\n\r\n  // Â∞ùËØïÂä†ËΩΩËçâÁ®ø\r\n  const draft = await chrome.storage.local.get('draftSettings');\r\n  \r\n  if (draft.draftSettings) {\r\n    const draftData: DraftSettings = draft.draftSettings;\r\n    \r\n    // Ê£ÄÊü•ËçâÁ®øÊòØÂê¶Âú®5ÂàÜÈíüÂÜÖÔºàÈÅøÂÖçÂä†ËΩΩËøáÊúüËçâÁ®øÔºâ\r\n    const fiveMinutes = 5 * 60 * 1000;\r\n    if (draftData.timestamp && Date.now() - draftData.timestamp < fiveMinutes) {\r\n      // ‰ΩøÁî®ËçâÁ®øË¶ÜÁõñËÆæÁΩÆ\r\n      this.currentSettings = {\r\n        port: draftData.port ?? settings.port,\r\n        enabledUrls: draftData.enabledUrls ?? settings.enabledUrls,\r\n        showOnAllSites: draftData.showOnAllSites ?? settings.showOnAllSites,\r\n        siteConfigs: draftData.siteConfigs ?? settings.siteConfigs,\r\n        promptFiles: draftData.promptFiles ?? settings.promptFiles\r\n      };\r\n      \r\n      this.hasDraft = true;\r\n      this.showDraftIndicator();\r\n    } else {\r\n      // ËçâÁ®øËøáÊúüÔºå‰ΩøÁî®Ê≠£ÂºèÈÖçÁΩÆ\r\n      this.currentSettings = settings;\r\n      await chrome.storage.local.remove('draftSettings');\r\n    }\r\n  } else {\r\n    this.currentSettings = settings;\r\n  }\r\n\r\n  if (this.savePathInput) {\r\n    this.savePathInput.value = settings.savePath || '';\r\n  }\r\n  // Êõ¥Êñ∞UI\r\n  if (this.portInput) this.portInput.value = this.currentSettings.port.toString();\r\n  if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = this.currentSettings.showOnAllSites;\r\n  \r\n  \r\n  this.renderUrlList();\r\n  this.renderConfigList();\r\n  this.renderPromptList();\r\n}\r\n\r\n  // Êñ∞Â¢ûÔºöÊòæÁ§∫ËçâÁ®øÊåáÁ§∫Âô®\r\nprivate showDraftIndicator(): void {\r\n  if (this.saveButton) {\r\n    this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ (ÊúâÊú™‰øùÂ≠òÁöÑÊõ¥Êîπ)';\r\n    this.saveButton.style.background = '#e67e22';\r\n  }\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöÈöêËóèËçâÁ®øÊåáÁ§∫Âô®\r\nprivate hideDraftIndicator(): void {\r\n  if (this.saveButton) {\r\n    this.saveButton.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n    this.saveButton.style.background = '#007acc';\r\n  }\r\n  this.hasDraft = false;\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöËÆæÁΩÆËá™Âä®‰øùÂ≠ò\r\nprivate setupAutoSave(): void {\r\n  // ÁõëÂê¨ÊâÄÊúâÂèØËÉΩ‰øÆÊîπÈÖçÁΩÆÁöÑËæìÂÖ•\r\n  this.portInput?.addEventListener('input', () => this.scheduleAutoSave());\r\n  this.showOnAllSitesCheckbox?.addEventListener('change', () => this.scheduleAutoSave());\r\n}\r\n\r\n// Êñ∞Â¢ûÔºöÂª∂ËøüËá™Âä®‰øùÂ≠òÔºàÈò≤Ê≠¢È¢ëÁπÅ‰øùÂ≠òÔºâ\r\nprivate scheduleAutoSave(): void {\r\n  if (this.autoSaveTimer) {\r\n    clearTimeout(this.autoSaveTimer);\r\n  }\r\n\r\n  this.autoSaveTimer = window.setTimeout(() => {\r\n    this.saveDraft();\r\n  }, 500); // 500msÂêé‰øùÂ≠òËçâÁ®ø\r\n}\r\n\r\n// Êñ∞Â¢ûÔºö‰øùÂ≠òËçâÁ®ø\r\nprivate async saveDraft(): Promise<void> {\r\n  const draft: DraftSettings = {\r\n    port: parseInt(this.portInput?.value || '8765'),\r\n    enabledUrls: this.currentSettings.enabledUrls,\r\n    showOnAllSites: this.showOnAllSitesCheckbox?.checked || false,\r\n    siteConfigs: this.currentSettings.siteConfigs,\r\n    promptFiles: this.currentSettings.promptFiles,\r\n    timestamp: Date.now()\r\n  };\r\n\r\n  await chrome.storage.local.set({ draftSettings: draft });\r\n  \r\n  if (!this.hasDraft) {\r\n    this.hasDraft = true;\r\n    this.showDraftIndicator();\r\n  }\r\n}\r\n\r\n  private renderUrlList(): void {\r\n    if (!this.urlList) return;\r\n\r\n    if (this.currentSettings.enabledUrls.length === 0) {\r\n      this.urlList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÁΩëÁ´ô</div>';\r\n      return;\r\n    }\r\n\r\n    this.urlList.innerHTML = this.currentSettings.enabledUrls\r\n      .map((url, index) => `\r\n        <div class=\"url-item\">\r\n          <span>${this.escapeHtml(url)}</span>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.urlList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeUrl(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private renderConfigList(): void {\r\n    if (!this.configList) return;\r\n\r\n    if (this.currentSettings.siteConfigs.length === 0) {\r\n      this.configList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†Ëá™ÂÆö‰πâÈÖçÁΩÆ</div>';\r\n      return;\r\n    }\r\n\r\n    this.configList.innerHTML = this.currentSettings.siteConfigs\r\n      .map((config, index) => `\r\n        <div class=\"url-item\">\r\n          <div style=\"flex: 1;\">\r\n            <div style=\"font-weight: 500; color: #fff;\">${this.escapeHtml(config.hostname)}</div>\r\n            <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n              ${this.escapeHtml(config.copyButtonSelector)}\r\n            </div>\r\n            ${config.responseContainerSelector ? `\r\n              <div style=\"font-size: 10px; color: #666; margin-top: 2px;\">\r\n                ÂÆπÂô®: ${this.escapeHtml(config.responseContainerSelector)}\r\n              </div>\r\n            ` : ''}\r\n          </div>\r\n          <button data-index=\"${index}\">Âà†Èô§</button>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    this.configList.querySelectorAll('button').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n        this.removeConfig(index);\r\n      });\r\n    });\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n  // Âü∫Êú¨ÂäüËÉΩ\r\n  this.saveButton?.addEventListener('click', () => this.saveSettings());\r\n  this.resetButton?.addEventListener('click', () => this.resetToDefaults());\r\n  this.addUrlButton?.addEventListener('click', () => this.addUrl());\r\n  this.addConfigButton?.addEventListener('click', () => this.addConfig());\r\n  this.exportButton?.addEventListener('click', () => this.exportConfig());\r\n  this.importButton?.addEventListener('click', () => this.importFileInput?.click());\r\n  this.smartFindButton?.addEventListener('click', () => this.smartFindCopyButtons());\r\n  this.importFileInput?.addEventListener('change', (e) => this.handleImportFile(e));\r\n  this.savePathInput?.addEventListener('input', () => this.saveDraft());\r\n\r\n  // URL ËæìÂÖ•ÂõûËΩ¶Âø´Êç∑ÈîÆ\r\n  this.newUrlInput?.addEventListener('keypress', (e) => {\r\n    if (e.key === 'Enter') this.addUrl();\r\n  });\r\n\r\n  // ÈÖçÁΩÆËæìÂÖ• Ctrl+Enter Âø´Êç∑ÈîÆ\r\n  this.configSelectorInput?.addEventListener('keypress', (e) => {\r\n    if (e.key === 'Enter' && e.ctrlKey) this.addConfig();\r\n  });\r\n\r\n  // ‚úÖ ÊèêÁ§∫ËØçÁõ∏ÂÖ≥ÔºàÂè™‰øùÁïô‰∏ÄÊ¨°Ôºâ\r\n  this.selectFileButton?.addEventListener('click', () => this.promptFileInput?.click());\r\n  this.promptFileInput?.addEventListener('change', (e) => this.handleFileSelect(e));\r\n  this.addPromptButton?.addEventListener('click', () => this.addPrompt());\r\n\r\n}\r\n\r\nprivate async smartFindCopyButtons(): Promise<void> {\r\n  try {\r\n    const tabs = await chrome.tabs.query({ active: true, currentWindow: true });\r\n    const activeTab = tabs[0];\r\n    \r\n    if (!activeTab || !activeTab.id) {\r\n      this.showStatus('Êó†Ê≥ïËé∑ÂèñÂΩìÂâçÊ†áÁ≠æÈ°µ', 'error');\r\n      return;\r\n    }\r\n\r\n    // Ëá™Âä®Â°´ÂÖÖÂüüÂêç\r\n    if (activeTab.url) {\r\n      try {\r\n        const url = new URL(activeTab.url);\r\n        if (this.configHostnameInput) {\r\n          this.configHostnameInput.value = url.hostname;\r\n        }\r\n      } catch (e) {\r\n        console.error('Ëß£ÊûêURLÂ§±Ë¥•:', e);\r\n      }\r\n    }\r\n\r\n    this.showScanningModal();\r\n\r\n    // Ê≥®ÂÖ•ËÑöÊú¨Êü•ÊâæÊåâÈíÆ\r\n    const results = await chrome.scripting.executeScript({\r\n      target: { tabId: activeTab.id },\r\n      func: () => {\r\n        // === ËøôÊÆµ‰ª£Á†Å‰ºöÂú®ÁõÆÊ†áÈ°µÈù¢‰∏≠ÊâßË°å ===\r\n        // Âú®ËøôÈáåÈáçÊñ∞ÂÆö‰πâÔºåÈÅøÂÖç‰∏éÂ§ñÈÉ®ÂÜ≤Á™Å\r\n        type CandidateResult = {\r\n          selector: string;\r\n          label: string;\r\n          ariaLabel: string;\r\n          text: string;\r\n          score: number;\r\n        };\r\n\r\n        const candidates: CandidateResult[] = [];\r\n        const buttons = document.querySelectorAll('button');\r\n\r\n        buttons.forEach((button) => {\r\n          const text = button.textContent?.toLowerCase().trim() || '';\r\n          const ariaLabel = button.getAttribute('aria-label')?.toLowerCase() || '';\r\n          const title = button.getAttribute('title')?.toLowerCase() || '';\r\n          const className = button.className.toLowerCase();\r\n          \r\n          let score = 0;\r\n          \r\n          // ËØÑÂàÜËßÑÂàô\r\n          if (text.includes('copy') || text.includes('Â§çÂà∂')) score += 10;\r\n          if (ariaLabel.includes('copy') || ariaLabel.includes('Â§çÂà∂')) score += 10;\r\n          if (title.includes('copy') || title.includes('Â§çÂà∂')) score += 5;\r\n          if (className.includes('copy')) score += 5;\r\n          \r\n          const svg = button.querySelector('svg');\r\n          if (svg) score += 2;\r\n          \r\n          // Âè™‰øùÁïôÁõ∏ÂÖ≥Â∫¶Ë∂≥Â§üÈ´òÁöÑÊåâÈíÆ\r\n          if (score >= 5) {\r\n            let selector = '';\r\n            const ariaLabelAttr = button.getAttribute('aria-label');\r\n            \r\n            // ÁîüÊàêÈÄâÊã©Âô®\r\n            if (ariaLabelAttr) {\r\n              // ËΩ¨‰πâÂºïÂè∑\r\n              const escapedLabel = ariaLabelAttr.replace(/\"/g, '\\\\\"');\r\n              selector = `button[aria-label=\"${escapedLabel}\"]`;\r\n            } else if (button.id) {\r\n              selector = `button#${button.id}`;\r\n            } else if (button.className && button.className.trim()) {\r\n              const classes = button.className.trim().split(/\\s+/).slice(0, 2);\r\n              if (classes.length > 0) {\r\n                selector = `button.${classes.join('.')}`;\r\n              } else {\r\n                selector = 'button';\r\n              }\r\n            } else {\r\n              selector = 'button';\r\n            }\r\n\r\n            candidates.push({\r\n              selector: selector,\r\n              label: text || ariaLabel || '(Êó†Ê†áÁ≠æ)',\r\n              ariaLabel: ariaLabelAttr || '',\r\n              text: text,\r\n              score: score\r\n            });\r\n          }\r\n        });\r\n\r\n        // ÊåâÂàÜÊï∞ÊéíÂ∫è\r\n        candidates.sort((a, b) => b.score - a.score);\r\n        \r\n        // ËøîÂõûÂâç10‰∏™\r\n        return candidates.slice(0, 10);\r\n      }\r\n    });\r\n\r\n    const candidates: ButtonCandidate[] = results[0]?.result || [];\r\n\r\n    if (candidates.length === 0) {\r\n      this.showEmptyResultModal();\r\n    } else {\r\n      this.showCandidatesModal(candidates);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•:', error);\r\n    \r\n    let errorMsg = 'Êô∫ËÉΩÊü•ÊâæÂ§±Ë¥•';\r\n    if (error instanceof Error) {\r\n      errorMsg += ': ' + error.message;\r\n    }\r\n    \r\n    this.showStatus(errorMsg, 'error');\r\n    this.closeModal();\r\n  }\r\n}\r\n\r\n\r\n  private showScanningModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Ê≠£Âú®Êâ´ÊèèÈ°µÈù¢...</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"scanning-indicator\">\r\n            <div class=\"spinner\"></div>\r\n            <p style=\"color: #888;\">Ê≠£Âú®Êü•ÊâæCOPYÊåâÈíÆ...</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => {\r\n      this.closeModal();\r\n    });\r\n  }\r\n\r\n  private showEmptyResultModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç Êü•ÊâæÁªìÊûú</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"empty-result\">\r\n            <div class=\"empty-result-icon\">üòï</div>\r\n            <p>Êú™ÊâæÂà∞COPYÊåâÈíÆ</p>\r\n            <p style=\"font-size: 12px; color: #666; margin-top: 8px;\">\r\n              ËØ∑Á°Æ‰øùÂΩìÂâçÈ°µÈù¢ÊúâAIÂØπËØùÂõûÁ≠îÔºåÂπ∂‰∏îÊúâÂ§çÂà∂ÊåâÈíÆ\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂÖ≥Èó≠</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n  }\r\n\r\n  private showCandidatesModal(candidates: ButtonCandidate[]): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n\r\n    modal.innerHTML = `\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h3>üîç ÊâæÂà∞ ${candidates.length} ‰∏™ÂÄôÈÄâÊåâÈíÆ</h3>\r\n          <button class=\"modal-close\" id=\"modal-close\">√ó</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <p style=\"margin-bottom: 12px; font-size: 13px; color: #888;\">\r\n            ÁÇπÂáªÈÄâÊã©‰∏Ä‰∏™COPYÊåâÈíÆÔºö\r\n          </p>\r\n          ${candidates.map((c, i) => `\r\n            <div class=\"button-candidate\" data-index=\"${i}\">\r\n              <div class=\"button-info\">\r\n                <div class=\"button-label\">${this.escapeHtml(c.label)}</div>\r\n                <div class=\"button-selector\">${this.escapeHtml(c.selector)}</div>\r\n                <div class=\"button-details\">\r\n                  ${c.ariaLabel ? `aria-label: ${this.escapeHtml(c.ariaLabel)}` : ''}\r\n                  ${c.score ? ` ‚Ä¢ Áõ∏ÂÖ≥Â∫¶: ${c.score}ÂàÜ` : ''}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          `).join('')}\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn-cancel\" id=\"modal-cancel\">ÂèñÊ∂à</button>\r\n          <button class=\"btn-confirm\" id=\"modal-confirm\" disabled>Á°ÆÂÆö</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    modal.style.display = 'flex';\r\n    \r\n    document.getElementById('modal-close')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-cancel')?.addEventListener('click', () => this.closeModal());\r\n    document.getElementById('modal-confirm')?.addEventListener('click', () => this.confirmSelection());\r\n    \r\n    const candidateElements = modal.querySelectorAll('.button-candidate');\r\n    candidateElements.forEach((el) => {\r\n      el.addEventListener('click', (e) => {\r\n        const index = parseInt((e.currentTarget as HTMLElement).getAttribute('data-index') || '0');\r\n        this.selectCandidate(index, candidates);\r\n      });\r\n    });\r\n  }\r\n\r\n  private selectCandidate(index: number, candidates: ButtonCandidate[]): void {\r\n    this.selectedCandidate = candidates[index];\r\n    \r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (!modal) return;\r\n    \r\n    modal.querySelectorAll('.button-candidate').forEach(el => {\r\n      el.classList.remove('selected');\r\n    });\r\n    \r\n    const selected = modal.querySelector(`[data-index=\"${index}\"]`);\r\n    selected?.classList.add('selected');\r\n    \r\n    const confirmBtn = document.getElementById('modal-confirm') as HTMLButtonElement;\r\n    if (confirmBtn) confirmBtn.disabled = false;\r\n  }\r\n\r\n  private confirmSelection(): void {\r\n    if (!this.selectedCandidate) return;\r\n    \r\n    if (this.configSelectorInput) {\r\n      this.configSelectorInput.value = this.selectedCandidate.selector;\r\n    }\r\n    \r\n    this.showStatus(`‚úÖ Â∑≤ÈÄâÊã©: ${this.selectedCandidate.selector}`, 'success');\r\n    this.closeModal();\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private closeModal(): void {\r\n    const modal = document.getElementById('smart-find-modal');\r\n    if (modal) {\r\n      modal.style.display = 'none';\r\n      modal.innerHTML = '';\r\n    }\r\n    this.selectedCandidate = null;\r\n  }\r\n\r\n  private addUrl(): void {\r\n    const url = this.newUrlInput?.value.trim();\r\n    if (!url) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÁΩëÁ´ôÂüüÂêç', 'error');\r\n      return;\r\n    }\r\n\r\n    if (!/^[\\w\\-.*]+(\\.\\w{2,})?$/.test(url) && url !== 'localhost') {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÂüüÂêçÊ†ºÂºè', 'error');\r\n      return;\r\n    }\r\n\r\n    if (this.currentSettings.enabledUrls.includes(url)) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÂ∑≤Â≠òÂú®', 'error');\r\n      return;\r\n    }\r\n\r\n    this.currentSettings.enabledUrls.push(url);\r\n    this.renderUrlList();\r\n    \r\n    if (this.newUrlInput) {\r\n      this.newUrlInput.value = '';\r\n    }\r\n    \r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeUrl(index: number): void {\r\n    this.currentSettings.enabledUrls.splice(index, 1);\r\n    this.renderUrlList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private addConfig(): void {\r\n    const hostname = this.configHostnameInput?.value.trim();\r\n    const selector = this.configSelectorInput?.value.trim();\r\n    const container = this.configContainerInput?.value.trim();\r\n\r\n    if (!hostname || !selector) {\r\n      this.showStatus('ËØ∑ËæìÂÖ•ÂüüÂêçÂíåCOPYÊåâÈíÆÈÄâÊã©Âô®', 'error');\r\n      return;\r\n    }\r\n\r\n    const exists = this.currentSettings.siteConfigs.some(\r\n      config => config.hostname === hostname\r\n    );\r\n\r\n    if (exists) {\r\n      this.showStatus('ËØ•ÁΩëÁ´ôÈÖçÁΩÆÂ∑≤Â≠òÂú®ÔºåËØ∑ÂÖàÂà†Èô§', 'error');\r\n      return;\r\n    }\r\n\r\n    const newConfig: SiteConfig = {\r\n      hostname,\r\n      copyButtonSelector: selector,\r\n      responseContainerSelector: container || undefined\r\n    };\r\n\r\n    this.currentSettings.siteConfigs.push(newConfig);\r\n    this.renderConfigList();\r\n\r\n    if (this.configHostnameInput) this.configHostnameInput.value = '';\r\n    if (this.configSelectorInput) this.configSelectorInput.value = '';\r\n    if (this.configContainerInput) this.configContainerInput.value = '';\r\n\r\n    this.showStatus('‚úÖ Â∑≤Ê∑ªÂä†ÈÖçÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n  private removeConfig(index: number): void {\r\n    this.currentSettings.siteConfigs.splice(index, 1);\r\n    this.renderConfigList();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n\r\n private async saveSettings(): Promise<void> {\r\n  const saveBtn = document.getElementById('save-settings') as HTMLButtonElement;\r\n  \r\n  if (!saveBtn) return;\r\n\r\n  try {\r\n    // ‰øùÂ≠òËÆæÁΩÆÈÄªËæë\r\n    this.currentSettings.savePath = this.savePathInput?.value.trim() || '';\r\n  \r\n    await chrome.storage.sync.set(this.currentSettings);\r\n    \r\n    // ‚úÖ ‰øùÂ≠òÊàêÂäüÔºåÊÅ¢Â§çÊåâÈíÆÈªòËÆ§Áä∂ÊÄÅ\r\n    saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n    saveBtn.className = 'primary';  // ÊÅ¢Â§çËìùËâ≤Ê†∑Âºè\r\n    saveBtn.disabled = false;\r\n    \r\n    this.showStatus('‚úÖ ËÆæÁΩÆÂ∑≤‰øùÂ≠ò', 'success');\r\n    \r\n    // Ê∏ÖÈô§ËçâÁ®ø\r\n    await chrome.storage.local.remove('draftSettings');\r\n    \r\n  } catch (error) {\r\n    console.error('‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:', error);\r\n    this.showStatus('‚ùå ‰øùÂ≠òÂ§±Ë¥•', 'error');\r\n    \r\n    // Âá∫Èîô‰πüÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ\r\n    saveBtn.textContent = 'üíæ ‰øùÂ≠òËÆæÁΩÆ';\r\n    saveBtn.className = 'primary';\r\n  }\r\n}\r\n\r\n\r\n  private async resetToDefaults(): Promise<void> {\r\n    if (!confirm('Á°ÆÂÆöË¶ÅÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÂêóÔºüÊâÄÊúâËá™ÂÆö‰πâÈÖçÁΩÆÂ∞ÜË¢´Ê∏ÖÈô§„ÄÇ')) {\r\n      return;\r\n    }\r\n\r\n    this.currentSettings = {\r\n      port: 8765,\r\n      enabledUrls: [...DEFAULT_URLS],\r\n      showOnAllSites: false,\r\n      siteConfigs: [],\r\n      promptFiles: []\r\n    };\r\n\r\n    if (this.portInput) this.portInput.value = '8765';\r\n    if (this.showOnAllSitesCheckbox) this.showOnAllSitesCheckbox.checked = false;\r\n    \r\n    \r\n    this.renderUrlList();\r\n    this.renderConfigList();\r\n    this.renderPromptList();\r\n    this.showStatus('‚úÖ Â∑≤ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÔºåËØ∑ÁÇπÂáª‰øùÂ≠ò', 'success');\r\n  }\r\n\r\n  private async exportConfig(): Promise<void> {\r\n    try {\r\n      const data = await chrome.storage.sync.get(null);\r\n      \r\n      const exportData = {\r\n        version: '1.0.0',\r\n        timestamp: new Date().toISOString(),\r\n        extension: 'AI to VSCode Bridge',\r\n        data: data\r\n      };\r\n\r\n      const json = JSON.stringify(exportData, null, 2);\r\n      const blob = new Blob([json], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      \r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `ai-vscode-bridge-config-${Date.now()}.json`;\r\n      a.click();\r\n      \r\n      URL.revokeObjectURL(url);\r\n      \r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂá∫', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂá∫Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂá∫Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    }\r\n  }\r\n\r\n  private async handleImportFile(event: Event): Promise<void> {\r\n    const input = event.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n    \r\n    if (!file) return;\r\n\r\n    try {\r\n      const text = await file.text();\r\n      const importData = JSON.parse(text);\r\n\r\n      if (!importData.data || !importData.version) {\r\n        this.showStatus('‚ùå Êó†ÊïàÁöÑÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè', 'error');\r\n        return;\r\n      }\r\n\r\n      if (!confirm('Á°ÆÂÆöË¶ÅÂØºÂÖ•ÈÖçÁΩÆÂêóÔºüÂΩìÂâçÈÖçÁΩÆÂ∞ÜË¢´Ë¶ÜÁõñ„ÄÇ')) {\r\n        return;\r\n      }\r\n\r\n      await chrome.storage.sync.set(importData.data);\r\n      await this.loadSettings();\r\n      \r\n      this.showStatus('‚úÖ ÈÖçÁΩÆÂ∑≤ÂØºÂÖ•ÔºåËØ∑Âà∑Êñ∞ÁΩëÈ°µ‰ΩøÈÖçÁΩÆÁîüÊïà', 'success');\r\n    } catch (error) {\r\n      console.error('ÂØºÂÖ•Â§±Ë¥•:', error);\r\n      this.showStatus('‚ùå ÂØºÂÖ•Â§±Ë¥•: ' + (error as Error).message, 'error');\r\n    } finally {\r\n      input.value = '';\r\n    }\r\n  }\r\n\r\n  private showStatus(message: string, type: 'success' | 'error'): void {\r\n    if (!this.statusDiv) return;\r\n    \r\n    this.statusDiv.textContent = message;\r\n    this.statusDiv.className = type;\r\n    this.statusDiv.style.display = 'block';\r\n    \r\n    setTimeout(() => {\r\n      if (this.statusDiv) {\r\n        this.statusDiv.style.display = 'none';\r\n      }\r\n    }, 4000);\r\n  }\r\n\r\n  private escapeHtml(text: string): string {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n  }\r\n\r\n  // ÊèêÁ§∫ËØçÁÆ°ÁêÜÁõ∏ÂÖ≥ÊñπÊ≥ï\r\n  private renderPromptList(): void {\r\n  if (!this.promptList) return;\r\n\r\n  const prompts = this.currentSettings.promptFiles || [];\r\n\r\n  if (prompts.length === 0) {\r\n    this.promptList.innerHTML = '<div class=\"empty-state\">ÊöÇÊó†ÊèêÁ§∫ËØçÈÖçÁΩÆ</div>';\r\n    return;\r\n  }\r\n\r\n  this.promptList.innerHTML = prompts\r\n    .map((prompt, index) => `\r\n      <div class=\"url-item\">\r\n        <div style=\"flex: 1;\">\r\n          <div style=\"font-weight: 500; color: #fff;\">üìù ${this.escapeHtml(prompt.name)}</div>\r\n          <div style=\"font-size: 11px; color: #888; margin-top: 2px;\">\r\n            ÂÜÖÂÆπÈïøÂ∫¶: ${prompt.path.length} Â≠óÁ¨¶\r\n          </div>\r\n        </div>\r\n        <div style=\"display: flex; gap: 6px;\">\r\n          <button \r\n            class=\"action-btn rename-btn\" \r\n            data-index=\"${index}\"\r\n            style=\"\r\n              padding: 4px 10px;\r\n              background: #4a4a4a;\r\n              color: white;\r\n              border: none;\r\n              border-radius: 3px;\r\n              cursor: pointer;\r\n              font-size: 12px;\r\n            \"\r\n          >\r\n            ‚úèÔ∏è ÈáçÂëΩÂêç\r\n          </button>\r\n          <button \r\n            class=\"danger\" \r\n            data-index=\"${index}\"\r\n          >\r\n            Âà†Èô§\r\n          </button>\r\n        </div>\r\n      </div>\r\n    `)\r\n    .join('');\r\n\r\n  // ÁªëÂÆöÂà†Èô§ÊåâÈíÆ‰∫ã‰ª∂\r\n  this.promptList.querySelectorAll('.danger').forEach(btn => {\r\n    btn.addEventListener('click', (e) => {\r\n      const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n      this.removePrompt(index);\r\n    });\r\n  });\r\n\r\n  // ÁªëÂÆöÈáçÂëΩÂêçÊåâÈíÆ‰∫ã‰ª∂\r\n  this.promptList.querySelectorAll('.rename-btn').forEach(btn => {\r\n    btn.addEventListener('click', (e) => {\r\n      const index = parseInt((e.target as HTMLElement).getAttribute('data-index') || '0');\r\n      this.renamePrompt(index);\r\n    });\r\n  });\r\n}\r\n\r\n\r\nprivate currentFileName: string = '';\r\n\r\nprivate async handleFileSelect(event: Event): Promise<void> {\r\n  const input = event.target as HTMLInputElement;\r\n  const file = input.files?.[0];\r\n  \r\n  if (!file) return;\r\n\r\n  try {\r\n    this.currentFileContent = await file.text();\r\n    \r\n    // ÊèêÂèñÊñá‰ª∂ÂêçÔºàÂéªÊéâÊâ©Â±ïÂêçÔºâ\r\n    this.currentFileName = file.name.replace(/\\.(md|markdown|txt)$/i, '');\r\n    \r\n    // Êõ¥Êñ∞ÊòæÁ§∫\r\n    if (this.fileNameDisplay) {\r\n      this.fileNameDisplay.textContent = file.name;\r\n      this.fileNameDisplay.style.color = '#fff';\r\n    }\r\n    \r\n    this.showStatus(\r\n      `‚úÖ Â∑≤Âä†ËΩΩ: ${file.name} (${this.currentFileContent.length} Â≠óÁ¨¶)`, \r\n      'success'\r\n    );\r\n  } catch (error) {\r\n    console.error('ËØªÂèñÊñá‰ª∂Â§±Ë¥•:', error);\r\n    this.showStatus('‚ùå ËØªÂèñÊñá‰ª∂Â§±Ë¥•', 'error');\r\n  }\r\n}\r\n\r\n\r\nprivate addPrompt(): void {\r\n  // È™åËØÅÔºöÊ£ÄÊü•ÊòØÂê¶ÈÄâÊã©‰∫ÜÊñá‰ª∂\r\n  if (!this.currentFileContent || this.currentFileContent.trim().length === 0) {\r\n    this.showStatus('‚ùå ËØ∑ÂÖàÈÄâÊã©Êñá‰ª∂', 'error');\r\n    const fileWrapper = document.getElementById('file-selector-wrapper');\r\n    if (fileWrapper) {\r\n      fileWrapper.style.borderColor = '#ff4444';\r\n      setTimeout(() => {\r\n        if (fileWrapper) fileWrapper.style.borderColor = '#3e3e3e';\r\n      }, 2000);\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (!this.currentSettings.promptFiles) {\r\n    this.currentSettings.promptFiles = [];\r\n  }\r\n\r\n  // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®ÂêåÂêçÊèêÁ§∫ËØç\r\n  const exists = this.currentSettings.promptFiles.some(\r\n    p => p.name === this.currentFileName\r\n  );\r\n  \r\n  if (exists) {\r\n    this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${this.currentFileName}\" Â∑≤Â≠òÂú®`, 'error');\r\n    return;\r\n  }\r\n\r\n  const newPrompt = {\r\n    id: Date.now().toString(),\r\n    name: this.currentFileName, // ‰ΩøÁî®Êñá‰ª∂Âêç\r\n    path: this.currentFileContent,\r\n    enabled: true\r\n  };\r\n\r\n  this.currentSettings.promptFiles.push(newPrompt);\r\n  this.renderPromptList();\r\n\r\n  // Ê∏ÖÁ©∫\r\n  if (this.fileNameDisplay) {\r\n    this.fileNameDisplay.textContent = 'Êú™ÈÄâÊã©Êñá‰ª∂';\r\n    this.fileNameDisplay.style.color = '#888';\r\n  }\r\n  this.currentFileContent = '';\r\n  this.currentFileName = '';\r\n\r\n  // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•Ê°Ü\r\n  if (this.promptFileInput) {\r\n    this.promptFileInput.value = '';\r\n  }\r\n\r\n  this.saveDraft();\r\n  \r\n  this.showStatus(`‚úÖ Â∑≤Ê∑ªÂä†ÊèêÁ§∫ËØçÔºö${newPrompt.name}`, 'success');\r\n}\r\nprivate renamePrompt(index: number): void {\r\n  if (!this.currentSettings.promptFiles) return;\r\n\r\n  const prompt = this.currentSettings.promptFiles[index];\r\n  if (!prompt) return;\r\n\r\n  // ÊâæÂà∞ÂØπÂ∫îÁöÑ DOM ÂÖÉÁ¥†\r\n  const items = this.promptList?.querySelectorAll('.url-item');\r\n  if (!items || !items[index]) return;\r\n\r\n  const item = items[index];\r\n  const nameElement = item.querySelector('div > div:first-child') as HTMLElement;\r\n  if (!nameElement) return;\r\n\r\n  // ‰øùÂ≠òÂéüÂßãÂêçÁß∞\r\n  const originalName = prompt.name;\r\n  const originalHTML = nameElement.innerHTML;\r\n\r\n  // ÂàõÂª∫ËæìÂÖ•Ê°Ü\r\n  const input = document.createElement('input');\r\n  input.type = 'text';\r\n  input.value = originalName;\r\n  input.style.cssText = `\r\n    width: 100%;\r\n    padding: 4px 8px;\r\n    background: #2d2d2d;\r\n    border: 1px solid #007bff;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    font-size: 14px;\r\n    font-weight: 500;\r\n  `;\r\n\r\n  // ÊõøÊç¢‰∏∫ËæìÂÖ•Ê°Ü\r\n  nameElement.innerHTML = '';\r\n  nameElement.appendChild(input);\r\n  input.focus();\r\n  input.select();\r\n\r\n  // ‰øùÂ≠òÂáΩÊï∞\r\n  const save = () => {\r\n    const newName = input.value.trim();\r\n\r\n    if (!newName) {\r\n      nameElement.innerHTML = originalHTML;\r\n      this.showStatus('‚ùå ÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫', 'error');\r\n      return;\r\n    }\r\n\r\n    // Ê£ÄÊü•ÈáçÂêç\r\n    const exists = this.currentSettings.promptFiles!.some(\r\n      (p, i) => i !== index && p.name === newName\r\n    );\r\n\r\n    if (exists) {\r\n      nameElement.innerHTML = originalHTML;\r\n      this.showStatus(`‚ùå ÊèêÁ§∫ËØç \"${newName}\" Â∑≤Â≠òÂú®`, 'error');\r\n      return;\r\n    }\r\n\r\n    // Êõ¥Êñ∞ÂêçÁß∞\r\n    prompt.name = newName;\r\n    nameElement.innerHTML = `üìù ${this.escapeHtml(newName)}`;\r\n    \r\n    this.saveDraft();\r\n    this.showStatus(`‚úÖ Â∑≤ÈáçÂëΩÂêç‰∏∫Ôºö${newName}`, 'success');\r\n  };\r\n\r\n  // ÂèñÊ∂àÂáΩÊï∞\r\n  const cancel = () => {\r\n    nameElement.innerHTML = originalHTML;\r\n  };\r\n\r\n  // ÂõûËΩ¶‰øùÂ≠ò\r\n  input.addEventListener('keydown', (e) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      save();\r\n    } else if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      cancel();\r\n    }\r\n  });\r\n\r\n  // Â§±ÁÑ¶‰øùÂ≠ò\r\n  input.addEventListener('blur', save);\r\n}\r\n\r\n\r\n\r\n\r\n  private removePrompt(index: number): void {\r\n    if (!this.currentSettings.promptFiles) return;\r\n    \r\n    this.currentSettings.promptFiles.splice(index, 1);\r\n    this.renderPromptList();\r\n    this.saveDraft();\r\n    this.showStatus('‚úÖ Â∑≤Âà†Èô§ÔºåËØ∑ÁÇπÂáª‰øùÂ≠òËÆæÁΩÆ', 'success');\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  new PopupManager();\r\n});\r\n"],"names":["DEFAULT_URLS","PopupManager","constructor","autoSaveTimer","hasDraft","portInput","showOnAllSitesCheckbox","urlList","newUrlInput","saveButton","resetButton","addUrlButton","exportButton","importButton","importFileInput","smartFindButton","statusDiv","configList","configHostnameInput","configSelectorInput","configContainerInput","addConfigButton","promptPathInput","selectFileButton","promptFileInput","addPromptButton","promptList","fileNameDisplay","currentFileContent","savePathInput","currentSettings","port","enabledUrls","showOnAllSites","siteConfigs","promptFiles","selectedCandidate","currentFileName","this","initElements","loadSettings","setupEventListeners","setupAutoSave","document","getElementById","settings","chrome","storage","sync","get","draft","local","draftSettings","draftData","fiveMinutes","timestamp","Date","now","showDraftIndicator","remove","value","savePath","toString","checked","renderUrlList","renderConfigList","renderPromptList","textContent","style","background","hideDraftIndicator","addEventListener","scheduleAutoSave","clearTimeout","window","setTimeout","saveDraft","parseInt","set","length","innerHTML","map","url","index","escapeHtml","join","querySelectorAll","forEach","btn","e","target","getAttribute","removeUrl","config","hostname","copyButtonSelector","responseContainerSelector","removeConfig","saveSettings","resetToDefaults","addUrl","addConfig","exportConfig","click","smartFindCopyButtons","handleImportFile","key","ctrlKey","handleFileSelect","addPrompt","activeTab","tabs","query","active","currentWindow","id","showStatus","URL","console","error","showScanningModal","results","scripting","executeScript","tabId","func","candidates","button","text","toLowerCase","trim","ariaLabel","title","className","score","includes","querySelector","selector","ariaLabelAttr","replace","classes","split","slice","push","label","sort","a","b","result","showEmptyResultModal","showCandidatesModal","errorMsg","Error","message","closeModal","modal","display","c","i","confirmSelection","el","currentTarget","selectCandidate","classList","selected","add","confirmBtn","disabled","test","splice","container","some","newConfig","undefined","saveBtn","confirm","data","exportData","version","toISOString","extension","json","JSON","stringify","blob","Blob","type","createObjectURL","createElement","href","download","revokeObjectURL","event","input","file","files","importData","parse","div","prompts","prompt","name","path","removePrompt","renamePrompt","color","fileWrapper","borderColor","p","newPrompt","enabled","items","nameElement","originalName","originalHTML","cssText","appendChild","focus","select","save","newName","preventDefault"],"sourceRoot":""}