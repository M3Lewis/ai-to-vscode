(()=>{"use strict";class t{static findLatestCopyButton(){const t=window.location.hostname;if(console.log("ğŸ” æŸ¥æ‰¾COPYæŒ‰é’®ï¼Œå½“å‰åŸŸå:",t),t.includes("perplexity.ai"))return this.findPerplexityCopyButton();const e=this.DEFAULT_SELECTORS.find(e=>t.includes(e.hostname));if(e){console.log("âœ… æ‰¾åˆ°é»˜è®¤é…ç½®:",e.name);const t=this.findButtonWithConfig(e);if(t)return console.log("âœ… ä½¿ç”¨é»˜è®¤é…ç½®æ‰¾åˆ°æŒ‰é’®"),t}return console.log("ä½¿ç”¨é€šç”¨ç­–ç•¥æŸ¥æ‰¾..."),this.findButtonGeneric()}static async loadConfigs(){}static findPerplexityCopyButton(){console.log("ğŸ” ä½¿ç”¨ Perplexity ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘");const t=document.querySelectorAll("div.py-md.md\\:pb-headerHeight.mx-auto.max-w-threadContentWidth > div");if(0===t.length)return console.log("âŒ æœªæ‰¾åˆ°å›å¤å®¹å™¨"),null;console.log(`âœ… æ‰¾åˆ° ${t.length} ä¸ªå›å¤å®¹å™¨`);const e=t[t.length-1],o=e.querySelectorAll('button[aria-label*="Copy"], button[data-testid*="copy"]');if(o.length>0)return console.log(`âœ… åœ¨æœ€æ–°å›å¤ä¸­æ‰¾åˆ° ${o.length} ä¸ªå¤åˆ¶æŒ‰é’®`),o[o.length-1];console.log("âš ï¸ æœªæ‰¾åˆ°æ ‡å‡†å¤åˆ¶æŒ‰é’®ï¼Œå°è¯•é€’å½’æœç´¢...");const n=Array.from(e.querySelectorAll("button"));for(const t of n){const e=t.getAttribute("aria-label")?.toLowerCase()||"",o=t.getAttribute("data-testid")?.toLowerCase()||"",n=t.textContent?.toLowerCase()||"";if(e.includes("copy")||o.includes("copy")||n.includes("copy"))return console.log("âœ… é€šè¿‡é€’å½’æœç´¢æ‰¾åˆ°å¤åˆ¶æŒ‰é’®"),t}return console.log("âŒ æœªæ‰¾åˆ° Perplexity å¤åˆ¶æŒ‰é’®"),null}static findButtonWithConfig(t){const e=t.copyButtonSelector;if(console.log("å°è¯•é€‰æ‹©å™¨:",e),window.location.hostname.includes("aistudio.google.com"))return this.findAIStudioCopyButton();if(window.location.hostname.includes("claude.ai"))return this.findClaudeCopyButton();if(t.responseContainerSelector){const o=document.querySelectorAll(t.responseContainerSelector);if(console.log("æ‰¾åˆ°",o.length,"ä¸ªå›ç­”å®¹å™¨"),o.length>0){const t=o[o.length-1].querySelector(e);if(t)return console.log("âœ… åœ¨å®¹å™¨ä¸­æ‰¾åˆ°æŒ‰é’®"),t}}const o=document.querySelectorAll(e);return console.log("å…¨å±€æ‰¾åˆ°",o.length,"ä¸ªåŒ¹é…æŒ‰é’®"),o.length>0?(console.log("âœ… è¿”å›æœ€åä¸€ä¸ªæŒ‰é’®"),o[o.length-1]):null}static findClaudeCopyButton(){console.log("ğŸ” ä½¿ç”¨ Claude ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘");const t=Array.from(document.querySelectorAll('button[data-testid="action-bar-copy"]'));if(t.length>0)return console.log(`âœ… æ‰¾åˆ° ${t.length} ä¸ª Claude å¤åˆ¶æŒ‰é’®`),t[t.length-1];const e=document.querySelector('main, [role="main"], .conversation-container');if(!e)return console.log("âŒ æœªæ‰¾åˆ°å¯¹è¯åŒºåŸŸ"),null;const o=Array.from(e.querySelectorAll("button"));for(let t=o.length-1;t>=0;t--){const e=o[t],n=e.querySelector("svg");if(n){const t=n.querySelector("path");if(t){const o=t.getAttribute("d")||"";if(o.includes("M10 1.5C11.1097")||o.includes("clipboard"))return console.log("âœ… é€šè¿‡ SVG è·¯å¾„æ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®"),e}}}return console.log("âŒ æœªæ‰¾åˆ° Claude å¤åˆ¶æŒ‰é’®"),null}static findAIStudioCopyButton(){console.log("ğŸ” ä½¿ç”¨ AI Studio ä¸“ç”¨æŸ¥æ‰¾é€»è¾‘");const t=document.querySelector('button[mat-menu-item][jslog^="282205"]');if(t)return console.log('âœ… é€šè¿‡ jslog="282205" æ‰¾åˆ°æŒ‰é’®'),t;const e=document.querySelector(".copy-markdown-button");if(e){const t=e.closest("button[mat-menu-item]");if(t)return console.log("âœ… é€šè¿‡ .copy-markdown-button class æ‰¾åˆ°æŒ‰é’®"),t}const o=Array.from(document.querySelectorAll("button[mat-menu-item]"));for(const t of o){const e=t.textContent?.trim()||"";if("Copy as markdown"===e||e.toLowerCase().includes("copy as markdown"))return console.log('âœ… é€šè¿‡æ–‡æœ¬ "Copy as markdown" æ‰¾åˆ°æŒ‰é’®'),t}for(const t of o){const e=t.textContent?.toLowerCase()||"";if(e.includes("markdown")&&e.includes("copy"))return console.log("âœ… æ‰¾åˆ°åŒ…å« markdown å’Œ copy çš„æŒ‰é’®:",e),t}for(const t of o){const e=t.textContent?.toLowerCase()||"";if(e.includes("copy"))return console.log("âœ… æ‰¾åˆ°åŒ…å« copy çš„æŒ‰é’®:",e),t}console.log("âš ï¸ èœå•å¯èƒ½æœªå±•å¼€ï¼Œå°è¯•æŸ¥æ‰¾èœå•æŒ‰é’®");const n=Array.from(document.querySelectorAll('button[aria-label*="options"], button[iconname="more_vert"]'));return n.length>0?(console.log("âœ… æ‰¾åˆ°",n.length,"ä¸ªèœå•è§¦å‘æŒ‰é’®"),n[n.length-1]):(console.log("âŒ æœªæ‰¾åˆ°æŒ‰é’®"),null)}static findButtonGeneric(){console.log("ğŸ” ä½¿ç”¨é€šç”¨ç­–ç•¥...");const t=['button[data-testid*="copy"]','button[aria-label*="Copy" i]','button[aria-label*="å¤åˆ¶" i]','button[title*="Copy" i]',"button.copy-button","button.copy-btn",'[data-testid*="copy"]'],e=document.querySelector('main, [role="main"], #root')||document;for(const o of t)try{const t=e.querySelectorAll(o);if(t.length>0){if(console.log(`âœ… é€šç”¨é€‰æ‹©å™¨ "${o}" æ‰¾åˆ° ${t.length} ä¸ªæŒ‰é’®`),t.length>100){console.warn(`âš ï¸ æŒ‰é’®æ•°é‡è¿‡å¤š (${t.length})ï¼Œåªæ£€æŸ¥æœ€å10ä¸ª`);const e=Array.from(t).slice(-10);return e[e.length-1]}return t[t.length-1]}}catch(t){continue}return console.error("âŒ æ‰€æœ‰ç­–ç•¥éƒ½å¤±è´¥äº†"),null}static async getClipboardContent(){try{return await navigator.clipboard.readText()}catch(t){throw new Error("æ— æ³•è¯»å–å‰ªè´´æ¿")}}static makeDraggable(t){let e,o,n,s,i=!1;const r=t.querySelector(".panel-header");r&&(r.style.cursor="move",r.addEventListener("mousedown",e=>{e.target.classList.contains("close-btn")||(i=!0,n=e.clientX-t.offsetLeft,s=e.clientY-t.offsetTop)}),document.addEventListener("mousemove",r=>{i&&(r.preventDefault(),e=r.clientX-n,o=r.clientY-s,t.style.left=`${e}px`,t.style.top=`${o}px`,t.style.right="auto",t.style.bottom="auto")}),document.addEventListener("mouseup",()=>{i=!1}))}}t.DEFAULT_SELECTORS=[{hostname:"chat.openai.com",copyButtonSelector:'button[aria-label*="Copy"]',responseContainerSelector:'[data-message-author-role="assistant"]',name:"ChatGPT"},{hostname:"claude.ai",copyButtonSelector:'button[data-testid="action-bar-copy"]',responseContainerSelector:void 0,name:"Claude"},{hostname:"gemini.google.com",copyButtonSelector:'button[aria-label="Copy"]',responseContainerSelector:".model-response",name:"Gemini"},{hostname:"perplexity.ai",copyButtonSelector:'button[aria-label="Copy"]',responseContainerSelector:void 0,name:"Perplexity"},{hostname:"aistudio.google.com",copyButtonSelector:'button[mat-menu-item][jslog^="282205"]',responseContainerSelector:void 0,name:"AI Studio"}],new class{constructor(){this.panel=null,this.statusElement=null,this.enabled=!1,this.dailyCounter=1,this.promptButtons=null,this.isDebugMode=!1,this.initialize(),this.checkDebugMode()}checkDebugMode(){this.isDebugMode=window.location.search.includes("debug=true")||"true"===localStorage.getItem("ai-vscode-debug")||"localhost"===window.location.hostname}debugLog(t,...e){this.isDebugMode&&console.log(t,...e)}debugWarn(t,...e){this.isDebugMode&&console.warn(t,...e)}async initialize(){await this.checkAndInitialize(),await this.loadDailyCounter(),this.queryConnectionStatus()}queryConnectionStatus(){chrome.runtime.sendMessage({action:"getConnectionStatus"},t=>{chrome.runtime.lastError?console.error("æŸ¥è¯¢è¿æ¥çŠ¶æ€å¤±è´¥:",chrome.runtime.lastError):t&&void 0!==t.connected&&(console.log("å½“å‰è¿æ¥çŠ¶æ€:",t.connected?"å·²è¿æ¥":"æœªè¿æ¥"),this.updateConnectionStatus(t.connected))})}async loadDailyCounter(){const t=(new Date).toDateString(),e=await chrome.storage.local.get(["lastSaveDate","dailyCounter"]);e.lastSaveDate===t?this.dailyCounter=(e.dailyCounter||0)+1:this.dailyCounter=1}async updateDailyCounter(){const t=(new Date).toDateString();await chrome.storage.local.set({lastSaveDate:t,dailyCounter:this.dailyCounter}),this.dailyCounter++}async checkAndInitialize(){const t=await chrome.storage.sync.get({enabledUrls:["chat.openai.com","claude.ai","gemini.google.com","perplexity.ai"],showOnAllSites:!1}),e=window.location.hostname,o=t.showOnAllSites,n=t.enabledUrls;o||this.isUrlEnabled(e,n)?(this.enabled=!0,this.createPanel(),this.setupMessageListener(),console.log("âœ… æ‚¬æµ®çª—å·²å¯ç”¨")):console.log("å½“å‰ç½‘ç«™æœªå¯ç”¨æ‚¬æµ®çª—:",e),chrome.storage.onChanged.addListener(t=>{(t.enabledUrls||t.showOnAllSites||t.siteConfigs)&&window.location.reload()})}isUrlEnabled(t,e){return e.some(e=>{if(e.includes("*")){const o=e.replace(/\*/g,".*");return new RegExp(o).test(t)}return t.includes(e)})}createPanel(){this.panel=document.createElement("div"),this.panel.id="ai-vscode-panel",this.panel.innerHTML='\n    <div class="panel-container">\n      <div class="panel-header">\n        <span>å‘é€åˆ°VS Code</span>\n        <button class="close-btn" id="close-panel">Ã—</button>\n      </div>\n      <div class="filename-preview" id="filename-preview" style="\n        font-size: 11px;\n        color: #888;\n        padding: 6px 8px;\n        background: #2d2d2d;\n        border-radius: 4px;\n        margin-bottom: 8px;\n        word-break: break-all;\n        display: none;\n      ">\n        æ–‡ä»¶åé¢„è§ˆ...\n      </div>\n      <button id="send-to-vscode">å¤åˆ¶å¹¶ä¿å­˜</button>\n      <div class="prompt-buttons" id="prompt-buttons" style="\n        margin-top: 8px;\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n      ">\n        \x3c!-- æç¤ºè¯æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ --\x3e\n      </div>\n      <div class="status" id="connection-status">\n        <span class="status-dot"></span>\n        <span class="status-text">æœªè¿æ¥</span>\n      </div>\n    </div>\n  ',document.body.appendChild(this.panel),t.makeDraggable(this.panel);const e=document.getElementById("send-to-vscode");e?.addEventListener("click",()=>this.handleSendClick());const o=document.getElementById("close-panel");o?.addEventListener("click",()=>this.togglePanel()),this.statusElement=document.getElementById("connection-status"),this.promptButtons=document.getElementById("prompt-buttons"),this.loadPromptButtons()}togglePanel(){this.panel&&(this.panel.style.display="none"===this.panel.style.display?"block":"none")}async handleSendClick(){try{if(this.debugLog("ğŸš€ å¼€å§‹å‘é€æµç¨‹..."),window.location.hostname.includes("aistudio.google.com"))return void await this.handleAIStudioCopy();const e=t.findLatestCopyButton();if(!e)return console.error("âŒ æœªæ‰¾åˆ°COPYæŒ‰é’®"),void this.showError("æœªæ‰¾åˆ°COPYæŒ‰é’®ï¼Œè¯·åœ¨è®¾ç½®ä¸­é…ç½®é€‰æ‹©å™¨");this.debugLog("âœ… æ‰¾åˆ°æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»"),e.click(),await this.delay(300);const o=await t.getClipboardContent();if(!o||0===o.trim().length)return void this.showError("å‰ªè´´æ¿å†…å®¹ä¸ºç©º");if(this.debugLog("âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:",o.length),o.length>5e4)return void this.showError("å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œæ— æ³•ç›´æ¥å¤åˆ¶ï¼Œè¯·åˆ†æ‰¹æ“ä½œï¼");const n=this.generateSmartFilename(o);this.debugLog("ğŸ“ ç”Ÿæˆæ–‡ä»¶å:",n),this.showFilenamePreview(n),this.sendToVSCode(o,n),await this.updateDailyCounter()}catch(t){const e=t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯";console.error("å‘é€å¤±è´¥:",t),this.showError(`æ“ä½œå¤±è´¥ï¼š${e}`)}}async handleAIStudioCopy(){try{this.debugLog("ğŸ” AI Studio ç‰¹æ®Šå¤„ç†ï¼šæŸ¥æ‰¾èœå•æŒ‰é’®");const e=Array.from(document.querySelectorAll('button[aria-label*="options"], button[iconname="more_vert"], button[aria-label*="Open options"], ms-chat-turn-options button'));if(0===e.length)return void this.showError("æœªæ‰¾åˆ°èœå•æŒ‰é’®");const o=e[e.length-1];this.debugLog("âœ… æ‰¾åˆ°èœå•æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»"),o.click(),this.debugLog("âœ… èœå•å·²å±•å¼€ï¼Œç­‰å¾…åŠ è½½..."),await this.delay(500);const n=t.findLatestCopyButton();if(!n)return console.error("âŒ èœå•å±•å¼€åä»æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®"),this.showError("æœªæ‰¾åˆ°å¤åˆ¶æŒ‰é’®"),void o.click();this.debugLog("âœ… æ‰¾åˆ°å¤åˆ¶æŒ‰é’®ï¼Œå‡†å¤‡ç‚¹å‡»"),n.click(),await this.delay(300);const s=await t.getClipboardContent();if(!s||0===s.trim().length)return void this.showError("å‰ªè´´æ¿å†…å®¹ä¸ºç©º");if(this.debugLog("âœ… è¯»å–åˆ°å†…å®¹ï¼Œé•¿åº¦:",s.length),s.length>5e4)return void this.showError("å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œæ— æ³•ç›´æ¥å¤åˆ¶ï¼Œè¯·åˆ†æ‰¹æ“ä½œï¼");const i=this.generateSmartFilename(s);this.debugLog("ğŸ“ ç”Ÿæˆæ–‡ä»¶å:",i),this.showFilenamePreview(i),this.sendToVSCode(s,i),await this.updateDailyCounter()}catch(t){const e=t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯";console.error("AI Studio å¤åˆ¶å¤±è´¥:",t),this.showError(`æ“ä½œå¤±è´¥ï¼š${e}`)}}generateSmartFilename(t){const e=new Date,o=e.getFullYear()+String(e.getMonth()+1).padStart(2,"0")+String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0")+String(e.getMinutes()).padStart(2,"0")+String(e.getSeconds()).padStart(2,"0"),s=String(this.dailyCounter).padStart(3,"0"),i=this.extractFirstSentence(t),r=this.cleanSentence(i);return`${o}-${n}-${s}-${this.truncateFilename(r,50)}.md`}extractFirstSentence(t){let e=t.trim();e=e.replace(/^#+\s+/gm,""),e=e.replace(/\*\*(.+?)\*\*/g,"$1"),e=e.replace(/\*(.+?)\*/g,"$1"),e=e.replace(/`(.+?)`/g,"$1"),e=e.replace(/\[(.+?)\]\(.+?\)/g,"$1");const o=e.split(/[ã€‚.!?ï¼ï¼Ÿ\n]/);for(const t of o){const e=t.trim();if(e.length>5)return e}return e.substring(0,50).trim()}cleanSentence(t){const e=[/^å¥½çš„[ï¼!ï¼Œ,ã€‚.\s]*/i,/^å½“ç„¶[ï¼!ï¼Œ,ã€‚.\s]*/i,/^æˆ‘ä¼š[^\s]{0,5}/i,/^æˆ‘å°†[^\s]{0,5}/i,/^è®©æˆ‘[^\s]{0,5}/i,/^æ˜ç™½[äº†å—]?[ï¼!ï¼Œ,ã€‚.\s]*/i,/^æ”¶åˆ°[ï¼!ï¼Œ,ã€‚.\s]*/i,/^å¥½[çš„å•¦][ï¼!ï¼Œ,ã€‚.\s]*/i,/^OK[ï¼!ï¼Œ,ã€‚.\s]*/i,/^äº†è§£[ï¼!ï¼Œ,ã€‚.\s]*/i,/^æ²¡é—®é¢˜[ï¼!ï¼Œ,ã€‚.\s]*/i];let o=t;for(const t of e)o=o.replace(t,"");return o=o.replace(/[<>:"/\\|?*\x00-\x1F]/g,""),o=o.replace(/\s+/g,"-"),o=o.replace(/^-+|-+$/g,""),o}truncateFilename(t,e){if(t.length<=e)return t;let o=t.substring(0,e);const n=o.lastIndexOf("-");return n>.7*e&&(o=o.substring(0,n)),o}showFilenamePreview(t){const e=document.getElementById("filename-preview");e&&(e.textContent=`ğŸ“„ ${t}`,e.style.display="block",setTimeout(()=>{e.style.display="none"},3e3))}sendToVSCode(t,e){const o={action:"sendToVSCode",content:t,filename:e};console.log("ğŸ“¤ å‘é€åˆ°VS Code:",e);const n=setTimeout(()=>{this.showError("å‘é€è¶…æ—¶ï¼Œè¯·æ£€æŸ¥VS Codeæ˜¯å¦å·²å¯åŠ¨WebSocketæœåŠ¡")},5e3);chrome.runtime.sendMessage(o,t=>{if(clearTimeout(n),chrome.runtime.lastError)return console.error("æ‰©å±•é€šä¿¡å¤±è´¥:",chrome.runtime.lastError),void this.showError("æ‰©å±•é€šä¿¡å¤±è´¥ï¼Œè¯·é‡æ–°åŠ è½½é¡µé¢");if(t&&t.success)this.showSuccess(`âœ… å·²ä¿å­˜: ${e}`);else{const e=t?.error||"æœªçŸ¥é”™è¯¯";this.showError(`å‘é€å¤±è´¥ï¼š${e}`)}})}setupMessageListener(){chrome.runtime.onMessage.addListener(t=>{"connectionStatus"===t.type&&this.updateConnectionStatus("connected"===t.status)})}updateConnectionStatus(t){if(!this.statusElement)return;const e=this.statusElement.querySelector(".status-text"),o=this.statusElement.querySelector(".status-dot");t?(this.statusElement.classList.add("connected"),e&&(e.textContent="å·²è¿æ¥"),o&&o.classList.add("active")):(this.statusElement.classList.remove("connected"),e&&(e.textContent="æœªè¿æ¥"),o&&o.classList.remove("active"))}showSuccess(t){this.showNotification(t,"success")}showError(t){this.showNotification(t,"error")}showNotification(t,e){const o=document.createElement("div");o.className=`notification ${e}`,o.textContent=t,document.body.appendChild(o),setTimeout(()=>o.remove(),3e3)}delay(t){return new Promise(e=>setTimeout(e,t))}async loadPromptButtons(){try{const t=(await chrome.storage.sync.get(["promptFiles"])).promptFiles||[];this.createPromptButtons(t)}catch(t){console.error("åŠ è½½æç¤ºè¯å¤±è´¥:",t)}}createPromptButtons(t){this.promptButtons&&0!==t.length&&(this.promptButtons.innerHTML=t.filter(t=>t.enabled).map(t=>`\n        <button \n          class="prompt-btn" \n          data-prompt-id="${t.id}"\n          data-prompt-name="${this.escapeHtml(t.name)}"\n          style="\n            padding: 8px 12px;\n            background: #6c5ce7;\n            color: white;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n            transition: all 0.2s;\n            text-align: left;\n          "\n          onmouseover="this.style.background='#5f4dd1'"\n          onmouseout="this.style.background='#6c5ce7'"\n        >\n          ğŸ“ ${this.escapeHtml(t.name)}\n        </button>\n      `).join(""),this.promptButtons.querySelectorAll(".prompt-btn").forEach((e,o)=>{e.__promptContent=t.filter(t=>t.enabled)[o].path,e.addEventListener("click",t=>{const e=t.currentTarget,o=e.__promptContent,n=e.getAttribute("data-prompt-name");o&&this.applyPrompt(o,n||"")})}))}async applyPrompt(t,e){try{if(console.log("ğŸ“ å¼€å§‹åº”ç”¨æç¤ºè¯:",e),!t||0===t.trim().length)return void this.showError("æç¤ºè¯å†…å®¹ä¸ºç©º");console.log("âœ… å†…å®¹é•¿åº¦:",t.length);const o=document.querySelector('button[data-test-system-instructions-card], button[aria-label="System instructions"], button.system-instructions-card');if(!o)return void this.showError("æœªæ‰¾åˆ° System Instructions æŒ‰é’®");console.log("âœ… æ‰¾åˆ° System Instructions æŒ‰é’®"),o.click(),await this.delay(500);const n=document.querySelector('textarea[aria-label="System instructions"], textarea[placeholder*="tone and style"], textarea.in-run-settings');if(!n)return this.showError("æœªæ‰¾åˆ°æ–‡æœ¬æ¡†"),void this.closeSystemInstructionsDialog();console.log("âœ… æ‰¾åˆ°æ–‡æœ¬æ¡†"),n.value="",n.value=t,n.blur(),n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0})),n.dispatchEvent(new Event("blur",{bubbles:!0}));const s=new CustomEvent("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(s),console.log("âœ… å†…å®¹å·²å¡«å……"),await this.delay(800),this.closeSystemInstructionsDialog(),this.showSuccess(`âœ… å·²åº”ç”¨: ${e}`)}catch(t){const e=t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯";console.error("åº”ç”¨æç¤ºè¯å¤±è´¥:",t),this.showError(`åº”ç”¨å¤±è´¥ï¼š${e}`)}}closeSystemInstructionsDialog(){const t=["button[data-test-close-button]",'button[aria-label="Close panel"]',"button[mat-dialog-close]",'button[iconname="close"]','button.ms-button-icon[iconname="close"]','button[aria-label="Close panel"][data-test-close-button]'];let e=null;for(const o of t)if(e=document.querySelector(o),e&&null!==e.offsetParent){console.log(`âœ… æ‰¾åˆ°å…³é—­æŒ‰é’®: ${o}`);break}if(e){const t=null!==e.offsetParent,o=e.hasAttribute("aria-disabled")&&"true"===e.getAttribute("aria-disabled"),n="false"===e.getAttribute("aria-disabled")||!e.hasAttribute("aria-disabled");if(console.log("å…³é—­æŒ‰é’®çŠ¶æ€:",{isVisible:t,isDisabled:o,isEnabled:n,ariaDisabled:e.getAttribute("aria-disabled"),className:e.className}),t&&n)try{e.click(),console.log("âœ… å·²è‡ªåŠ¨å…³é—­System Instructionsç•Œé¢")}catch(t){console.error("ç‚¹å‡»å…³é—­æŒ‰é’®å¤±è´¥:",t);const o=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(o),console.log("âœ… å·²é€šè¿‡äº‹ä»¶è§¦å‘å…³é—­System Instructionsç•Œé¢")}else console.warn("âŒ å…³é—­æŒ‰é’®ä¸å¯ç”¨æˆ–å·²ç¦ç”¨",{isVisible:t,isDisabled:o,isEnabled:n})}else{console.warn("âŒ æœªæ‰¾åˆ°å¯ç”¨çš„å…³é—­æŒ‰é’®");const t=document.querySelectorAll("button");console.log("é¡µé¢ä¸Šçš„æ‰€æœ‰æŒ‰é’®:",Array.from(t).map(t=>({tagName:t.tagName,className:t.className,ariaLabel:t.getAttribute("aria-label"),dataTest:t.getAttribute("data-test-close-button"),iconName:t.getAttribute("iconname"),matDialogClose:t.getAttribute("mat-dialog-close")})))}}escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}}})();
//# sourceMappingURL=content.js.map